<!doctype html>
<html lang="ko" data-bs-theme="auto">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<script 
  src="/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js"
  integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg=">
</script>


<link rel="stylesheet" href="/main.86b7305f5a96b7dd3a46fa6277d87b125af3bf13f48c4cfcc269be84fa9e8fb75375d45a5fe9056ce9190644b7a6e5f13f917f12d853ed38bb76d8856898f755.css" integrity="sha512-hrcwX1qWt906Rvpid9h7ElrzvxP0jEz8wmm+hPqej7dTddRaX+kFbOkZBkS3puXxP5F/EthT7Ti7dtiFaJj3VQ==" crossorigin="anonymous">

<noscript><style>img.lazyload { display: none; }</style></noscript><title>Next.js 15, Supabase 강좌 2편. Google OAuth를 이용한 로그인 구현</title>
<meta name="description" content="Next.js와 Supabase를 이용해서 Google OAuth를 이용해서 로그인을 테스트해 보겠습니다." />
<link rel="canonical" href="https://mycodingshub.github.io/blog/2025-01-01-nextjs-supabase-tutorial-2-login-with-google-id-oauth/" />
<meta name="robots" content="index, follow" />

<meta property="og:type" content="article" />
<meta property="og:title" content="Next.js 15, Supabase 강좌 2편. Google OAuth를 이용한 로그인 구현" />
<meta property="og:description" content="Next.js와 Supabase를 이용해서 Google OAuth를 이용해서 로그인을 테스트해 보겠습니다." />
<meta property="og:url" content="https://mycodingshub.github.io/blog/2025-01-01-nextjs-supabase-tutorial-2-login-with-google-id-oauth/" />
<meta property="og:site_name" content="Home" />
<meta property="og:image" content="https://mycodingshub.github.io/cover.png" />
<meta property="og:locale" content="en" />
<meta property="article:published_time" content="2025-01-01T07:38:35Z" />
<meta property="article:modified_time" content="2025-01-01T07:38:35Z" />
<meta property="article:tag" content="next.js" />
<meta property="article:tag" content="auth" />
<meta property="article:tag" content="google oauth" />
<meta property="article:tag" content="supabase" />
<meta property="article:tag" content="login" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Next.js 15, Supabase 강좌 2편. Google OAuth를 이용한 로그인 구현" />
<meta name="twitter:description" content="Next.js와 Supabase를 이용해서 Google OAuth를 이용해서 로그인을 테스트해 보겠습니다." />
<meta name="twitter:image" content="https://mycodingshub.github.io/cover.png" />

<meta name="author" content="cpro95@gmail.com" />

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "\"Next.js 15, Supabase 강좌 2편. Google OAuth를 이용한 로그인 구현\"",
  "description": "\"Next.js와 Supabase를 이용해서 Google OAuth를 이용해서 로그인을 테스트해 보겠습니다.\"",
  "datePublished": "\"2025-01-01T07:38:35Z\"",
  "dateModified": "\"2025-01-01T07:38:35Z\"",
  "author": {
    "@type": "Person",
    "name": "\"cpro95@gmail.com\""
  },
  "image": "\"https://mycodingshub.github.io/cover.png\"",
  "url": "\"https://mycodingshub.github.io/blog/2025-01-01-nextjs-supabase-tutorial-2-login-with-google-id-oauth/\"",
  "publisher": {
    "@type": "Organization",
    "name": "\"Home\""
  }
}
</script>




<script async src="https://www.googletagmanager.com/gtag/js?id=G-C7SBETWEJ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C7SBETWEJ0');
</script>


<script
  async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7748316956330968"
  crossOrigin="anonymous"
></script>


</head>

  
  <body class="single section blog" data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0">
    <div class="sticky-top">
<header class="navbar navbar-expand-sm">
  <div class="container-lg">
  <div class="d-flex flex-grow-1 justify-content-between">
    <div class="d-flex flex-row navbar-nav justify-content-between align-items-start gap-2">
    
    <a class="nav-link fw-bold fs-4" href="/">Home</a>

    
    
            <a class="nav-link fs-4  active" href="https://mycodingshub.github.io/blog/" aria-current="true">Blog</a>
          
        
            <a class="nav-link fs-4 " href="https://mycodingshub.github.io/life/">Life</a>
          
        
    </div>
    <div class="d-flex flex-row justify-content-between align-items-center">
      
      
      <button type="button" id="searchToggleMobile" class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="21" y1="21" x2="15" y2="15"></line>
        </svg>
      </button>
      
      
      <button type="button" id="searchToggleDesktop" class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="21" y1="21" x2="15" y2="15"></line>
        </svg>
      </button>
      
      <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type="button" aria-label="Toggle theme">
        <svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
        </svg>
        <svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0m-5 0h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
        </svg>
      </button>
      </div>
        
        
        
        
        </div>
    </div>

    
    </div>
</header>
</div>

<div class="modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1>
        <button type="button" class="btn-close visually-hidden" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="search-input flex-grow-1 d-none">
          <form id="search-form" class="search-form" action="#" method="post" accept-charset="UTF-8" role="search">
            <label for="query" class="visually-hidden">Search</label>
            <div class="d-flex">
              <input type="search" id="query" name="query" class="search-text form-control form-control-lg" placeholder="Search" aria-label="Search" maxlength="128" autocomplete="off">
              <button type="button" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-body">
        <p class="search-loading status message d-none mt-3 text-center">Loading search index…</p>
        <p class="search-no-recent message d-none mt-3 text-center">No recent searches</p>
        <p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p>
        <div id="searchResults" class="search-results"></div>
        <template>
          <article class="search-result list-view">
            <div class="card my-3">
              <div class="card-body">
                <header>
                  <h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2>
                  <div class="submitted d-none"><time class="created-date">Date here</time></div>
                </header>
                <div class="content">Summary here</div>
              </div>
            </div>
          </article>
        </template>
      </div>
      <div class="modal-footer">
        <ul class="list-inline me-auto d-none d-md-block">
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li>
        </ul>
        <p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p>
      </div>
    </div>
  </div>
</div>


    <div class="wrap container-lg" role="document">
      <div class="content">
      
        
<article>
  <div class="row justify-content-center">
    <div class="col-md-12 col-lg-12">
      
      <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-7748316956330968"
        data-ad-slot="2971373181"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      <div class="blog-header">
        <h1>Next.js 15, Supabase 강좌 2편. Google OAuth를 이용한 로그인 구현</h1>
        <p>
  <small>January 1, 2025<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>8&nbsp;minutes</span></small>
</p>

      </div>
    </div>
      <div class="col-md-12 col-lg-12">
      
      <p>** 목  차 **</p>
<ul>
<li><a href="#nextjs-15-supabase-%ea%b0%95%ec%a2%8c-2%ed%8e%b8-google-oauth%eb%a5%bc-%ec%9d%b4%ec%9a%a9%ed%95%9c-%eb%a1%9c%ea%b7%b8%ec%9d%b8-%ea%b5%ac%ed%98%84">Next.js 15, Supabase 강좌 2편. Google OAuth를 이용한 로그인 구현</a>
<ul>
<li><a href="#google-cloud%ec%97%90%ec%84%9c-api-%eb%b0%8f-%ec%84%9c%eb%b9%84%ec%8a%a4-%ec%84%a4%ec%a0%95%ed%95%98%ea%b8%b0">Google Cloud에서 API 및 서비스 설정하기</a></li>
<li><a href="#sign-in-%ec%bd%94%eb%93%9c-%ec%9e%91%ec%84%b1%ed%95%98%ea%b8%b0">Sign In 코드 작성하기</a></li>
<li><a href="#%ec%9c%a0%ec%a0%80-%eb%a1%9c%ea%b7%b8%ec%9d%b8-%ec%97%ac%eb%b6%80-%ed%8c%8c%ec%95%85%ed%95%98%ea%b8%b0">유저 로그인 여부 파악하기</a></li>
</ul>
</li>
</ul>
<hr>
<p>안녕하세요?</p>
<p>Next.js 15, Supabase 강좌 2편입니다.</p>
<p>지난 시간에는 Next.js 15를 이용한 기본적인 템플릿을 만들었었는데요.</p>
<p>오늘은 가장 기본적인 Google OAuth를 이용한 로그인을 구현해 보겠습니다.</p>
<p>참고로, 지난 시간 강좌 리스트입니다.</p>
<p><a href="https://mycodingshub.github.io/blog/2024-12-29-nextjs-supabase-tutorial-1-making-template-and-omit-middleware">Next.js 15, Supabase 강좌 1편. 유저 인증(Auth)을 위한 Next.js 15와 Supabase 템플릿 만들기</a></p>
<hr>
<h2 id="google-cloud에서-api-및-서비스-설정하기">Google Cloud에서 API 및 서비스 설정하기</h2>
<p>Google Cloud로 가서 OAuth 관련 API 관련 설정을 해야 하는데요.</p>
<p>굉장히 복잡합니다.</p>
<p>아래와 같이 쭉 따라서 하시면 됩니다.</p>
<p>Google Cloud는 <a href="https://console.cloud.google.com">console.cloud.google.com</a> 여기로 가시면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjFPiBMl11WSMz8XjJ2QDqxu22RiZMnqCjDgISSje0s16PeJTwfquzRV-QQX7EZsKdtVbJbPqL-1TLLEZMzj5FVar2TBjnQO4rj7NCyjXE1-viXyV4fsakzPTpyZwYcJcdlzZVP25TgkPFCOd18MgMJvvvQgFtwZUmtoXeqjCyUYQE0GtTMb3FWfHe1Qxo"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 왼쪽 상단에 &ldquo;프로젝트 선택&rdquo; 버튼을 클릭해서 아래와 같이 프로젝트 선택 창이 뜨면 오른쪽 상단에 &ldquo;새 프로젝트&rdquo; 버튼을 눌러 새로운 프로젝트를 만들면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEg5cJ8xibtMK8b3UUeBk4XzsMMSph1GvBQFWaGQ96LT9jVWLh1s_4973oN1EP81SmHh3QSfonjTdND6lUAkgYGYYtne_D4LujBSu8aw6zmBG2jIyqcYT1fXCKm8B7mGm6TMSq4qbDqyJ2ZlDfTG0Efjg7dHH-UmxpbXS-TqTjM7GL6o_EL93EkQazWkZKU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>그러면 아래와 같이 프로젝트 이름을 적고 &ldquo;만들기&rdquo; 버튼을 누르면 됩니다.</p>
<p>적당한 프로젝트 이름을 적으시면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEiBR_qd4ngxcjjxYk2FmC6aHvVILGIpe9OqAEBeBXgExEODRr2mtAWzc8Cf2t7c4dPoStlIMxxpxd7XqhPuTp7Mfwn16pDzkN0rMP2g1NwRy1JjjgI346vCPQeXxKl4s5HGIpRPKMW06RiC8tBScbIZwvMOWKiA_NIQeuxlKtc-OMDMlI7Tp5UgGl1ndtY"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>그러면 아래와 같이 프로젝트가 하나 생기는데요. 이제 방금 만든 프로젝트 이름을 클릭합니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEiF0hA9NxrbyNpx4nVU63g-acEDQiX81_JekKfyMcbAjBx2E9k0yBfFfN5rfI8uuCG-8bGTULEdxzlO4cXishmil22fTPZvO4wCyJz6fV8pI-JtYfU5KFOOSmSyFdB4q6dkblOeqMj_he8vPprNcjOCNP0ond70gXNgZH5Kn_n2GzV-YSyuQ8JMTIiV_8s"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 Google Cloud 메인 화면에서 왼쪽 최상단 햄버거 메뉴를 누르면 아래와 같이 나오는데요.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhfumsaYwBpGOOTJQA4KxkyMUZlr0ITEFXyD-RA8y3Uu2b-HDi3LQoESWULXVnoCVsopELkWzvP3SOUVNrjulo9HEqUSQYNgH6KZ-RwSeUg7TIy7eGIJOxDtfMXCTQKA39ziK7PXNKA8tPGV58a-q_HDXyNkGCfM0jh1AkJRhgWN_WxHCVUjwswXbGZkq0"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>여기서 &ldquo;API 및 서비스&rdquo; 메뉴를 선택하면 작은 창에 &ldquo;OAuth 동의화면&rdquo; 메뉴가 나옵니다.</p>
<p>이걸 클릭합니다. 그러면 아래와 같이 나오는데요.</p>
<p>User Type을 내부 유저인지 외부 유저인지 설정해 줘야 하는데요.</p>
<p>이게 뭔 뜻이냐면 구글 클라우드는 비지니스 상대로 하기 때문에 조직을 설정해서 운영할 수 있습니다.</p>
<p>예를 들어 회사라고 하면 회사원들은 내부 유저가 되는 것이고 일반 고개들은 외부 유저가 되는 거죠.</p>
<p>우리의 경우 구글 아이디만 있으면 로그인할 수 있게 하기 위해 외부 유저타입을 누르고 &ldquo;만들기&rdquo; 버튼을 누릅니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjG94CNayoRlHz7QlZn4kRbuy7pYPUcANw1YB5Cj5pB-My-vaun2ehgPtFaT91VpoEjP0uk3T1J0ocac_SlUzo6dftsWrrBj88YVVavyjUgjTVsy1rjRSclzmpnm6CGe4aXxlYMWH5A7etkxIQWUG9J0aOorzxEbnrjuL_qpZCGNudeOixXt7B376yRXDU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 아래와 같이 나오면 간단하게 앱 정보 및 사용자 이메일을 적으면 됩니다.</p>
<p>여기서 사용자는 개발자를 지칭합니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEh0i3uXwALk4SpDrQY6SCvQLg9iZBgeVs3GuDuEPDsXT00pF5mbZV3RgpZVYbA-2MHzMEPCEOoZnzVvA-Csd1VrwcNnP5HgPInLS4oS6G2Qj9oPhe06zgeUofb3nyUAJI-2L9kRFsJVkFf0nfdkNAjwkN5mVXitTN75Zd0ZWWkbQzuL0my2aQavZwJIm0o"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 아래쪽으로 이동하면 &ldquo;승인된 도메인&rdquo; 섹션이 보이는데요.</p>
<p>&ldquo;+ 도메인 추가&rdquo; 버튼을 누릅니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhN7CvvkSau7TITb3mVKftZUZPe0q43KlCjBskE-gsp8CqqxkS7TP8TxIdMkNzFVpXD1Zjlft3Zm5FIlQvwVV9NIR5bTByVYMeX9gyJ-PoYneqX0DnwF2AVw6uizxOEP8DFPVtsJ-IN19rcNuu_5buBXxXM_coyrLoqLSS5giZ0yq9D3mys4TDygXE37tM"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>승인된 도메인은 아래와 같이 Supabase 대시보드로 가서 세팅 메뉴로 가면 우리가 만들었던 앱의 프로젝트 URL이 아래와 같이 보이는데요.</p>
<p>이걸 구글 클라우드의 승인된 도메인에 추가하면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEje7lAYHrpBPM_7peyABmUOEuaHHC1oUsi6sF8wH-B0m9sKvvU0YSPNsVv8S0kKrCcirPpbk2o5eMntSsbIWCirrR0lgCF8rdwG3nevTS-FRGfDxga8Umdy0zu8gVh58JUmsDi0k_TIy9t7rqJrplaScYFb3qX_0EaEYg5HFmtv_ihU8LT8LX6MrUKAUq4"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>여기서 주의하실 점은 https를 빼고 적으시면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjQ18uwmri6BqQRJ6QFFMZYijIyPwjgkH7vvo5VltJCzcXti2P3waspl7OEZsVXRB7il53dL4__VtuHX4d2P9VVVqhN4LROQkSPHCqePPEJpiVYXc3MysfLvUhSZTXOAfPcJGml9g57COXn_qfdLSKezlyptQiuf_vphQ24v7IJSKY4SsxnA-Wtp2tHoo0"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 아래로 조금 이동하면 개발자 연락처 정보를 남기게 되는데요.</p>
<p>아래와 같이 이메일 주소를 적어주면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgndYSuNV__regw0QRjk-I96_pAPmEuft7UNsO8WI73pP7KiVxfZ6ZBNQ0pdQjDBDKObcwrzuv_NVZm0Q0OHGWbkYNaiKGG5bQNmtFMioZSq1u3tOKCrWmcJdP7ZG-p6yKhHFIek41YGts4cgGDqozZHc2s16Kl7LAGaa99ghMvZ9L4NJLQn9OiCh7l3Kk"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 밑에 &ldquo;저장 후 계속&rdquo; 버튼을 누르면 1단계가 끝나게 되는데요.</p>
<p>아래와 같은 화면이 보이게 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgsPt7CNvhPwf8r7xMQVTIuXdvT_ZcUv5UuZ2-4oOVKdbnG6WKdeeYQsg3QAg36q8NHnf3-sOTC--hHA3GUkChfkrKIGxohWHH4APcczxUFZBAqBwaXpgkbvZ2sAn-IxCsisRRiM7GUBv88PGElCBtg4zIVrsQhgUWVS0W5TH3EnoSLp9bAb581Ihhf7RU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 나오면 &ldquo;범위 추가 또는 삭제&rdquo; 버튼을 눌러 OAuth 동의 화면의 범위를 정해줘야 합니다.</p>
<p>보통 아래와 같이 3가지를 선택하면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEiUT8pZDtz11_MOQqZtq1ogGEz7gJ9nrjV6KS-q1FuZzN8ylaQ3-wBsu56BhgAJmX8A8TYx2PXD8ICCwYo9IkQi6Vq4fPHDg19Ogap6G9jMhhwVtGOXSFCEUgb2VTkVW3Y2olNDwrA2vx_7fxzWZ6yvA468-Ngu1FpddiFbtZjddAPVq9d0_waxT4z8_GI"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>보통 선택하는 게 &ldquo;email&rdquo;, &ldquo;profile&rdquo;, &ldquo;openid&rdquo; 입니다.</p>
<p>이제 밑에 &ldquo;업데이트&rdquo; 버튼을 눌러 업데이트하면 아래와 같이 방금 선택한 범위가 나옵니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjktKds5Xit0uexsj3Sy-xp2dGXi1PPXLnPRLuCt_E2LoLxRB3qDX8hF3frjs908o0NQwNGGMn_Of-U_qKO7PS31WiF3CT1Mx6h3YZeUH8qci4Ty2cWL_PdHhumyFJx-tTczZPcRjRD60Vk8Kq40igroRw439aD-WokW56aYVyjJX6_t7UyRc869jANmzs"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>그러면 아래와 같이 세 번째 단계가 완료됐다고 나오면서 테스트 사용자 관련 화면이 나오는데요.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEiR_6ghVlW6-3WuJ3etchPY60NaN8myl9dPKg2EbprsAwk8O_DOHPlWu-TeqBvOtwz0-GaS80Kg--4xMwBMIQpwKFP_5UDn7xenJFr7yMd49vrAw9xiUFWrwUI3GR-nMhD8elDXnVz5Now--riapUqI-e4j0bsCKdKV-Ol-owWXg7mN59kLI5NnOuIUx5s"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>추가로 테스트 사용자를 지정할 필요가 없어 맨 밑에 있는 &ldquo;저장 후 계속&rdquo; 버튼을 한 번 더 누릅니다.</p>
<p>그러면 아래와 같이 최종 결과가 나옵니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgY0D8jS4iO83E3eoRLznS-XbCRMK_-u1k-CXObZKIdq_Pfy97wexZRmc9qf-wrIgYgw8CXEFmvtchOGutNs4OCry1dzlp38ZfQ6N_hZhGO-MvWdQGK4DqJ1Cp_0IdUU13gbzq33xr6ihzOgpnTWCQ54OsWaGBQ0TsV1Y1m2WJMYtCH3_mp1xg-rWmCgAU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>여기서 &ldquo;대시보드로 돌아가기&rdquo; 버튼을 누르면 됩니다.</p>
<p>이제 다시 왼쪽 &ldquo;API 및 서비스&rdquo; 메뉴에서 &ldquo;사용자 인증 정보&rdquo; 메뉴를 누릅니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEj4Afq4I9uquMSWMWHEBYcAtYM0VwoovI274WleeekD42m7Y6DkyN3D0yAcbbPstlhOpcLsZFDWk1gJ0flpTUIb1Zzx0tah8yQk-RD1vjuY7OYE6X5wxDkaTfpv-xANRWW6VjvmLpV6pnsbqeQso6NujPwLCD_IZKcwaJQXf_PpwNSPqDUi_VaYiLeGX6w"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위 그림과 같이 아무것도 설정되어 있지 않다고 나오는데요.</p>
<p>여기서 우리가 설정할 거는 바로 OAuth 2.0 클라이언트 ID 부분입니다.</p>
<p>중간 위쪽에 &ldquo;+ 사용자 인증 정보 만들기&rdquo; 버튼을 누르면 아래와 같이 나옵니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjqhPVC5A13xtwwHhZIOnRPXr7TCBwefqQvY7E8YosYX0OD5HrSYM_HcJNNcyVPmuRdUniClsbtILyWEtGKC7d8PD4LmMGsA-T4Ej7x9BI67q3b8TzFqDDhv7-HgQ9SfreeIQ7Kt5oFzSBB4f4_KZgqmqSeeN3qaRkVwJAjpZwKQWQrUtFMi0VibbWMTCs"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>여기서 &ldquo;OAuth 클라이언트 ID&quot;를 선택해서 클릭합니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjy5akwZNQrbiP2MN4pgMkwgKCPttJ1dr_FSV9w-PUAp0djwCJTweI4m7YQ134KJE-PQwoxRZthKrQICzLMqt56eTCeUs0PdaV70vS_5hNbuvDMC6oVHX-LHpyeYJGogzS_pZJcimD-lrfCZs3OTcCbPqMQrRDQRuDlE0WZMXo0WcGEGFCDXZAGKKuftKM"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 나오는데요.</p>
<p>애플리케이션 유형과 이름을 적어주고, 아래쪽에 있는 승인된 Javascript 원본 부분에 URI를 현재 개발하고 있는 개발서버주소를 적어주면 됩니다.</p>
<p>나중에 실제로 앱을 배포하면 배포 앱의 URI를 적으면 됩니다.</p>
<p>Next.js는 개발서버가 &ldquo;http://localhost:3000&rdquo; 입니다.</p>
<p>이제 Supabase 대시보드의 Authentication 부분으로 갑니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgHg0yi_X8toyGv56m1YqPfo8ITSV5sm3FtLPH0KJr04SEXU8N4kzJeHnxXhm5SdX0vNQRzN3pGLiPLYDj0gVXYN3WJng70chfP05UN8J1e6HzghNvSlL5v-3SzCIECVq1JSwbbjM7utO5dWkMJPZBYvrpcZUWFI-P8Gr8MtgK30Uc_lBvjeW0G4_XiSow"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>여기서 아래와 같이 &ldquo;Auth Providers&rdquo; 부분을 누르는데요.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhsItyyDejzC07p4d4t9Kmu-VpK1_mWpCdNCRk0wQCCndNgl7G78jwSNFZvMG_0CirQlBeLDwdgmz_3z-7VQmPOodTv8cEeJQCzgPCMwNtWZ0Nv_MXzoekptv7sQVFXXSF2Iamfo_5yFDUR7u3aRwis0-iIOKOLZSGSmBSB6whT91FERz5Nemvc3DcUwaA"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>여기서 많은 Providers에서 Google 쪽을 클릭합니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjeVi1Ly3ie1vD9nSMzf0TyEShIMXMPSZlSLPytJtpzWH_REUA0doOdO1u36DYWHx_DdpgbvIGcKqLs36tFvwARLKJ3RJNV1mtWlDs0TgUZ-FkOl1xsXniWxtVt2jAS57w1PNmko1cKUipReEs3U2FCN1aIqO8HQ9Puse8mIzmdoTwDjvPpF8dokn0Roms"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>그러면 아래와 같이 현재 Enable 쪽에 체크가 안 되어 있는데 체크하시면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgc-DE3_sph2YE6m_PlEwGpVSCSpTCI5Lt79Dyl9y8RuB4rsYp1HcypXujujFmMFCU6EzNNTcR0iWPb_jkoX89GAZuhHNyTprajbOBdkE0rVNSiAh_e3a9f3CU32810Jz4LIYD2ul68PK4MISw7m7VW2n1oKjfdmuqFKl9XuZzALfbK2MRgDslcS-7VSNw"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위 그림의 마지막에 보시면 &ldquo;Callback URL (for OAuth)&rdquo; 칸에 주소가 보이는데요.</p>
<p>이 주소를 구글 클라우드 쪽으로 가서 아래와 같이 &ldquo;승인된 리디렉션 URI&quot;칸에 넣으시면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhLtw2CrNanx0z2GaATj-yGA4AqjLDjb2E-7s7x1C2FzQW9JPyy-mjiid1FUm5MvTJmAzS3OtcCkC7Abzm_6LUs29t8PwE00vOokvVV_FVpChZtc0_-J4kCvPgCA6icCf7vCXByTiOC_hdfguTBCxT6EsRULdzQortNeSW1BeFpXnEiab49mE6fEpCKKp4"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 아래와 같이 Supabase 쪽 대시보드에서 마지막으로 &ldquo;Save&rdquo; 버튼을 누르면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEha4BRIf3LZbc-qCdj4XW2sjQgmhuo2TbSQxr7ty_19_of4Y0L53m_iiSZsSwsmvg4fY2NdOJEKFEkE5x7pL7Y3i1wKMBtpK4EGCWAACnN3pcTiesIRZV9n3CCnZJQm0nscsVWN543S7NSLVMSllc5u0DP4z6hDQhIO44Rv_kJLs4bt6wZp_hiOfhhJTTA"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 아래와 같이 구글 클라우드 쪽에서도 &ldquo;만들기&rdquo; 버튼을 누르면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhnLUPekVYdOsZx5Wu3z_ryjv2bS9NHgIaIk2q1eyqqA6E102WX8Kjyn0eruCbWRbu9IjgtpLrfvoQjs0sCFUltXdORwoy-UkVLpekiUshJVx35osf2gQ1EZvBqo7I48o8QhuBD9CMynwXKXYHaevw9F0WH7NsCzoDGKnIbD5TKxs756d6bMFEoSJPu4JE"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>그러면 아래와 같이 &ldquo;클라이언트 ID&quot;와 &ldquo;클라이언트 보안 비밀번호&quot;가 만들어지는데요.</p>
<p>이 두 개를 Supabase 대시보드에 옮겨 놓으면 됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEht0qNtl_JxAKgcnUISgrNVyuZGTKS4nW-n1SFjOt5D2qcM20hrWP2cFqB8QA5aZNgQToNocPTzY9zGRVEPY--xFp4R8WBo0putVGlbbNE7Xw3G-9Z-PaxzO1PFzehcPGAE6h6HTPFg3W9-70_E8uuOYPZBZG4a9cLqhX9GZiYCGiQ7P1sQy_bDOo3LvNQ"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>Supabase 대시보드에 아래와 같이 &ldquo;Client IDs&quot;와 &ldquo;Client Secrets&rdquo; 부분에 옮겨 놓고 맨 밑에 &ldquo;Save&rdquo; 버튼을 한 번 더 눌러주시면 저장됩니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEj5-5UoIw1tMik7SeXlpBdOQKiWp8Oke0ZPon_20l2s2EyCBP_zrFsJkxatjRkrDIxaP13nqzUxd5d4xP55j0rZjm3Bz-N_OIhr0grpDYi3OnqvvSpkabQpuqE3q0Cypqc1Srb7yM6WUcHrIQpJneZiXamQYtoQvQYzmpz3INO9FY5q6Vknrlrxtbau9Ko"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>구글 클라우드에서도 팝업 창을 종료하면 아래와 같이 프로젝트 이름과 클라이언트 ID 등 관련 정보가 잘 저장되었다고 나옵니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEh8ENsLed_W95BoRSjSqPWXzGKhvq5ZUFXCSCtsDdTfeOu44CChkwgjBwcGPZOafPcglHWI7Y7oSUePZViz93o1rP0O0H75QX1WYOqkDgfkqSl7tM2ol6NpsYuFggTohbK8gt53uvLtU2xFkrAX_-jstyODUb6WKmXm0elLrQdLwuK9u1b7lMiNwKb1LGs"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 구글 OAuth 설정과 Supabase 연동까지가 끝났는데요.</p>
<p>이제 실제 Next.js 코드를 작성해서 SignIn, SignOut 등 유저 로그인을 구현해 보겠습니다.</p>
<hr>
<h2 id="sign-in-코드-작성하기">Sign In 코드 작성하기</h2>
<p>이제 실제 코드를 작성해 보겠습니다.</p>
<p>app 폴더 밑에 auth 폴더를 만들고 page.tsx 파일을 만들겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">AuthForm</span> <span class="kr">from</span> <span class="s2">&#34;@/components/Forms/AuthForm&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">AuthPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex flex-col mx-auto gap-4 p-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Not</span> <span class="nx">Logged</span> <span class="k">in</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">AuthForm</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">AuthPage</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 일단은 auth 라우팅에는 간단하게 &ldquo;Not Logged in&quot;이라고 써놓고 그 밑에 AuthForm을 컴포넌트로 넣었는데요.</p>
<p>이제 이 AuthForm 컴포넌트를 만들어보겠습니다.</p>
<p>src 폴더 밑에 components 폴더를 만들고 Forms 폴더를 만들고 그 밑에 실제 파일인 AuthForm.tsx 파일을 만들겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="s2">&#34;use client&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">signInWithGoogle</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@/utils/supabase/actions&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">AuthForm</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">button</span>
</span></span><span class="line"><span class="cl">          <span class="na">formAction</span><span class="o">=</span><span class="p">{</span><span class="nx">signInWithGoogle</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">className</span><span class="o">=</span><span class="s">&#34;border rounded px-2.5 py-2&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="nx">Sign</span> <span class="k">in</span> <span class="kd">with</span> <span class="nx">Google</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">AuthForm</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 AuthForm을 만들었습니다.</p>
<p>&lsquo;use client&rsquo; 디렉디브로 클라이언트 컴포넌트로 만들었고, form과 formAction을 지정했습니다.</p>
<p>Next.js에서 이제는 form을 POST 메서드 방식으로 전달하게 되는데요.</p>
<p>formAction 함수에 &lsquo;signInWithGoogle&rsquo; 액션 함수를 넣었습니다.</p>
<p>이제 이 함수를 만들어볼까요?</p>
<p>supabase 관련 클라이언트 코드를 모아 두었던 &lsquo;utils/supabase&rsquo; 폴더 밑에 actions 함수를 아래와 같이 만들겠습니다.</p>
<p>그리고 &lsquo;utils/supabase&rsquo; 폴더에서 지난 시간에 만들었던 server.ts 파일에서 createClient 함수 이름을 서버라는 걸 더 명확히 하기 위해 &lsquo;createClientForServer&rsquo;라는 이름으로 바꾸겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="s2">&#34;use server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Provider</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@supabase/supabase-js&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createClientForServer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;./server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">redirect</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;next/navigation&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">signInWith</span> <span class="o">=</span> <span class="p">(</span><span class="nx">provider</span>: <span class="kt">Provider</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kr">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">supabase</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createClientForServer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">auth_callback_url</span> <span class="o">=</span> <span class="sb">`</span><span class="si">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SITE_URL</span><span class="si">}</span><span class="sb">/auth/callback`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">error</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">supabase</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">signInWithOAuth</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">provider</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">redirectTo</span>: <span class="kt">auth_callback_url</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">redirect</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span> <span class="kr">as</span> <span class="kt">string</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">signInWithGoogle</span> <span class="o">=</span> <span class="nx">signInWith</span><span class="p">(</span><span class="s2">&#34;google&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="p">{</span> <span class="nx">signInWithGoogle</span> <span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>나중을 위해 signInWith 함수를 먼저 만들고 signInWithGoogle 함수를 최종적으로 만들어서 export 했습니다.</p>
<p>이제 signInWith 함수를 뜯어보아야 할 건데요.</p>
<p>OAuth 방식은 모두 다 위와 같은 식으로 처리하면 됩니다.</p>
<p>OAuth 방식은 예전에 제가 썼던 <a href="https://mycodingshub.github.io/blog/2024-07-21-cloudflare-hono-google-login">Hono + Cloudflare 로그인 구현</a>하는 글을 보시면 OAuth 방식의 처리에 대한 상세한 설명이 나오는데요.</p>
<p>일단 위와 같이 만들고 나서 Sign in Google 버튼을 누르면 실제로 코드가 작동하면서 아래와 같이 나오는데요.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhv-6XsQUMuGMWjo0yNjXATYpDNmuF0ww10PfZ3kYshUpkUwBnqX8ZFqxWZOvDhforJxYm962oVg7Pb_291KfcTfzI0wmzE4oD0n3t8kJnu7nGhHEdSP3l1unARTriBwRvC_f5aP7zY4MJDr2VN8sk3Gc6Mr6So6RN2SSRkU0gk3UD_vy4u96W7AmYBTZQ"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 구글 계정을 선택하라고 나오는데요.</p>
<p>제 아이디를 선택하면 아래와 같이 또 나옵니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjlJw80rutZrkVYGCexYPI5V8QiUnjzmeeBlF-5Is5aRtbePkmyd9NUV1lzz2quXbMsUo9zP6mr0uakSn6VdHiwukNCvWuKRGXy04r-YMDnWAno8F_s67e1YIWbmYyhrEb_Lta0td-fac8Ui9Q2vl3VhtE3XCJjMiqmlsaQSr1c6_2ur2LkiZ6D01b4xiU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>다시 한번 &ldquo;계속&rdquo; 버튼을 누르면 구글 아이디를 이용해서 로그인 프로세스를 진행한다는 의미입니다.</p>
<p>&ldquo;계속&rdquo; 버튼을 누르면 브라우저가 아래와 같이 나오는데요.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEinLBwmjYGnSfJrhLkVtg5iVmE5UrTvT42SO_QY3dppEriZ0OkuVcLmP_9zgGze4xJWzXw9WZAMIgblYiDaKNadkNWQFgqC2_-rUSlW0OMx4z0X9sCUjBw9ic_vlW27QENQ_x5jsRyRW3zjt3ZQ3JP7gJOTaU1Ug2bi-twv6h8ielVCt_JDCy46SyluKMk"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">http://localhost:3000/auth/callback?code<span class="o">=</span>9eee6307-9ed4-498f-9eac-a8ab2d72de2e</span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 우리가 아까 actions.ts 파일안에서 설정한 &lsquo;auth_callback_url&rsquo;로 이동했는데요.</p>
<p>그냥 이동한 게 아니라 URL 파라미터로 code 값을 같이 전달했습니다.</p>
<p>그리고 실제 &lsquo;console.log&rsquo; 명령어에 의해 콘솔창에 나오는 &lsquo;data&rsquo; 값을 한번 보셔야 하는데요.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgYb5sYmWeheSYJQfTAxCMMRpN-L7A57KwTmv5t9mGpLQCo8ysgY2thiWzV48KUamMG006JepIeOBDv99w47IwH9-CcZQEZ7NZh5X6crACewfxCW-MlaTpelKFTusa7B4TnM3b5QeIp7HM_L6uXeA1Y4PuBT-0KNjyDQULP10seU83LPnYoHYbTwz2pnyo"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 data 값에는 provider 값과 url 값이 있는데요.</p>
<p>요지는 구글 아이디로 로그인하는 버튼을 누르면 supabase.auth.signInWithOAuth 함수에서 위 그림과 같이 콜백 URL을 리턴해주는데요.</p>
<p>해당 콜백 URL로 redirect 해야 합니다.</p>
<p>여기서 중요한 거는 바로 &lsquo;code&rsquo; 값인데요.</p>
<p>이 &lsquo;code&rsquo; 값을 이용해서 나중에 우리가 만들게 될 콜백 함수에서 실제 구글에서 제공해 주는 토큰값을 가져올 수 있게 됩니다.</p>
<p>그러면 우리가 &lsquo;SITE_URL&rsquo;을 &lsquo;.env.local&rsquo;에 먼저 저장합시다.</p>
<p>일단은 개발 서버이기 때문에 아래와 같이 만들고, 실제 웹 애플리케이션을 배포했을 때는 실제 URL로 바꾸시면 됩니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nv">SITE_URL</span><span class="o">=</span>http://localhost:3000</span></span></code></pre></div>
  </figure>
</div>
<p>그러면 우리가 처리해 줘야 하는 콜백 함수를 만들어야 하는데요.</p>
<p>우리가 actions.ts 파일에서 설정한 &lsquo;auth_callback_url&rsquo;을 직접 구현해 줘야 합니다.</p>
<p>먼저, auth_callback_url이 &lsquo;/auth/callback&rsquo; 라우팅이라 app 폴더 밑에 auth 폴더가 있고 그 밑에 다시 callback 폴더를 만들고 page.tsx 파일을 만드는 게 아니라 route.ts 파일을 만들어야 합니다.</p>
<p>라우팅만 처리하면 되기 때문에 route.ts 파일 이름으로 해야 합니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">NextRequest</span><span class="p">,</span> <span class="nx">NextResponse</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;next/server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createClientForServer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@/utils/supabase/server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">GET</span><span class="p">(</span><span class="nx">request</span>: <span class="kt">NextRequest</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="nx">origin</span> <span class="p">}</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URL</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">code</span> <span class="o">=</span> <span class="nx">searchParams</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;code&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">next</span> <span class="o">=</span> <span class="nx">searchParams</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;next&#34;</span><span class="p">)</span> <span class="o">??</span> <span class="s2">&#34;/&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">supabase</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createClientForServer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="p">{</span> <span class="nx">error</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">supabase</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">exchangeCodeForSession</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">forwardedHost</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;x-forwarded-host&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">isLocalEnv</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="s2">&#34;development&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">isLocalEnv</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">NextResponse</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">origin</span><span class="si">}${</span><span class="nx">next</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">forwardedHost</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">NextResponse</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="sb">`https://</span><span class="si">${</span><span class="nx">forwardedHost</span><span class="si">}${</span><span class="nx">next</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">NextResponse</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">origin</span><span class="si">}${</span><span class="nx">next</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">NextResponse</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">origin</span><span class="si">}</span><span class="sb">/auth/auth-code-error`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드의 핵심은 바로 <code>supabase.auth.exchangeCodeForSession(code)</code> 함수인데요.</p>
<p>code 값을 넣으면 Auth 액세스 토큰을 리턴해 줍니다.</p>
<p>이제 개발 서버를 다시 돌려서 테스트해보면 구글 아이디로 로그인하면 최종적으로 &ldquo;/&rdquo; 라우팅으로 가게 됩니다.</p>
<p>로그인이 성공했다는 뜻입니다.</p>
<p>이제 &ldquo;/&rdquo; 라우팅에서 유저 로그인 상태를 브라우저에 나타내 봅시다.</p>
<hr>
<h2 id="유저-로그인-여부-파악하기">유저 로그인 여부 파악하기</h2>
<p>일단 Home 라우팅인 app 폴더 밑의 page.tsx 파일을 고쳐보겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createClientForServer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@/utils/supabase/server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">Home() {</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">supabase</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createClientForServer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">session</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">supabase</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">getUser</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">session</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex flex-col py-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Home</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 일단 우리가 만든 supabase 클라이언트를 불러주고 그다음 getUser 함수를 호출해서 세션 정보를 얻습니다.</p>
<p>console.log를 통해 터미널상에 어떻게 나타나는지 보겠습니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  data: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    user: <span class="o">{</span>
</span></span><span class="line"><span class="cl">      id: <span class="s1">&#39;2bc007d5-~~~~~~~~~~00d7ced07&#39;</span>,
</span></span><span class="line"><span class="cl">      aud: <span class="s1">&#39;authenticated&#39;</span>,
</span></span><span class="line"><span class="cl">      role: <span class="s1">&#39;authenticated&#39;</span>,
</span></span><span class="line"><span class="cl">      email: <span class="s1">&#39;cpro95@gmail.com&#39;</span>,
</span></span><span class="line"><span class="cl">      email_confirmed_at: <span class="s1">&#39;2025-01-01T04:29:04.395201Z&#39;</span>,
</span></span><span class="line"><span class="cl">      phone: <span class="s1">&#39;&#39;</span>,
</span></span><span class="line"><span class="cl">      confirmed_at: <span class="s1">&#39;2025-01-01T04:29:04.395201Z&#39;</span>,
</span></span><span class="line"><span class="cl">      last_sign_in_at: <span class="s1">&#39;2025-01-01T06:05:10.290278Z&#39;</span>,
</span></span><span class="line"><span class="cl">      app_metadata: <span class="o">[</span>Object<span class="o">]</span>,
</span></span><span class="line"><span class="cl">      user_metadata: <span class="o">[</span>Object<span class="o">]</span>,
</span></span><span class="line"><span class="cl">      identities: <span class="o">[</span>Array<span class="o">]</span>,
</span></span><span class="line"><span class="cl">      created_at: <span class="s1">&#39;2025-01-01T04:29:04.363282Z&#39;</span>,
</span></span><span class="line"><span class="cl">      updated_at: <span class="s1">&#39;2025-01-01T06:05:10.30955Z&#39;</span>,
</span></span><span class="line"><span class="cl">      is_anonymous: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>,
</span></span><span class="line"><span class="cl">  error: null
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>session 객체는 data와 error 값이 있고, data 값에 user 값이 있어 getUser에 의해 user 정보를 얻을 수 있습니다.</p>
<p>여기까지만 해도 구글 아이디로 Supabase 로그인은 성공한 겁니다.</p>
<p>참고로 브라우저 개발 콘솔창에서 보시면 user 객체에 있는 app_metadata와 user_metadata를 상세히 볼 수 있습니다.</p>
<p>유저 메타데이터로 홈 화면을 멋있게 구성하고 Sign Out 버튼도 만들어 보겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">signOut</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@/utils/supabase/actions&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createClientForServer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@/utils/supabase/server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Link</span> <span class="kr">from</span> <span class="s2">&#34;next/link&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">Home() {</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">supabase</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createClientForServer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">session</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">supabase</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">getUser</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">session</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex flex-col items-center justify-center h-screen gap-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;text-4xl font-bold&#34;</span><span class="p">&gt;</span><span class="nx">Not</span> <span class="nx">Authenticated</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">Link</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;border rounded px-2.5 py-2&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/auth&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="nx">Sign</span> <span class="k">in</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">Link</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">user</span><span class="o">:</span> <span class="p">{</span> <span class="nx">user_metadata</span><span class="p">,</span> <span class="nx">app_metadata</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="o">=</span> <span class="nx">session</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">email</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">user_metadata</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">Email</span> <span class="o">=</span> <span class="nx">email</span> <span class="o">?</span> <span class="sb">`</span><span class="si">${</span><span class="nx">email</span><span class="si">}</span><span class="sb">`</span> <span class="o">:</span> <span class="s2">&#34;email Not Set&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">session</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex flex-col gap-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">p</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;text-xl&#34;</span><span class="p">&gt;</span><span class="nx">Email</span><span class="o">:</span> <span class="p">{</span><span class="nx">Email</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="p">{</span><span class="nx">signOut</span><span class="p">}&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;border rounded px-2.5 py-2&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="nx">Sign</span> <span class="nx">Out</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjjmJxZVWj6ZpklHavaj8-AkbW5n-cTLi6X3fhaSqAQ97IWe28TN___sBw3I5eES9gqSoCMp9JqOyik7pzXl8UOkd4zbryLtphLCNohtWj7J0xwHssraSlcBG9Qc_Ix8Rq4p9QMPNqIWgF31JLayGCVYODTDFbyO_dkTCSh079IYUT34F63U5z1RH7WqQY"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 브라우저에 아주 잘 나오고 있습니다.</p>
<p>이제 로그아웃을 위한 signOut 액션 함수를 만들어야 하는데요.</p>
<p>아까 만들었던 actions.ts 파일에 아래와 같이 추가하시면 됩니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">signOut</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">supabase</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createClientForServer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">supabase</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">signOut</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="p">{</span> <span class="nx">signInWithGoogle</span><span class="p">,</span> <span class="nx">signOut</span> <span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>signOut 함수도 supabase에서 제공해 주고 있습니다.</p>
<p>&ldquo;Sign Out&rdquo; 버튼을 누르면 로그아웃되어 아래와 같이 보일 겁니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjBtXo2w_1zMUzJKCX8zmEXDJoAMZt3TV8ubLs6DcOQl2d4WsJL2AOgPW5Ae1CiIONZu1O4NmNXoqJIzbv0lLuQ3MeIp1mmht7rbAiNLEYAwamU86PuuVegNnTd4QOyet7hQ_lIAzPahJhkdvMB7irJAd_qt2oSF8pplNp0gHmlm3lLe03o3UVZ4YtGI30"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>성공적으로 로그아웃 되었습니다.</p>
<p>지금까지 Supabase와 Google 아이디를 이용해서 로그인을 구현해 봤는데요.</p>
<p>다음 시간에는 Github 아이디를 이용한 로그인을 테스트해 보겠습니다.</p>
<p>그럼.</p>

      <div class="tag-list-single">
        <a class="btn btn-light" href="/tags/next.js/" role="button">next.js</a>
        <a class="btn btn-light" href="/tags/auth/" role="button">auth</a>
        <a class="btn btn-light" href="/tags/google-oauth/" role="button">google oauth</a>
        <a class="btn btn-light" href="/tags/supabase/" role="button">supabase</a>
        <a class="btn btn-light" href="/tags/login/" role="button">login</a>
        </div>
      
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-format="autorelaxed"
          data-ad-client="ca-pub-7748316956330968"
          data-ad-slot="4495825428"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </div>
</article>

      
      </div>
    </div>
    
    
<div class="bg-light">
    <section class="section section-related container">
      <div class="row justify-content-center">
        <div class="col-md-12 col-lg-12">
          <h2 class="section-title text-center">Related posts</h2>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-lg-12">
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2025-01-01-nextjs-supabase-tutorial-3-login-with-github-id-oauth/">Next.js 15, Supabase 강좌 3편. Github OAuth를 이용한 로그인 구현</a></h2>
                  <p>Next.js와 Supabase를 이용해서 Github OAuth를 이용해서 로그인을 테스트해 보겠습니다.</p>
                  <p>
  <small>January 1, 2025<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>4&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2025-01-19-nextjs-supabase-tutorial-8-send-otp-number-and-login-with-otp/">Next.js 15, Supabase 강좌 8편. 이메일로 OTP를 보내서 로그인 구현하기</a></h2>
                  <p>Next.js와 Supabase를 이용해서 이메일로 OTP 숫자를 보내서 로그인하는 방법을 구현해 봅시다.</p>
                  <p>
  <small>January 19, 2025<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>8&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2025-01-13-nextjs-supabase-tutorial-7-send-magic-link-and-login-with-supabase-brevo/">Next.js 15, Supabase 강좌 7편. 이메일로 Magic Link를 보내서 로그인 구현하기</a></h2>
                  <p>Next.js와 Supabase를 이용해서 이메일로 Magic Link를 보내서 로그인하는 방법을 구현해 봅시다.</p>
                  <p>
  <small>January 13, 2025<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>4&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          </div>
      </div>
    </section>
    <script src="https://utteranc.es/client.js"
      repo="cpro95/utterances_mycodings_fly_dev"
      issue-term="pathname"
      theme="github-light"
      label="blog-comment"
      crossorigin="anonymous"
    async>
    </script>
  </div>
  
    <footer class="footer text-muted">
  <div class="container-lg">
    <div class="row">
      <div class="col-lg-8 text-center text-lg-start">
        <ul class="list-inline">
          <li class="list-inline-item"><a class="text-muted" href="/about/">about</a></li>
        </ul>
      </div>
      <div class="col-lg-8 text-center text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item">Copyright (c) All Right Reserved.</li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    

<script async
  src="/js/app.19b73e0182301dd61c9211c2f6890104740e2eb9eb12fe4ba8d4f31435b22ed6.js"
  integrity="sha256-Gbc&#43;AYIwHdYckhHC9okBBHQOLrnrEv5LqNTzFDWyLtY=">
</script>





<script async
  src="/js/flexsearch.5dd6433c29c3e043627f046054aed58ff3790f58fdb8423f45125bbafdcad335.js"
  integrity="sha256-XdZDPCnD4ENifwRgVK7Vj/N5D1j9uEI/RRJbuv3K0zU=">
</script>
<script async
  src="/js/search-modal.96e662d8f691fe25c859a3437074b485f2d7bed0bca612725028c6cf4322e2f2.js"
  integrity="sha256-luZi2PaR/iXIWaNDcHS0hfLXvtC8phJyUCjGz0Mi4vI=">
</script>

    <div class="d-inline-flex fixed-bottom-right pb-4 pe-4">
  <button id="toTop" type="button" class="btn btn-primary rounded-circle ms-auto p-2"><span class="visually-hidden">Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M6 15l6 -6l6 6"></path></svg></button>
</div>

    
  </body>
</html>
