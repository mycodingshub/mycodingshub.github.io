<!doctype html>
<html lang="ko" data-bs-theme="auto">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<script 
  src="/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js"
  integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg=">
</script>


<link rel="stylesheet" href="/main.86b7305f5a96b7dd3a46fa6277d87b125af3bf13f48c4cfcc269be84fa9e8fb75375d45a5fe9056ce9190644b7a6e5f13f917f12d853ed38bb76d8856898f755.css" integrity="sha512-hrcwX1qWt906Rvpid9h7ElrzvxP0jEz8wmm+hPqej7dTddRaX+kFbOkZBkS3puXxP5F/EthT7Ti7dtiFaJj3VQ==" crossorigin="anonymous">

<noscript><style>img.lazyload { display: none; }</style></noscript><title>Fullstack 강좌 - Hono RPC &#43; Remix &#43; Cloudflare &#43; D1 DB 조합으로 Todo 앱 만들기</title>
<meta name="description" content="Hono RPC 기능을 활용하여 API Endpoint 구축하여 Remix Framework으로 Todo 앱 만들기" />
<link rel="canonical" href="https://mycodingshub.github.io/blog/2024-10-19-cloudflare-remix-hono-todo-app/" />
<meta name="robots" content="index, follow" />

<meta property="og:type" content="article" />
<meta property="og:title" content="Fullstack 강좌 - Hono RPC &#43; Remix &#43; Cloudflare &#43; D1 DB 조합으로 Todo 앱 만들기" />
<meta property="og:description" content="Hono RPC 기능을 활용하여 API Endpoint 구축하여 Remix Framework으로 Todo 앱 만들기" />
<meta property="og:url" content="https://mycodingshub.github.io/blog/2024-10-19-cloudflare-remix-hono-todo-app/" />
<meta property="og:site_name" content="Home" />
<meta property="og:image" content="https://mycodingshub.github.io/cover.png" />
<meta property="og:locale" content="en" />
<meta property="article:published_time" content="2024-10-19T03:00:08Z" />
<meta property="article:modified_time" content="2024-10-19T03:00:08Z" />
<meta property="article:tag" content="remix" />
<meta property="article:tag" content="hono" />
<meta property="article:tag" content="rpc" />
<meta property="article:tag" content="cloudflare" />
<meta property="article:tag" content="api endpoint" />
<meta property="article:tag" content="todo app" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Fullstack 강좌 - Hono RPC &#43; Remix &#43; Cloudflare &#43; D1 DB 조합으로 Todo 앱 만들기" />
<meta name="twitter:description" content="Hono RPC 기능을 활용하여 API Endpoint 구축하여 Remix Framework으로 Todo 앱 만들기" />
<meta name="twitter:image" content="https://mycodingshub.github.io/cover.png" />

<meta name="author" content="cpro95@gmail.com" />

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "\"Fullstack 강좌 - Hono RPC + Remix + Cloudflare + D1 DB 조합으로 Todo 앱 만들기\"",
  "description": "\"Hono RPC 기능을 활용하여 API Endpoint 구축하여 Remix Framework으로 Todo 앱 만들기\"",
  "datePublished": "\"2024-10-19T03:00:08Z\"",
  "dateModified": "\"2024-10-19T03:00:08Z\"",
  "author": {
    "@type": "Person",
    "name": "\"cpro95@gmail.com\""
  },
  "image": "\"https://mycodingshub.github.io/cover.png\"",
  "url": "\"https://mycodingshub.github.io/blog/2024-10-19-cloudflare-remix-hono-todo-app/\"",
  "publisher": {
    "@type": "Organization",
    "name": "\"Home\""
  }
}
</script>




<script async src="https://www.googletagmanager.com/gtag/js?id=G-C7SBETWEJ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C7SBETWEJ0');
</script>


<script
  async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7748316956330968"
  crossOrigin="anonymous"
></script>


</head>

  
  <body class="single section blog" data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0">
    <div class="sticky-top">
<header class="navbar navbar-expand-sm">
  <div class="container-lg">
  <div class="d-flex flex-grow-1 justify-content-between">
    <div class="d-flex flex-row navbar-nav justify-content-between align-items-start gap-2">
    
    <a class="nav-link fw-bold fs-4" href="/">Home</a>

    
    
            <a class="nav-link fs-4  active" href="https://mycodingshub.github.io/blog/" aria-current="true">Blog</a>
          
        
            <a class="nav-link fs-4 " href="https://mycodingshub.github.io/life/">Life</a>
          
        
    </div>
    <div class="d-flex flex-row justify-content-between align-items-center">
      
      
      <button type="button" id="searchToggleMobile" class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="21" y1="21" x2="15" y2="15"></line>
        </svg>
      </button>
      
      
      <button type="button" id="searchToggleDesktop" class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="21" y1="21" x2="15" y2="15"></line>
        </svg>
      </button>
      
      <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type="button" aria-label="Toggle theme">
        <svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
        </svg>
        <svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0m-5 0h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
        </svg>
      </button>
      </div>
        
        
        
        
        </div>
    </div>

    
    </div>
</header>
</div>

<div class="modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1>
        <button type="button" class="btn-close visually-hidden" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="search-input flex-grow-1 d-none">
          <form id="search-form" class="search-form" action="#" method="post" accept-charset="UTF-8" role="search">
            <label for="query" class="visually-hidden">Search</label>
            <div class="d-flex">
              <input type="search" id="query" name="query" class="search-text form-control form-control-lg" placeholder="Search" aria-label="Search" maxlength="128" autocomplete="off">
              <button type="button" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-body">
        <p class="search-loading status message d-none mt-3 text-center">Loading search index…</p>
        <p class="search-no-recent message d-none mt-3 text-center">No recent searches</p>
        <p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p>
        <div id="searchResults" class="search-results"></div>
        <template>
          <article class="search-result list-view">
            <div class="card my-3">
              <div class="card-body">
                <header>
                  <h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2>
                  <div class="submitted d-none"><time class="created-date">Date here</time></div>
                </header>
                <div class="content">Summary here</div>
              </div>
            </div>
          </article>
        </template>
      </div>
      <div class="modal-footer">
        <ul class="list-inline me-auto d-none d-md-block">
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li>
        </ul>
        <p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p>
      </div>
    </div>
  </div>
</div>


    <div class="wrap container-lg" role="document">
      <div class="content">
      
        
<article>
  <div class="row justify-content-center">
    <div class="col-md-12 col-lg-12">
      
      <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-7748316956330968"
        data-ad-slot="2971373181"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      <div class="blog-header">
        <h1>Fullstack 강좌 - Hono RPC &#43; Remix &#43; Cloudflare &#43; D1 DB 조합으로 Todo 앱 만들기</h1>
        <p>
  <small>October 19, 2024<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>24&nbsp;minutes</span></small>
</p>

      </div>
    </div>
      <div class="col-md-12 col-lg-12">
      
      <p>안녕하세요?</p>
<p>지난 시간에 이어 Cloudflare에서 Remix Framework과 Hono의 RPC 기능을 활용한 API Endpoint 구축하기 2번째 편인 Todo 앱 만들기를 진행하도록 하겠습니다.</p>
<p>1편에서는 Hono RPC를 이용한 API Endpoint를 KV로 구축했는데요.</p>
<p>API를 Hono로 작성하는 방법과 Remix에서 Hono를 이용하는 방법, 그리고 최종적으로 Cloudflare network에 배포까지 끝냈는데요.</p>
<p>오늘은 본격적인 테스트 앱으로 Todo 앱을 D1 DB를 이용해 보겠습니다.</p>
<p>지난 시간에는 KV의 사용방법을 배웠기 때문에 오늘은 D1 DB를 배워본다는 개념으로 강의 진행하겠습니다.</p>
<p>아래는 지난 시간 강좌 링크입니다.</p>
<p><a href="https://mycodingshub.github.io/blog/2024-10-14-cloudflare-remix-framework-hono-rpc-api-endpoint">Cloudflare에서 Remix Framework과 Hono의 RPC 기능을 활용한 API Endpoint 구축하기</a></p>
<hr>
<h2 id="d1-db-설정">D1 DB 설정</h2>
<p>먼저, D1 DB의 설정부터 시작해야하는데요.</p>
<p>터미널 상에서 다음과 같이 입력하시면 wrangler가 아주 쉽게 DB를 구축해 줍니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ npx wrangler d1 create remix-hono-todo-test
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> ⛅️ wrangler 3.57.1 <span class="o">(</span>update available 3.80.5<span class="o">)</span>
</span></span><span class="line"><span class="cl">-------------------------------------------------------
</span></span><span class="line"><span class="cl">✅ Successfully created DB <span class="s1">&#39;remix-hono-todo-test&#39;</span> in region APAC
</span></span><span class="line"><span class="cl">Created your new D1 database.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[[</span>d1_databases<span class="o">]]</span>
</span></span><span class="line"><span class="cl"><span class="nv">binding</span> <span class="o">=</span> <span class="s2">&#34;DB&#34;</span> <span class="c1"># i.e. available in your Worker on env.DB</span>
</span></span><span class="line"><span class="cl"><span class="nv">database_name</span> <span class="o">=</span> <span class="s2">&#34;remix-hono-todo-test&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">database_id</span> <span class="o">=</span> <span class="s2">&#34;b8asfdfa-9sadfe37-4fasdfd71-casdfsddb614&#34;</span> <span class="c1"># 참고로, 강의를 위한 fake id입니다.</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 터미널상에 D1 DB의 설정 세팅값까지 친절하게 알려주는데요.</p>
<p>wrangler.toml 파일의 아래부분을 위에서 얻은 세팅값으로 바꿔주면 끝입니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># [[d1_databases]]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># binding = &#34;MY_DB&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># database_name = &#34;my-database&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># database_id = &#34;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#34;</span></span></span></code></pre></div>
  </figure>
</div>
<p>이제 D1 DB를 생성까지 했는데요.</p>
<p>이제는 실제 DB의 테이블을 만들어야 합니다.</p>
<p>보통 여기서 Drizzle ORM 같은 ORM을 사용하는데요.</p>
<p>제 예전 강좌 보시면 Drizzle ORM 사용법이 나옵니다.</p>
<p>그런데 오늘은 Drizzle ORM 없이 진행해 보려고 합니다.</p>
<p>먼저, 만들려고 하는 테이블의 스키마 파일을 만들어야 합니다.</p>
<p>일단 db 폴더를 만들고 그 밑에 &lsquo;schema.sql&rsquo; 파일을 아래와 같이 만듭시다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">DROP TABLE IF EXISTS Todos<span class="p">;</span>
</span></span><span class="line"><span class="cl">CREATE TABLE IF NOT EXISTS Todos <span class="o">(</span>
</span></span><span class="line"><span class="cl">  id INTEGER PRIMARY KEY AUTOINCREMENT,
</span></span><span class="line"><span class="cl">  title TEXT NOT NULL,
</span></span><span class="line"><span class="cl">  completed INTEGER NOT NULL DEFAULT <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">INSERT INTO Todos <span class="o">(</span>title<span class="o">)</span> VALUES <span class="o">(</span><span class="s2">&#34;test&#34;</span><span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위에서 보시는 건 바로 SQlite3의 SQL 문(statement)인데요.</p>
<p>영어 그대로 해석하셔도 쉽게 무슨 뜻인지 알 수 있을 겁니다.</p>
<p>이 강좌는 SQLite3 강좌가 아니라서 상세한 설명은 건너 뛰겠습니다.</p>
<p>위 sql 파일은 Todos라는 테이블을 만드는데, id는 integer 값 (정수값)이고 autoincrement 성격을 갖습니다.</p>
<p>그리고 title은 텍스트 값이고, 중요한 completed는 아무리 봐도 boolean 값이 들어가야 하는데, 위에서는 integer 값으로 설정되었는데요.</p>
<p>SQlite3는 boolean 타입을 지원하지 않습니다.</p>
<p>그래서 integer 타입으로 설정하고 0 이면 false, 1 이면 true로 취급하는게 일반적인 코딩 룰입니다.</p>
<p>그리고 디폴트(default) 값으로 0으로 설정했기 때문에 아무것도 안하면 알아서 0으로 세팅됩니다.</p>
<p>그리고 마지막으로 더미 데이터 한개를 INSERT 문으로 삽입했습니다.</p>
<p>그러면 이 schema.sql 파일을 아까 우리가 만든 &lsquo;DB&rsquo;라는 바인딩 이름인 실제 DB에 적용해야 하는데요.</p>
<p>여기서 중요한 점은 두 군데에 적용해야 한다는 겁니다.</p>
<p>한 군데는 실제 Cloudflare Network상의 D1 DB에 적용하는 거고, 두 번째는 로컬 즉, 우리가 테스트를 위해 개발 서버를 돌리는 여러분의 실제 컴퓨터에 적용해야하는 겁니다.</p>
<p>로컬 개발 서버에 설치하려면 &lsquo;&ndash;local&rsquo; 옵션을 주면 되고, 실제 Cloudflare Network에 적용하려면 &lsquo;&ndash;remote&rsquo; 옵션을 주면 됩니다.</p>
<p>그러면 실제로 적용해 보겠습니다.</p>
<p>아래와 같이 터미널에서 명령문을 입력하고 실행해 보시죠.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ npx wrangler d1 execute remix-hono-todo-test --local --file<span class="o">=</span>./db/schema.sql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> ⛅️ wrangler 3.57.1 <span class="o">(</span>update available 3.80.5<span class="o">)</span>
</span></span><span class="line"><span class="cl">-------------------------------------------------------
</span></span><span class="line"><span class="cl">🌀 Executing on <span class="nb">local</span> database remix-hono-todo-test
</span></span><span class="line"><span class="cl"><span class="o">(</span>xxxx-x-x-x-x-xxx-x-x-x-x<span class="o">)</span> from .wrangler/state/v3/d1:
</span></span><span class="line"><span class="cl">🌀 To execute on your remote database, add a --remote flag to your wrangler command.</span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 d1 다음에 execute 명령어를 주면 됩니다.</p>
<p>그리고 &lsquo;&ndash;local&rsquo; 옵션과 schema.sql 파일의 위치를 알려주는 &lsquo;&ndash;file&rsquo; 옵션을 주었습니다.</p>
<p>위와 같이 나오면 성공적으로 실행된겁니다.</p>
<p>그리고 두 번째 실제 Cloudflare Network 상에 테이블을 생성하려면 &lsquo;&ndash;local&rsquo; 옵션을 &lsquo;&ndash;remote&rsquo;라는 옵션으로 바꿔 주면 됩니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ npx wrangler d1 execute remix-hono-todo-test --remote --file<span class="o">=</span>./db/schema.sql     
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> ⛅️ wrangler 3.80.5
</span></span><span class="line"><span class="cl">-------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">✔ ⚠️ This process may take some time, during which your D1 database will be unavailable to serve queries.
</span></span><span class="line"><span class="cl">  Ok to proceed? … yes
</span></span><span class="line"><span class="cl">🌀 Executing on remote database remix-hono-todo-test
</span></span><span class="line"><span class="cl"><span class="o">(</span>xxxxx-xxxxx-x-x-x-x-x-x
</span></span><span class="line"><span class="cl"><span class="o">)</span>:
</span></span><span class="line"><span class="cl">🌀 To execute on your <span class="nb">local</span> development database, remove the --remote flag from your wrangler command.
</span></span><span class="line"><span class="cl">Note: <span class="k">if</span> the execution fails to complete, your DB will <span class="k">return</span> to its original state and you can safely retry.
</span></span><span class="line"><span class="cl">├ 🌀 Uploading xxxxx-xxxxx-x-x-x-x-x-x cf2be6e449aa524e.sql 
</span></span><span class="line"><span class="cl">│ 🌀 Uploading complete.
</span></span><span class="line"><span class="cl">│ 
</span></span><span class="line"><span class="cl">🌀 Starting import...
</span></span><span class="line"><span class="cl">🌀 Processed <span class="m">3</span> queries.
</span></span><span class="line"><span class="cl">🚣 Executed <span class="m">3</span> queries in 0.00 seconds <span class="o">(</span><span class="m">3</span> rows read, <span class="m">6</span> rows written<span class="o">)</span>
</span></span><span class="line"><span class="cl">   Database is currently at bookmark
</span></span><span class="line"><span class="cl">   00000002-00005-00e2d-7412dc6fa898327fcf8a378bf.
</span></span><span class="line"><span class="cl">┌────────────────────────┬───────────┬──────────────┬────────────────────┐
</span></span><span class="line"><span class="cl">│ Total queries executed │ Rows <span class="nb">read</span> │ Rows written │ Database size <span class="o">(</span>MB<span class="o">)</span> │
</span></span><span class="line"><span class="cl">├────────────────────────┼───────────┼──────────────┼────────────────────┤
</span></span><span class="line"><span class="cl">│ <span class="m">3</span>                      │ <span class="m">3</span>         │ <span class="m">6</span>            │ 0.02               │
</span></span><span class="line"><span class="cl">└────────────────────────┴───────────┴──────────────┴────────────────────┘</span></span></code></pre></div>
  </figure>
</div>
<p>&ldquo;Ok to proceed? 라고 나오는데 엔터키를 누르면 진행됩니다.</p>
<p>간혹가다가 다음과 같은 에러가 나올때가 있는데요.</p>
<p>wrangler 버전 관련 문구가 나올 때가 있습니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">✘ <span class="o">[</span>ERROR<span class="o">]</span> Cannot <span class="nb">read</span> properties of undefined <span class="o">(</span>reading <span class="s1">&#39;forEach&#39;</span><span class="o">)</span></span></span></code></pre></div>
  </figure>
</div>
<p>이럴 때는 wrangler를 해당 최신버전을 올리면 해결됩니다.</p>
<p>이제 실제 Cloudflare 대시보드에 가서 확인해 볼까요?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEik_5D7zxnb5saWp91vYX4DEtfX8Z1WGgCCYg7q5wRl_8_SMlfVa-LeN4DTqV8a-YCALi_GNEHHV6HakE0LNca_f3KMXxPPmHFSuE0o6U-UMQbrIHtNzMVCgjeLQxyM90Yak5Iwm5a_pSY967j-1Qfs5Gn_NOG_vrdKUdiSw_10CC9LLCEO6ZiYbbxJ0qk"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위 그림과 같이 잘 적용되었네요.</p>
<hr>
<h2 id="db-바인딩-값-env에-적용하기">DB 바인딩 값 Env에 적용하기</h2>
<p>이제 새로운 Cloudflare 서비스를 이용하려고 세팅했기 때문에 아래와 같이 &ldquo;typegen&rdquo; 명령어로 Env 인터페이스를 업데이트 해줘야 합니다.</p>
<p>터미널 상에 아래와 같이 입력합시다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ npm run typegen
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; typegen
</span></span><span class="line"><span class="cl">&gt; wrangler types
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> ⛅️ wrangler 3.80.5
</span></span><span class="line"><span class="cl">-------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Generating project types...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">interface Env <span class="o">{</span>
</span></span><span class="line"><span class="cl">        kv: KVNamespace<span class="p">;</span>
</span></span><span class="line"><span class="cl">        SECRET: <span class="s2">&#34;secret is hono-remix-adapter&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        DB: D1Database<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 wrangler가 Env 인터페이스를 업데이트 했네요.</p>
<p>해당 내용은 &lsquo;worker-configuration.d.ts&rsquo; 파일에 잘 적용되어 있습니다.</p>
<p>이제 Hono RPC에서 D1 DB를 이용할 준비가 다 끝났습니다.</p>
<p>이제 본격적으로 Hono를 이용해서 Todo 앱을 위한 API Endpoint를 작성해 보겠습니다.</p>
<hr>
<h2 id="hono로-api-route-구축하기">Hono로 API route 구축하기</h2>
<p>Hono의 서버 파일이 server 폴더의 index.ts 파일인데요.</p>
<p>이 파일안에 모든 라우팅의 API 코드를 쑤셔 넣는다는 거는 조금 비효율적인데요.</p>
<p>다행히 Hono는 모듈러 방식의 코드 쪼개기(Splitting)을 지원해 줍니다.</p>
<p>server 폴더에 api 폴더를 만들고 그 밑에 또 다시 todos 폴더를 만들고 todos 폴더 밑에 일단 &lsquo;index.ts&rsquo; 파이을 만듭시다.</p>
<p>이 파일이 우리가 만드려고 하는 &lsquo;api/todos&rsquo;가 엔드포인트인 API 라우팅의 가장 기본이 되는 파일이 되는겁니다.</p>
<p>일단 이 파일의 구성을 대체적으로 살펴봅시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// &#39;/server/api/todo/index.ts&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Hono</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;hono&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">getTodos</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;./model&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// RPC를 위해서는 new Hono&lt;&gt;().get 형식으로 붙혀서 만들어야 한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">api_todos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hono</span><span class="o">&lt;</span><span class="p">{</span> <span class="nx">Bindings</span>: <span class="kt">Env</span> <span class="p">}</span><span class="o">&gt;</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;/todos&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">todos</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getTodos</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">api_todos</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 만들어야 합니다.</p>
<p>RPC를 위해서는 Hono 객체를 만들고 꼭 메서드 체이닝 방식으로 구현해야 합니다.</p>
<p>Hono 공식문서에서도 얘기해 주지 않아 이거 때문에 3시간 삽질했는데요.</p>
<p>일단 이렇게 코드를 작성했습니다.</p>
<p>저는 실제 DB 관련된 코드는 model 이란 파일에 별도로 따로 작성하려고 합니다.</p>
<p>&lsquo;/server/api/todo/index.ts&rsquo; 파일은 순전히 Hono의 라우팅만 중점적으로 집중하기 위해서입니다.</p>
<p>참고로 &lsquo;c.env.DB&rsquo;라고 하면 우리가 만든 Cloudflare D1 DB를 지칭하게 됩니다.</p>
<p>왜 이름이 DB냐면 아까 우리가 아래와 같이 지정한 그 이름이 &lsquo;DB&rsquo;이기 때문입니다.</p>
<p>다른 이름으로 별칭을 만들어도 됩니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="o">[[</span>d1_databases<span class="o">]]</span>
</span></span><span class="line"><span class="cl"><span class="nv">binding</span> <span class="o">=</span> <span class="s2">&#34;DB&#34;</span> <span class="c1"># i.e. available in your Worker on env.DB</span>
</span></span><span class="line"><span class="cl"><span class="nv">database_name</span> <span class="o">=</span> <span class="s2">&#34;remix-hono-todo-test&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">database_id</span> <span class="o">=</span> <span class="s2">&#34;b8asfdfa-9sadfe37-4fasdfd71-casdfsddb614&#34;</span></span></span></code></pre></div>
  </figure>
</div>
<p>그러면 같은 폴더에 model.ts 파일을 만들고 getTodos 함수를 구현해 보겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">z</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Todo 스키마
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">TodoSchema</span> <span class="o">=</span> <span class="nx">z</span><span class="p">.</span><span class="kt">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span>: <span class="kt">z.number</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">title</span>: <span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">max</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">completed</span>: <span class="kt">z.number</span><span class="p">().</span><span class="k">default</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">interface</span> <span class="nx">Todo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">title</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">completed</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">getTodos</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">DB</span>: <span class="kt">D1Database</span><span class="p">)</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">Todo</span><span class="err">[]</span><span class="p">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// SQL 쿼리를 사용해 D1에서 모든 Todo 항목을 가져옴
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="s2">&#34;SELECT * FROM Todos&#34;</span><span class="p">).</span><span class="nx">all</span><span class="p">&lt;</span><span class="nt">Todo</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 쿼리 결과를 반환
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">results</span> <span class="o">||</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Failed to fetch todos from D1 DB&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드를 보시면 나중을 위해 TodoSchema를 미리 세팅해 놨습니다.</p>
<p>POST 메서드일 때 쓸 예정입니다.</p>
<p>그리고 Promise 리턴 타입으로 쓸 Todo 타입을 interface를 이용해서 새로 만들었습니다.</p>
<p>그리고 대망의 getTodos 함수인데요.</p>
<p>Cloudflare D1 DB 튜토리얼에 가시면 DB.prepare 함수와 all, run, first 메서드를 쓰는 방법이 다 나왔으니 꼭 읽어보시기 바랍니다.</p>
<p>위 코드는 Todos 테이블에서 모든 걸 (all 메서드 사용) 가져오라는 명령인데요.</p>
<p>D1 DB가 all() 함수로 실행되면 리턴하는 result 객체의 타입을 미리 공부할 필요가 있는데요.</p>
<p>아래와 같은 타입으로 리턴됩니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// result type of method all()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">success</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">meta</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">served_by</span><span class="o">:</span> <span class="s1">&#39;miniflare.db&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">duration</span>: <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">changes</span>: <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">last_row_id</span>: <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">changed_db</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">size_after</span>: <span class="kt">16384</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">rows_read</span>: <span class="kt">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">rows_written</span>: <span class="kt">0</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nx">results</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span> <span class="nx">id</span>: <span class="kt">9</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;1111&#39;</span><span class="p">,</span> <span class="nx">completed</span>: <span class="kt">0</span> <span class="p">}</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>실제 Sqlite3의 리턴타입은 위와 같지 않습니다.</p>
<p>위와 같은 리턴 타입은 Cloudflare가 modify한 겁니다.</p>
<p>일단 success 값으로 SQL 쿼리 실행여부를 쉽게 알아 볼 수 있고, results 값으로 리턴값만 쉽게 알 수도 있습니다.</p>
<p>그러면 이제 getTodos 함수의 역할이 이해 되시죠?</p>
<p>이제 getTodos 함수와 Hono의 API Endpoint 구성이 90% 끝났습니다.</p>
<p>마지막 10%의 설정은 바로 server 폴더의 index.ts 파일에 우리가 만든 API Endpoint 라우팅을 삽입시키고 RPC를 위한 AppType을 만들어야 합니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// &#39;/server/index.ts&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Hono</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;hono&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">cors</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;hono/cors&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">api_todos</span> <span class="kr">from</span> <span class="s2">&#34;./api/todos&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hono</span><span class="o">&lt;</span><span class="p">{</span> <span class="nx">Bindings</span>: <span class="kt">Env</span> <span class="p">}</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&#34;*&#34;</span><span class="p">,</span> <span class="nx">cors</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// KV를 어떻게 사용하는지 보여주는 예전 코드
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;/hono-test&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">kv</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">kv</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s2">&#34;hono-remix-adapter&#34;</span><span class="p">,</span> <span class="s2">&#34;hono can access cloudflare kv&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">kv</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;hono-remix-adapter&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="sb">`Hono kv is ok, value is </span><span class="si">${</span><span class="nx">value</span><span class="si">}</span><span class="sb"> ,</span><span class="err">\</span><span class="sb">n My_var is </span><span class="si">${</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="si">}</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">route</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s2">&#34;/api&#34;</span><span class="p">,</span> <span class="nx">api_todos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">app</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Hono RPC를 위한 AppType export 시키기
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kr">type</span> <span class="nx">AppType</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">route</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드를 잘 보시면 일단 Hono 객체를 app이라는 이름으로 만들었습니다.</p>
<p>이 app 이라는 이름의 Hono객체가 메인 라우팅이되고, 그리고 아까 우리가 만들었던 api_todos 라우팅이 서브 라우팅이 되는거죠.</p>
<p>그리고 export type AppType 방식으로 RPC를 위한 AppType을 export 했습니다.</p>
<p>참고로, 메인 라우팅이 되는 app객체에 get 메서드로 &lsquo;hono-test&rsquo; 라는 라우팅을 구현했습니다.</p>
<p>KV를 테스트 하기 위해 예전에 작성한 코드입니다.</p>
<p>사실 위 코드는 없어도 되는데 순전히 테스트를 위해 남겨놓은 거니 나중에 불필요하시면 지우시면 됩니다.</p>
<p>이제 설정이 끝났습니다.</p>
<hr>
<h2 id="remix에서-rpc를-이용해서-gettodos-함수-실행하기">Remix에서 RPC를 이용해서 getTodos 함수 실행하기</h2>
<p>이제 Client side 쪽 코드입니다.</p>
<p>엄밀히는 Remix Framework 쪽 코드를 만들어야 겠죠.</p>
<p>먼저, RPC를 위해 아래와 같은 유틸리티 파일을 먼저 만듭시다.</p>
<p>app 폴더 밑에 utils 폴더를 만들고 &lsquo;apiClient.ts&rsquo; 파일을 만들고 아래와 같이 입력합시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// &#39;/app/utils/apiClient.ts&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">hc</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;hono/client&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">AppType</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;../../server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">  <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MODE</span> <span class="o">===</span> <span class="s2">&#34;production&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">?</span> <span class="nx">hc</span><span class="p">&lt;</span><span class="nt">AppType</span><span class="p">&gt;(</span><span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VITE_API_URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">:</span> <span class="nx">hc</span><span class="p">&lt;</span><span class="nt">AppType</span><span class="p">&gt;(</span><span class="s2">&#34;http://localhost:5173/&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">clientGetTodos</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">$get</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드를 보시면 Hono의 RPC를 실제로 만드는 방법이 나오는데요.</p>
<p>&lsquo;hono/client&rsquo;가 제공해 주는 hc 함수를 이용해서 아까 export 했던 AppType을 제네릭 타입으로 넣고, 그리고 중요한 해당 API 서버 주소를 넣어주면 끝입니다.</p>
<p>저는 production 모드일 때는 실제 주소로 넣고, 개발 모드일 경우 localhost:5173으로 넣도록 삼항연산자를 위와 같이 적용했습니다.</p>
<p>그리고 실제 클라이언트 사이드쪽에서 사용할 clientGetTodos 함수를 만들었는데요.</p>
<p>이 코드가 바로 클라이언트에서 실행되면 위와 같이 Hono의 RPC API Endpoint를 실행시켜 원하는 데이터를 가져오는 원리입니다.</p>
<p>위 코드를 보시면 우리가 만든 client 객체에 체인 방식으로 api, todos를 넣었습니다.</p>
<p>왜 &lsquo;api.todos&rsquo;하고 그 다음에 &ldquo;$get()&rdquo; 메서드를 실행했냐면 우리가 아까 Hono의 API Endpoint를 만들 때 경로가 바로 api 폴더 밑에 todos 폴더 밑의 index.ts 파일이었기 때문입니다.</p>
<p>실제로 브라우저에서도 &ldquo;http://localhost:5173/api/todos&quot;해도 똑같이 작동합니다.</p>
<p>그래서 실제 브라우저의 경로명대로 client 뒤에 메서드 체이닝 방식으로 라우팅 주소를 넣어주고 마지막에 원하는 GET 메서드를 지정하는 겁니다.</p>
<p>만약 POST 메서드라면 다음과 같이 하면 되겠죠.</p>
<p><code>client.api.todos.$post()</code></p>
<p>그리고 중요한거는 $get 함수를 실행해야 한다는 겁니다.</p>
<p>그래서 $get 함수명 뒤에 &lsquo;()&rsquo; 괄호를 붙혀 해당 $get 함수를 실행(invoke) 시켰습니다.</p>
<p>이제 apiClient 유틸리티 파일의 작성이 끝났으면 이 다음에는 실제 클라이언트쪽에서 todos 라우팅을 구현해 보겠습니다.</p>
<p>그 앞에 먼저, routes 폴더 밑의 &lsquo;_index.tsx&rsquo; 파일을 아래와 같이 수정해서 메인 페이지를 조금 간단하게 수정하겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="kr">type</span> <span class="p">{</span> <span class="nx">MetaFunction</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@remix-run/cloudflare&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">meta</span>: <span class="kt">MetaFunction</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&#34;New Remix App&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;description&#34;</span><span class="p">,</span> <span class="nx">content</span><span class="o">:</span> <span class="s2">&#34;Welcome to Remix!&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">Index() {</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex h-screen items-center justify-center&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex flex-col items-center gap-16&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">header</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex flex-col items-center gap-9&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;leading text-2xl font-bold text-gray-800 dark:text-gray-100&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Welcome</span> <span class="nx">to</span> <span class="p">&lt;</span><span class="nt">span</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;sr-only&#34;</span><span class="p">&gt;</span><span class="nx">Remix</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;h-[144px] w-[434px]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">img</span>
</span></span><span class="line"><span class="cl">              <span class="na">src</span><span class="o">=</span><span class="s">&#34;/assets/logo-light.png&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">alt</span><span class="o">=</span><span class="s">&#34;Remix&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">className</span><span class="o">=</span><span class="s">&#34;block w-full dark:hidden&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">img</span>
</span></span><span class="line"><span class="cl">              <span class="na">src</span><span class="o">=</span><span class="s">&#34;/assets/logo-dark.png&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">alt</span><span class="o">=</span><span class="s">&#34;Remix&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">className</span><span class="o">=</span><span class="s">&#34;hidden w-full dark:block&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex flex-col items-center justify-center gap-4 rounded-3xl border border-gray-200 p-6 dark:border-gray-700&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">a</span>
</span></span><span class="line"><span class="cl">            <span class="na">className</span><span class="o">=</span><span class="s">&#34;group flex items-center gap-3 self-stretch p-3 leading-normal text-blue-700 hover:underline dark:text-blue-500&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="na">href</span><span class="o">=</span><span class="s">&#34;/todos&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="na">rel</span><span class="o">=</span><span class="s">&#34;noreferrer&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Go</span> <span class="nx">to</span> <span class="nx">Todos</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 메인 라우팅을 바꾸면 아래와 같이 간단한 메인 페이지가 나올겁니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEiYWTViPOkP2wrd2VQqFNgu3VxZcXwMrflWHqtvXESdq4aAs_ZS673L8RiCLCirwDqv_8MVPOC6meo-bVYhkQ9kT60bEX4oOOjF6Wes8aggTG0A_s_eZ3GCl-L78GRZeZhGhqfSExNQn2DYWYwg_E7hLGSOc1WbihM6XQl0oKViIOfpYtBzyL67owowAS8"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>이제 본격적인 todos 앱 구현에 들어가 보도록 하겠습니다.</p>
<hr>
<h2 id="todos-라우팅-구현">todos 라우팅 구현</h2>
<p>todos 앱이니까 todos 라는 라우팅을 만들어야겠죠.</p>
<p>Remix에서 라우팅은 간단합니다.</p>
<p>app 폴더 밑의 routes 폴더 밑에 폴더명이든 파일이름이든 적으면 그게 라우팅이 됩니다.</p>
<p>app 폴더 밑에 있는 routes 폴더에 todos.tsx 파일을 아래와 같이 만듭시다.</p>
<p>참고로, UI쪽은 <a href="https://ui.shadcn.com/">shadcn/ui</a>를 사용해서 적용했습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// &#39;/app/routes/todos.tsx&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="kr">type</span> <span class="p">{</span> <span class="nx">LoaderFunctionArgs</span><span class="p">,</span> <span class="nx">MetaFunction</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@remix-run/cloudflare&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">useLoaderData</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@remix-run/react&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Card</span><span class="p">,</span> <span class="nx">CardContent</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;~/components/ui/card&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Checkbox</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;~/components/ui/checkbox&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Todo</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;server/api/todos/model&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">clientGetTodos</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;~/utils/apiClient&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">meta</span>: <span class="kt">MetaFunction</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">[{</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&#34;Todo My App&#34;</span> <span class="p">}];</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">loader</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">({</span> <span class="nx">context</span> <span class="p">}</span><span class="o">:</span> <span class="nx">LoaderFunctionArgs</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">clientGetTodos</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Todo Card
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">TodoItem</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">todo</span> <span class="p">}</span><span class="o">:</span> <span class="p">{</span> <span class="nx">todo</span>: <span class="kt">Todo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">Card</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;mb-4 hover:shadow-md transition-shadow duration-200&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">CardContent</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex items-center p-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">Checkbox</span> <span class="na">id</span><span class="o">=</span><span class="p">{</span><span class="sb">`todo-</span><span class="si">${</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;mr-4&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex-grow&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">label</span>
</span></span><span class="line"><span class="cl">            <span class="na">htmlFor</span><span class="o">=</span><span class="p">{</span><span class="sb">`todo-</span><span class="si">${</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="na">className</span><span class="o">=</span><span class="s">&#34;opacity-100 text-lg font-medium leading-none text-gray-700&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">CardContent</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">Card</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Todos</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">todos</span> <span class="o">=</span> <span class="nx">useLoaderData</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">loader</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;min-h-screen bg-gray-50&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">header</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;bg-white text-gray-800 p-4 shadow-sm&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;container mx-auto&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/todos&#34;</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;text-2xl font-bold&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">My</span> <span class="nx">TODO</span> <span class="nx">App</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">main</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;container mx-auto py-8 px-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;w-full max-w-4xl mx-auto&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;space-y-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">todos</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">              <span class="nx">todos</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">todo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">&lt;</span><span class="nt">TodoItem</span> <span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span> <span class="na">todo</span><span class="o">=</span><span class="p">{</span><span class="nx">todo</span><span class="p">}</span> <span class="p">/&gt;)}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">Todos</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>개발 서버를 실행해보면 아래 그림과 같이 나올겁니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgmzq9lmMVJU3vSmfOjf6tuluLRnERoi8mrgboetdeNTK8Kzj-IGluYLnLgVDqb35a7Opal7SJSIwtRtU_6FYjcSqBGzm6OiV5UQ3k4IueZ5w9m-LQ5wRNqJdzaCREu5UuacA6k252qLUOzlxvrZBEybOPaj4eNMBPVEvPqDxDITH7YuKtRZzDiYKyZrTE"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>어떤가요?</p>
<p>Hono RPC를 이용해서 getTodos 백엔드 함수를 클라이언트에서 손쉽게 client 객체를 이용해서 불러왔습니다.</p>
<p>심지어 Hono RPC의 $get 메서드는 React Query를 구현할 때 제공하는 fetch 함수에 그대로 넣을 수도 있습니다.</p>
<p>Hono 공식 홈페이지를 보시면 사용방법이 나오는데요, 참고 하시기 바랍니다.</p>
<p>todos.tsx 파일의 내용은 loader 함수에서 백엔드쪽 데이터를 얻은 다음 클라이언트 쪽 코드에서는 useLoaderData 훅을 이용해서 그 데이터를 클라이언트쪽 UI에 뿌려주는 전형적인 React 코드입니다.</p>
<p>기본적인 사용방법을 익히셨으면 본격적으로 Input과 Delete그리고 completed 체크박스 토글까지 todos.tsx 파일에 구현해야 하는데요.</p>
<p>그럼 본격적으로 시작해 보겠습니다.</p>
<hr>
<h2 id="update-구현하기">update 구현하기</h2>
<p>이번에 구현할 UI 로직은 체크 박스를 누르면 Todo 앱의 completed 값이 false가 되면서 todo 타이틀의 글자가 line-through 방식으로 보여주게 하는게 최종 목적입니다.</p>
<p>일단 이 방식은 클라이언트쪽에서 단순하게 자바스크립트만을 이용해서 작성하겠습니다.</p>
<p>예전 React 코드 작성방식이랑 같습니다.</p>
<p>먼저, UI쪽 코드를 손보겠습니다.</p>
<p>TodoItem 컴포넌트를 아래와 같이 고칩시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// Todo Card
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">TodoItem</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">todo</span> <span class="p">}</span><span class="o">:</span> <span class="p">{</span> <span class="nx">todo</span>: <span class="kt">Todo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">isCompleted</span><span class="p">,</span> <span class="nx">setIsCompleted</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">handleCheckboxChange</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">checked</span>: <span class="kt">boolean</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">todos</span><span class="p">[</span><span class="s2">&#34;:id&#34;</span><span class="p">].</span><span class="nx">$put</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">json</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span>: <span class="kt">todo.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">completed</span>: <span class="kt">isCompleted</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nx">param</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span>: <span class="kt">todo.id.toString</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">setIsCompleted</span><span class="p">(</span><span class="nx">isCompleted</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">1</span> : <span class="kt">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">Card</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;mb-4 hover:shadow-md transition-shadow duration-200&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">CardContent</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex items-center p-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">Checkbox</span>
</span></span><span class="line"><span class="cl">          <span class="na">id</span><span class="o">=</span><span class="p">{</span><span class="sb">`todo-</span><span class="si">${</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">isCompleted</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">onCheckedChange</span><span class="o">=</span><span class="p">{</span><span class="nx">handleCheckboxChange</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">className</span><span class="o">=</span><span class="s">&#34;mr-4&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex-grow&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">label</span>
</span></span><span class="line"><span class="cl">            <span class="na">htmlFor</span><span class="o">=</span><span class="p">{</span><span class="sb">`todo-</span><span class="si">${</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">              opacity-100 text-lg font-medium leading-none </span><span class="si">${</span>
</span></span><span class="line"><span class="cl">                <span class="nx">isCompleted</span> <span class="o">?</span> <span class="s2">&#34;line-through text-gray-400&#34;</span> <span class="o">:</span> <span class="s2">&#34;text-gray-700&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">CardContent</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">Card</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>뭔가 복잡한데 아주 쉬운 자바스크립트 코드입니다.</p>
<p>먼저, UI 쪽 보시면 label 태그가 &lsquo;isCompleted&rsquo;라는 state 값에 따라 &rsquo;line-through&rsquo; 가 적용되냐 안되냐로 작동합니다.</p>
<p>Checkbox 쪽에도 &lsquo;checked&rsquo; 값을 isCompleted&rsquo;라는 state 값에 따라 적용시켰습니다.</p>
<p>이제 onCheckedChange 핸들러인 handleCheckboxChange 함수에 의해 DB쪽을 제어하는 코드를 봐야하는데 아래와 같습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">todos</span><span class="p">[</span><span class="s2">&#34;:id&#34;</span><span class="p">].</span><span class="nx">$put</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">json</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span>: <span class="kt">todo.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">completed</span>: <span class="kt">isCompleted</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nx">param</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span>: <span class="kt">todo.id.toString</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드를 보니까 put 메서드를 이용해서 completed 값을 업데이트 하고 있네요.</p>
<p>그런데 todos 다음에 문자열 배열을 넣고 있습니다.</p>
<p>이게 바로 URL params를 넣는 방식입니다.</p>
<p>여기서는 &lsquo;id&rsquo;라는 params를 넣고 있는거죠.</p>
<p>id는 TodoItem 컴포넌트가 props로 받고 있는 Todo객체에 있습니다.</p>
<p>그리고 그 값은 바로 &rsquo;todo.id&rsquo;가 되는거죠.</p>
<p>현재 SQlite3 Table에는 id는 integer 값입니다.</p>
<p>그래서 URL로 넘겨줄 때는 string 값으로 고쳐야합니다.</p>
<p>&rsquo;todo.id.toString()&rsquo; 이렇게 하시면 됩니다.</p>
<p>$put 메서드에는 json 값과 param 값을 객체로 따로 넣었는데요.</p>
<p>이 json 값과 param 값이 실제 Hono 백엔드에서 어떻게 처리되는지도 유심히 살펴봐야 합니다.</p>
<hr>
<p>이제 Hono를 이용한 백엔드 코드에서 put 메서드를 구현해야 겠습니다.</p>
<p>다시 &lsquo;server/api/todos/index.ts&rsquo; 파일에서 아래와 같이 코드를 추가합시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// &#39;server/api/todos/index.ts&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Hono</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;hono&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">getTodos</span><span class="p">,</span> <span class="nx">updateTodo</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;./model&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">zValidator</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@hono/zod-validator&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// RPC를 위해서는 new Hono&lt;&gt;().get 형식으로 붙혀서 만들어야 한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">api_todos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hono</span><span class="o">&lt;</span><span class="p">{</span> <span class="nx">Bindings</span>: <span class="kt">Env</span> <span class="p">}</span><span class="o">&gt;</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;/todos&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">todos</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getTodos</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s2">&#34;/todos/:id&#34;</span><span class="p">,</span> <span class="nx">zValidator</span><span class="p">(</span><span class="s2">&#34;json&#34;</span><span class="p">,</span> <span class="nx">TodoSchema</span><span class="p">),</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">validatedData</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">valid</span><span class="p">(</span><span class="s2">&#34;json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(validatedData);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">updateTodo</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">title</span>: <span class="kt">validatedData.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">completed</span>: <span class="kt">validatedData.completed</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">1</span> : <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="nx">ok</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">api_todos</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>zValidator는 그냥 import 하시면 됩니다.</p>
<p>이제 필요한건 model 폴더에 있는 updateTodo 함수인데요.</p>
<p>&lsquo;model.ts&rsquo; 파일에서 아래와 같이 updateTodo 함수를 만듭시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">interface</span> <span class="nx">UpdateTodoType</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">title</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">completed</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">updateTodo</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DB</span>: <span class="kt">D1Database</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span>: <span class="kt">number</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">param</span>: <span class="kt">UpdateTodoType</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">void</span><span class="p">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="s2">&#34;SELECT * FROM Todos where id = ?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">first</span><span class="p">&lt;</span><span class="nt">Todo</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Todo with id </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> not found.`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 업데이트할 항목 정의 (기존 값과 새로운 값 병합)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">updatedTodo</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span><span class="nx">todo</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span><span class="nx">param</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// D1 DB에서 해당 id의 Todo 항목 업데이트
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;UPDATE Todos SET title = ?, completed = ? where id = ?&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">updatedTodo</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="nx">updatedTodo</span><span class="p">.</span><span class="nx">completed</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>먼저, update를 위해서는 Cloudflare D1 DB에서 bind() 메서드를 이용해서 id에 해당되는 todo를 가져왔습니다.</p>
<p>만약 해당 id에 대한 todo 가 없으면 에러를 내면서 그냥 return 되고요.</p>
<p>만약 해당 id에 대한 todo 가 있으면 업데이트하게 됩니다.</p>
<p>SQlite3 Update 하는 Statement는 따로 공부하셔야 할 겁니다.</p>
<p>이제 체크박스를 눌러보면 아래와 같은 결과가 나올겁니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEj67bQmm_7EXP-0HlIL6cAN9OPIz0bk3EZueJZsBwCMwSa5fjy-Hvf7IR04odkH9dj3oyjoAk-jSUZPxH36t6mygl40EBGvsXvevzHbB-QwlF8QLq_KDWNnVrhUHwqySclmpJOdF-VJGhng5jHjhdiqihA7JHcRjzUEM6l2BhzKOCEJH3IxnBvSW0mKBUg"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>어떤가요?</p>
<p>Update 로직이 완성되었습니다.</p>
<p>Hono RPC를 이용한 벡엔드 코드 접근에 대해 조금은 이해하실수 있죠?</p>
<hr>
<h2 id="create-구현하기">Create 구현하기</h2>
<p>이제부터는 POST 메서드인데요.</p>
<p>POST 메서드가 가장 기본이 되는 메서드라서 여기서 부터는 긴장해야할 겁니다.</p>
<p>먼저, model 파일에서 아래와 같이 createTodo 함수를 먼저 만들겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// &#39;server/api/todos/model.ts&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">interface</span> <span class="nx">CreateTodoType</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">title</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">createTodo</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DB</span>: <span class="kt">D1Database</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">param</span>: <span class="kt">CreateTodoType</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">Todo</span><span class="p">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// D1 DB에 새로운 Todo 항목 삽입
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="s2">&#34;INSERT INTO Todos (title) VALUES (?)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">param</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(result);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   success: true,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   meta: {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     served_by: &#39;miniflare.db&#39;,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     duration: 0,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     changes: 1,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     last_row_id: 9,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     changed_db: true,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     size_after: 16384,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     rows_read: 1,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     rows_written: 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   },
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   results: []
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 삽입된 행의 ID 가져오기
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// const id = result.meta.last_row_id;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Failed to retrieve the ID of the inserted Todo.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 새로 삽입된 Todo 객체 생성
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">newTodo</span>: <span class="kt">Todo</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">id</span>: <span class="kt">result.meta.last_row_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">title</span>: <span class="kt">param.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">completed</span>: <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">newTodo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Failed to create todo in D1 DB&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Todo creation failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드를 보시면 먼저, CreateTodoType 타입을 interface로 작성했습니다.</p>
<p>그리고 createTodo 함수로 들어가 보면, D1 DB에 새로운 Todo 항목 삽입하는 SQL 명령을 실행했습니다.</p>
<p>이렇게 실행하면 result 값에 객체가 반환되는데요.</p>
<p>위 코드 주석에 보시면 그 객체 값의 예가 나옵니다.</p>
<p>여기서 중요하게 봐야할게 바로 INSERT 쿼리가 정상적으로 실행되면 방금 실행한 값의 id를 가져올 수 있는데요.</p>
<p>바로 &lsquo;result.meta.last_row_id&rsquo; 값입니다.</p>
<p>이게 왜 중요하냐면 보통 INSERT하고 나면 성공적으로 INSERT가 된 후의 값을 다시 사용해야할 때가 있는데요.</p>
<p>이렇때 아주 유용합니다.</p>
<p>그래서 실제로 위 코드에서는 새로 삽입된 Todo 객체 생성를 생성하는데요.</p>
<p>왜 Todo 객체를 생성할까요?</p>
<p>왜냐하면 SELECT 문으로 Todo 객체를 가져오면 한 번 더 SQL 쿼리를 실행해야하기 때문이죠.</p>
<p>우리가 새로운 Todo 객체를 UI로 돌려줘야하기 때문에 새로운 Todo 객체에 필요한거는 title, completed 값과 id입니다.</p>
<p>title, completed 값은 createTodo 함수를 만들 때 벌써 제공되어진거라 알고 있고, id값만 알면 되기 때문에 위와 같이 &lsquo;meta.last_row_id&rsquo; 값으로 해당 id값을 지정하면 우리가 궁극적으로 원하는 새로운 newTodo 값을 알 수 있는거죠.</p>
<p>그리고 마지막으로 해당 newTodo 객체를 리턴하면 UI에서 해당 newTodo를 화면에 뿌려주면 됩니다.</p>
<p>이렇게 하면 불필요한 SQL 실행이 한번으로 줄어들기 때문에 이 방식은 아주 중요합니다.</p>
<p>이제 UI쪽을 볼까요?</p>
<p>&rsquo;todos.tsx&rsquo; 파일에서 input을 위한 Form을 작성해야 합니다.</p>
<p>테스트를 위해 간단하게 UI를 짜겠습니다.</p>
<p>먼저, &lsquo;shadcn/ui&rsquo;의 input 컴포넌트와 아이콘을 위햇 &rsquo;lucide-react&rsquo; 패키지를 설치하겠습니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ npx shadcn@latest add input
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ npm i lucide-react</span></span></code></pre></div>
  </figure>
</div>
<p>그리고 Pending UI를 처음부터 구현해 볼껀데요.</p>
<p>그래서 input 폼을 위해 Remix가 제공하는 &lsquo;Form&rsquo; 컴포넌트를 사용할 겁니다.</p>
<p>실제 코드를 보시죠.</p>
<p>컴포넌트로 보시면 Todos 컴포넌트만 보시면 됩니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Todos</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">todos</span> <span class="o">=</span> <span class="nx">useLoaderData</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">loader</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">navigation</span> <span class="o">=</span> <span class="nx">useNavigation</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">isAdding</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="nx">navigation</span><span class="p">.</span><span class="nx">state</span> <span class="o">===</span> <span class="s2">&#34;submitting&#34;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">navigation</span><span class="p">.</span><span class="nx">formData</span><span class="o">?</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;_action&#34;</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&#34;create&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">formRef</span> <span class="o">=</span> <span class="nx">useRef</span><span class="p">&lt;</span><span class="nt">HTMLFormElement</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">inputRef</span> <span class="o">=</span> <span class="nx">useRef</span><span class="p">&lt;</span><span class="nt">HTMLInputElement</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isAdding</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">formRef</span><span class="p">.</span><span class="nx">current</span><span class="o">?</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nx">inputRef</span><span class="p">.</span><span class="nx">current</span><span class="o">?</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span> <span class="p">[</span><span class="nx">isAdding</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;min-h-screen bg-gray-50&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">header</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;bg-white text-gray-800 p-4 shadow-sm&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;container mx-auto&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/todos&#34;</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;text-2xl font-bold&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">My</span> <span class="nx">TODO</span> <span class="nx">App</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">main</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;container mx-auto py-8 px-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;w-full max-w-4xl mx-auto&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">          <span class="p">{</span><span class="cm">/* 새로 추가된 코드 */</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">Form</span> <span class="na">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">formRef</span><span class="p">}</span> <span class="na">replace</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;POST&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex items-center justify-between mb-6&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">              <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;text-2xl font-bold text-gray-700&#34;</span><span class="p">&gt;</span><span class="nx">TODO</span> <span class="err">리스트</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">              <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex space-x-3&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">Input</span>
</span></span><span class="line"><span class="cl">                  <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">name</span><span class="o">=</span><span class="s">&#34;title&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;title&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">required</span>
</span></span><span class="line"><span class="cl">                  <span class="na">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">inputRef</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">Button</span>
</span></span><span class="line"><span class="cl">                  <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">name</span><span class="o">=</span><span class="s">&#34;_action&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">value</span><span class="o">=</span><span class="s">&#34;create&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isAdding</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="na">className</span><span class="o">=</span><span class="s">&#34;bg-black text-white hover:bg-gray-800 transition-colors duration-200 rounded-xl px-4 py-2&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">&lt;</span><span class="nt">PlusCircle</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;mr-2 h-4 w-4&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span><span class="nx">isAdding</span> <span class="o">?</span> <span class="s2">&#34;추가 중&#34;</span> <span class="o">:</span> <span class="s2">&#34;TODO 추가하기&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">              <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">Form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;space-y-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">todos</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">              <span class="nx">todos</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">todo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">&lt;</span><span class="nt">TodoItem</span> <span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span> <span class="na">todo</span><span class="o">=</span><span class="p">{</span><span class="nx">todo</span><span class="p">}</span> <span class="p">/&gt;)}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">Todos</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 조금 어렵게 느껴질 수 있는데요.</p>
<p>Pending UI를 위해서 Remix는 useNavigation 훅을 지원해 줍니다.</p>
<p>이 훅은 Form의 상태를 실시간으로 체크해서 알 수 있게 해주는데요.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">navigation</span> <span class="o">=</span> <span class="nx">useNavigation</span><span class="p">();</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 useNavigation 훅을 navigation으로 지정하면 이제 navigation 객체에는 아래와 같이 Form 상태를 알 수 있게 해줍니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">isAdding</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="nx">navigation</span><span class="p">.</span><span class="nx">state</span> <span class="o">===</span> <span class="s2">&#34;submitting&#34;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">navigation</span><span class="p">.</span><span class="nx">formData</span><span class="o">?</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;_action&#34;</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&#34;create&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 isAdding 이라는 boolean 값을 만들어 놓으면 현재 UI가 새로운 Todo를 만들기 위해 버튼을 눌렀는지 알 수 있는겁니다.</p>
<p>그리고 해당 Pending UI는 버튼 컴포넌트에 적으면 됩니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">Button</span>
</span></span><span class="line"><span class="cl">  <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="na">name</span><span class="o">=</span><span class="s">&#34;_action&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="na">value</span><span class="o">=</span><span class="s">&#34;create&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isAdding</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="na">className</span><span class="o">=</span><span class="s">&#34;bg-black text-white hover:bg-gray-800 transition-colors duration-200 rounded-xl px-4 py-2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">PlusCircle</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;mr-2 h-4 w-4&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span><span class="nx">isAdding</span> <span class="o">?</span> <span class="s2">&#34;추가 중&#34;</span> <span class="o">:</span> <span class="s2">&#34;TODO 추가하기&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 Button 컴포넌트에 isAdding 값을 이용해서 Pending UI를 구형했습니다.</p>
<p>그리고 여기서 중요한게 Button 컴포넌트는 HTML의 input 태그인데요.</p>
<p>이 태그의 이름(name)을 &lsquo;_action&rsquo;이라고 하고 value 값을 &lsquo;create&rsquo;라고 했습니다.</p>
<p>이 방식을 Remix에서 사용하는 멀티 Form POST에 대응하는 가장 일반적인 방식인데요.</p>
<p>나중에 DELETE를 위해서도 Form을 POST할 때 POST 메서드가 &lsquo;create&rsquo;인지 &lsquo;delete&rsquo;인지 구분하기 위해서 입니다.</p>
<p>formRef, inputRef는 어디에 쓰는지 다들 아실겁니다.</p>
<p>Todo를 새로 만들고 Input 폼을 클리어하고 그리고 커서를 위치시키기 위한 코드입니다.</p>
<p>React의 가장 기본적인 UI라 설명은 생략하겠습니다.</p>
<hr>
<h2 id="remix의-action-함수-만들기">Remix의 action 함수 만들기</h2>
<p>Remix는 POST 메서드가 실행되면 꼭 action 함수를 만들어야 하는데요.</p>
<p>참고로 Remix는 GET, POST 메서드만 사용하라고 권장합니다.</p>
<p>왜냐하면 action 함수가 POST 메서드만 처리하기 때문이죠.</p>
<p>만약 DELETE 메서드나 PUT 메서드를 발생시켜보시면 에러메시지가 나올겁니다.</p>
<p>나중에 Todo 앱 지우기 부분에서 실제로 DELETE 메서드를 발생시켜 봅시다.</p>
<p>여기서는 일단은 POST 메서드를 이용해서 Form을 제출했기 때문에 Remix는 특성상 action 함수에서 처리해야 하는데요.</p>
<p>이 action 함수를 작성해 봅시다.</p>
<p>action 함수는 loader 함수 밑에 두시면 됩니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">loader</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">({</span> <span class="nx">context</span> <span class="p">}</span><span class="o">:</span> <span class="nx">LoaderFunctionArgs</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">clientGetTodos</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">action</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">({</span> <span class="nx">request</span> <span class="p">}</span><span class="o">:</span> <span class="nx">ActionFunctionArgs</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">_action</span><span class="p">,</span> <span class="p">...</span><span class="nx">values</span> <span class="p">}</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">fromEntries</span><span class="p">(</span><span class="nx">formData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// if (_action === &#34;delete&#34;) {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   await clientDeleteTodo(values);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">_action</span> <span class="o">===</span> <span class="s2">&#34;create&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">clientCreateTodo</span><span class="p">(</span><span class="nx">values</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 action 함수를 작성했습니다.</p>
<p>아까 &lsquo;_action&rsquo; 값을 지정한 이유가 위 코드에 있는데요.</p>
<p>&lsquo;_action&rsquo; 값이 &lsquo;create&rsquo;와 &lsquo;delete&rsquo;일 경우 실행할 함수를 구분시키기 위해서입니다.</p>
<p>일단은 &lsquo;delete&rsquo; 부분은 나중에 작성할 거기 때문에 위와 같이 주석처리해 놓읍시다.</p>
<p>이제 clientCreateTodo 함수를 작성해야 겠네요.</p>
<p>&lsquo;apiClient.ts&rsquo; 파일을 열어 아래 함수를 추가하겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">clientCreateTodo</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">values</span>: <span class="kt">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">$post</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">form</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">title</span>: <span class="kt">values.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 넣으면 VS Code가 $post 가 없다고 하는데요.</p>
<p>왜냐하면 Hono 서버쪽에 $post 메서드를 작성안했기 때문입니다.</p>
<p>이제 &lsquo;server/api/todo/index.ts&rsquo; 파일에 post 메서드를 아래와 같이 작성하겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Hono</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;hono&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createTodo</span><span class="p">,</span> <span class="nx">getTodos</span><span class="p">,</span> <span class="nx">TodoSchema</span><span class="p">,</span> <span class="nx">updateTodo</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;./model&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">zValidator</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@hono/zod-validator&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// RPC를 위해서는 new Hono&lt;&gt;().get 형식으로 붙혀서 만들어야 한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">api_todos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hono</span><span class="o">&lt;</span><span class="p">{</span> <span class="nx">Bindings</span>: <span class="kt">Env</span> <span class="p">}</span><span class="o">&gt;</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;/todos&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">todos</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getTodos</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s2">&#34;/todos/:id&#34;</span><span class="p">,</span> <span class="nx">zValidator</span><span class="p">(</span><span class="s2">&#34;json&#34;</span><span class="p">,</span> <span class="nx">TodoSchema</span><span class="p">),</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">validatedData</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">valid</span><span class="p">(</span><span class="s2">&#34;json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(validatedData);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">updateTodo</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">title</span>: <span class="kt">validatedData.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">completed</span>: <span class="kt">validatedData.completed</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">1</span> : <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="nx">ok</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&#34;/todos&#34;</span><span class="p">,</span> <span class="nx">zValidator</span><span class="p">(</span><span class="s2">&#34;form&#34;</span><span class="p">,</span> <span class="nx">TodoSchema</span><span class="p">),</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">validatedData</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">valid</span><span class="p">(</span><span class="s2">&#34;form&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(validatedData);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">await</span> <span class="nx">createTodo</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nx">validatedData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="nx">ok</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">api_todos</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>post 메서드를 put 메서드 다음에 추가시켰습니다.</p>
<p>post 메서드의 주소는 &lsquo;/todos&rsquo; 주소가 되고 HTTP 리퀘스트(Request)가 POST 일 경우 대응하는 코드가 되는겁니다.</p>
<p>여기서 UI쪽에서 form 방식으로 데이터를 POST했기 때문에 zValidator 함수의 첫번째 칸에 &lsquo;form&rsquo;이라고 적어야 합니다.</p>
<p>createTodo 함수는 예전에 만들었으니 이제 POST 메서드를 위한 Hono RPC가 끝났습니다.</p>
<p>이제 테스트 해볼까요?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgdE_49r6B5HRVY5zoLPiTtVRIfYBDpksFFRdhjiosQibpqKLUHyqNe8dJRq-0U42j862B2JFZ_tQjNVMnInVar7hwydp1_dqcntZb1NYNyFq2eHBP0leXyYj6A8iS0BWeNX3KEUqezX3_i5eBHpjdMZNFe-NQPUZKiIqOJXNAI9SnEMkfHo9Hsr_YMezQ"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhXwO0yPFN5ffa1EoOimt2zqEi70cStH5iPzetMFkOX-TMgl1Va8LygdQmcbOsOrfjvQm1Si_GPnAJgMd2EjKZ-0uvF6eEwaudwsApPflS4Qc8OumGOvYKguKPsxLlk1Tle9i1y2brh4mqFh6GLuo3w1x_3RenjchLoW3my8ZYSw3AR3JifX1eTAzit7lU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위와 같이 아주 잘 실행되고 있네요.</p>
<hr>
<h2 id="delete-구현하기">Delete 구현하기</h2>
<p>이제 마지막 단계인 Delete 구현입니다.</p>
<p>Pending UI를 위해서 React와 Remix의 훅을 추가해서 Delete 구현을 했으니 주의해서 살펴보시기 바랍니다.</p>
<p>역시나 먼저, model.ts 파일에 deleteTodo 함수를 먼저 만들겠습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">deleteTodo</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">DB</span>: <span class="kt">D1Database</span><span class="p">,</span> <span class="nx">id</span>: <span class="kt">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="s2">&#34;DELETE FROM Todos Where id = ?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(`Todo with id ${id} successfully deleted.`);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// console.log(result);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Failed to delete todo in D1 DB&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Todo deletion failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드를 보시면 이제는 쉽게 이해할 수 있을 겁니다.</p>
<p>Client쪽을 위한 apiClient.ts 파일에도 추가해 봅시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">clientDeleteTodo</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">values</span>: <span class="kt">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">todos</span><span class="p">[</span><span class="s2">&#34;:id&#34;</span><span class="p">].</span><span class="nx">$delete</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">param</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">id</span>: <span class="kt">values.id</span> <span class="kr">as</span> <span class="kt">string</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 입력하시면 역시나 $delete 쪽에 에러가 나오는데요.</p>
<p>Hono쪽에 $delete를 추가해야 합니다.</p>
<p>&lsquo;/server/api/todo/index.ts&rsquo; 파일에 아래와 같이 추가합시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Hono</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;hono&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">createTodo</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">deleteTodo</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">getTodos</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">TodoSchema</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">updateTodo</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;./model&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">zValidator</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@hono/zod-validator&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// RPC를 위해서는 new Hono&lt;&gt;().get 형식으로 붙혀서 만들어야 한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">api_todos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hono</span><span class="o">&lt;</span><span class="p">{</span> <span class="nx">Bindings</span>: <span class="kt">Env</span> <span class="p">}</span><span class="o">&gt;</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;/todos&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">todos</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getTodos</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">todos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s2">&#34;/todos/:id&#34;</span><span class="p">,</span> <span class="nx">zValidator</span><span class="p">(</span><span class="s2">&#34;json&#34;</span><span class="p">,</span> <span class="nx">TodoSchema</span><span class="p">),</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">validatedData</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">valid</span><span class="p">(</span><span class="s2">&#34;json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(validatedData);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">updateTodo</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">title</span>: <span class="kt">validatedData.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">completed</span>: <span class="kt">validatedData.completed</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">1</span> : <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="nx">ok</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&#34;/todos&#34;</span><span class="p">,</span> <span class="nx">zValidator</span><span class="p">(</span><span class="s2">&#34;form&#34;</span><span class="p">,</span> <span class="nx">TodoSchema</span><span class="p">),</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">validatedData</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">valid</span><span class="p">(</span><span class="s2">&#34;form&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(validatedData);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">await</span> <span class="nx">createTodo</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nx">validatedData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="nx">ok</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s2">&#34;/todos/:id&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">req</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">);</span> <span class="c1">// URL 경로에서 id 가져오기
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getTodo</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="s2">&#34;not found&#34;</span> <span class="p">},</span> <span class="mi">404</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// return c.redirect(&#34;/todos&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="nx">ok</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">api_todos</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>마지막에 delete 메서드를 추가했는데요.</p>
<p>여기서는 getTodo 함수를 필요로 하네요.</p>
<p>&lsquo;model.ts&rsquo; 파일에 Todo 한개를 가져오는 목적의 getTodo 함수를 아래와 같이 추가합시다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">getTodo</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DB</span>: <span class="kt">D1Database</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span>: <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">Todo</span> <span class="err">|</span> <span class="na">null</span><span class="p">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// SQL 쿼리로 특정 id에 해당하는 Todo 항목을 조회
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="s2">&#34;SELECT * FROM Todos WHERE id = ?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">first</span><span class="p">&lt;</span><span class="nt">Todo</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// console.log(todo);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 결과가 존재하면 해당 Todo 반환, 없으면 null 반환
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="nx">todo</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Failed to fetch todo with id </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> from D1 DB`</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>이제 Hono의 Delete 메서드도 끝났으니까 클라이언트쪽을 손봐야합니다.</p>
<p>TodoItem 컴포넌트에 Delete를 위한 폼을 추가해야합니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// Todo Card
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">TodoItem</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">todo</span> <span class="p">}</span><span class="o">:</span> <span class="p">{</span> <span class="nx">todo</span>: <span class="kt">Todo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">deleteFetcher</span> <span class="o">=</span> <span class="nx">useFetcher</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">isCompleted</span><span class="p">,</span> <span class="nx">setIsCompleted</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">isDeleting</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="nx">deleteFetcher</span><span class="p">.</span><span class="nx">state</span> <span class="o">===</span> <span class="s2">&#34;submitting&#34;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">deleteFetcher</span><span class="p">.</span><span class="nx">formData</span><span class="o">?</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span> <span class="o">===</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">handleCheckboxChange</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">checked</span>: <span class="kt">boolean</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">todos</span><span class="p">[</span><span class="s2">&#34;:id&#34;</span><span class="p">].</span><span class="nx">$put</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">json</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span>: <span class="kt">todo.title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">completed</span>: <span class="kt">isCompleted</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nx">param</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span>: <span class="kt">todo.id.toString</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">setIsCompleted</span><span class="p">(</span><span class="nx">isCompleted</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">1</span> : <span class="kt">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">Card</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;mb-4 hover:shadow-md transition-shadow duration-200&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">CardContent</span>
</span></span><span class="line"><span class="cl">        <span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`</span><span class="si">${</span><span class="nx">isDeleting</span> <span class="o">?</span> <span class="s2">&#34;bg-gray-300&#34;</span> <span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="si">}</span><span class="sb"> flex items-center p-4`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">Checkbox</span>
</span></span><span class="line"><span class="cl">          <span class="na">id</span><span class="o">=</span><span class="p">{</span><span class="sb">`todo-</span><span class="si">${</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">isCompleted</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">onCheckedChange</span><span class="o">=</span><span class="p">{</span><span class="nx">handleCheckboxChange</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">className</span><span class="o">=</span><span class="s">&#34;mr-4&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;flex-grow&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">label</span>
</span></span><span class="line"><span class="cl">            <span class="na">htmlFor</span><span class="o">=</span><span class="p">{</span><span class="sb">`todo-</span><span class="si">${</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`</span><span class="si">${</span>
</span></span><span class="line"><span class="cl">              <span class="nx">isDeleting</span> <span class="o">?</span> <span class="s2">&#34;opacity-50&#34;</span> <span class="o">:</span> <span class="s2">&#34;opacity-100&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="si">}</span><span class="sb"> text-lg font-medium leading-none </span><span class="si">${</span>
</span></span><span class="line"><span class="cl">              <span class="nx">isCompleted</span> <span class="o">?</span> <span class="s2">&#34;line-through text-gray-400&#34;</span> <span class="o">:</span> <span class="s2">&#34;text-gray-700&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">deleteFetcher.Form</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;hidden&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;id&#34;</span> <span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">Button</span>
</span></span><span class="line"><span class="cl">              <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">name</span><span class="o">=</span><span class="s">&#34;_action&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">value</span><span class="o">=</span><span class="s">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isDeleting</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">              <span class="p">{</span><span class="nx">isDeleting</span> <span class="o">?</span> <span class="s2">&#34;지우는 중&#34;</span> <span class="o">:</span> <span class="s2">&#34;지우기&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">deleteFetcher.Form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">CardContent</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">Card</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>UI를 보시면 여기서는 Form을 useFetcher 훅으로 사용했습니다.</p>
<p>Remix 고급 사용법인데요.</p>
<p>아까 create 쪽에서는 &lsquo;Form&rsquo;을 사용했습니다.</p>
<p>그 때 사용한 useNavigation 훅과 겹치기 때문에 useFetcher로 따로 &lsquo;Form&rsquo;을 만들기 위한 Remix의 고급 기법이죠.</p>
<p>그런데 잘 보시면 deleteFetcher.Form의 method가 &ldquo;post&quot;입니다.</p>
<p>왜냐하면 action 함수는 post 메서드만 지원하기 때문입니다.</p>
<p>실제로 action 함수로 가시면 아래와 같이 아까 create 할 때 주석처리한 부분을 주석을 지워주십시요.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">action</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">({</span> <span class="nx">request</span> <span class="p">}</span><span class="o">:</span> <span class="nx">ActionFunctionArgs</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">_action</span><span class="p">,</span> <span class="p">...</span><span class="nx">values</span> <span class="p">}</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">fromEntries</span><span class="p">(</span><span class="nx">formData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">_action</span> <span class="o">===</span> <span class="s2">&#34;delete&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">clientDeleteTodo</span><span class="p">(</span><span class="nx">values</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">_action</span> <span class="o">===</span> <span class="s2">&#34;create&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="nx">clientCreateTodo</span><span class="p">(</span><span class="nx">values</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 action 함수에서 clientDeleteTodo 함수를 호출하라고 합니다.</p>
<p>그러면 clientDeleteTodo 함수를 볼까요?</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">clientDeleteTodo</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">values</span>: <span class="kt">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">todos</span><span class="p">[</span><span class="s2">&#34;:id&#34;</span><span class="p">].</span><span class="nx">$delete</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">param</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">id</span>: <span class="kt">values.id</span> <span class="kr">as</span> <span class="kt">string</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
  </figure>
</div>
<p>빙고, 여기서 Hono의 $delete 즉, DELETE 메서드로 호출되고 있습니다.</p>
<p>그러고 보니 아까 completed 항목을 업데이트할 때도 apiClient 함수쪽에서 $put으로 호출했었네요.</p>
<p>Remix를 이용할 때는 PUT 메서드와 DELETE 메서드는 이런 식으로 사용해야 합니다.</p>
<p>마지막으로 useFetcher의 Form을 이용할 때의 Pending UI는 아래와 같이 하시면 쉽습니다.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">isDeleting</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="nx">deleteFetcher</span><span class="p">.</span><span class="nx">state</span> <span class="o">===</span> <span class="s2">&#34;submitting&#34;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">deleteFetcher</span><span class="p">.</span><span class="nx">formData</span><span class="o">?</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span> <span class="o">===</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span></span></span></code></pre></div>
  </figure>
</div>
<p>위 코드는 폼이 submitting 될때 그리고 두번째는 해당 delete 되는 아이템만 적용시키기 위해 해당 delete 되는 아이템의 todo.id 값까지 체크하게 했습니다.</p>
<p>만약 delete 되는 해당 id값을 체크하지 않으면 모든 아이템에 Pending UI가 적용될 겁니다.</p>
<p>주의하시면 됩니다.</p>
<p>이제 테스트를 진행해 볼까요?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhsZCPt3clq6WndAdGc_x8ogVwcU_X8OaugwnJl9UJpmDjq6l99QAyVvJlMy327-sx_A5-jSp14WvofY_0B8I5mFcptXNgswg8zCIRX7O4wKtvbFQWacIJagnhi73DwvzwPhooRm3msOTzJa0skLmRgsiX78ETnBo7Qj2FRundf_dw1YjiVgvxzwQa4en4"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위 그림과 같이 Pending UI도 잘 적용되고 Delete도 잘 되고 있습니다.</p>
<hr>
<h2 id="cloudflare에-배포하기">Cloudflare에 배포하기</h2>
<p>이제 모든게 끝났으니까 빌드후 배포해야겠네요.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ npm run deploy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; deploy
</span></span><span class="line"><span class="cl">&gt; npm run build <span class="o">&amp;&amp;</span> wrangler pages deploy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; build
</span></span><span class="line"><span class="cl">&gt; remix vite:build
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">vite v5.4.8 building <span class="k">for</span> production...
</span></span><span class="line"><span class="cl">✓ <span class="m">1654</span> modules transformed.
</span></span><span class="line"><span class="cl">build/client/.vite/manifest.json                1.41 kB │ gzip:  0.34 kB
</span></span><span class="line"><span class="cl">build/client/assets/root-Cuu5eBUk.css          14.21 kB │ gzip:  3.61 kB
</span></span><span class="line"><span class="cl">build/client/assets/_index-MW916cbg.js          1.15 kB │ gzip:  0.55 kB
</span></span><span class="line"><span class="cl">build/client/assets/root-7GOmtebN.js            1.73 kB │ gzip:  0.98 kB
</span></span><span class="line"><span class="cl">build/client/assets/entry.client-C1Vo4Cp-.js    3.74 kB │ gzip:  1.43 kB
</span></span><span class="line"><span class="cl">build/client/assets/jsx-runtime-56DGgGmo.js     8.11 kB │ gzip:  3.05 kB
</span></span><span class="line"><span class="cl">build/client/assets/todos-LRAenMuD.js          42.29 kB │ gzip: 14.90 kB
</span></span><span class="line"><span class="cl">build/client/assets/components-CD3wXADJ.js    246.75 kB │ gzip: 79.72 kB
</span></span><span class="line"><span class="cl">✓ built in 1.77s
</span></span><span class="line"><span class="cl">vite v5.4.8 building SSR bundle <span class="k">for</span> production...
</span></span><span class="line"><span class="cl">✓ <span class="m">13</span> modules transformed.
</span></span><span class="line"><span class="cl">build/server/.vite/manifest.json                0.22 kB
</span></span><span class="line"><span class="cl">build/server/assets/server-build-Cuu5eBUk.css  14.21 kB
</span></span><span class="line"><span class="cl">build/server/index.js                          16.87 kB
</span></span><span class="line"><span class="cl">✓ built in 57ms
</span></span><span class="line"><span class="cl">▲ <span class="o">[</span>WARNING<span class="o">]</span> Warning: Your working directory is a git repo and has uncommitted changes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  To silence this warning, pass in --commit-dirty<span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">✨ Compiled Worker successfully
</span></span><span class="line"><span class="cl">🌍  Uploading... <span class="o">(</span>11/11<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">✨ Success! Uploaded <span class="m">8</span> files <span class="o">(</span><span class="m">3</span> already uploaded<span class="o">)</span> <span class="o">(</span>2.18 sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">✨ Uploading _headers
</span></span><span class="line"><span class="cl">✨ Uploading Functions bundle
</span></span><span class="line"><span class="cl">✨ Uploading _routes.json
</span></span><span class="line"><span class="cl">🌎 Deploying...
</span></span><span class="line"><span class="cl">✨ Deployment complete! Take a peek over at https://a651d0cf.hono-remix-test-5jr.pages.dev</span></span></code></pre></div>
  </figure>
</div>
<p>위와 같이 deploy 명령어를 실행시키면 알아서 빌드후 Cloudflare에 배포합니다.</p>
<p>여기서 &lsquo;.env&rsquo; 파일에 API Endpoint를 위한 주소를 넣어야 하는데요.</p>
<p>위 터미널 상에서 나오는 주소는 맨 앞에 더미문자열 포함한 주소인데요.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">https://a651d0cf.hono-remix-test-5jr.pages.dev</span></span></code></pre></div>
  </figure>
</div>
<p>더미문자열만 지우고 나면 실제 주소가 됩니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">https://hono-remix-test-5jr.pages.dev</span></span></code></pre></div>
  </figure>
</div>
<p>이제 이 주소를 &lsquo;.env&rsquo;에 넣으시고 다시 deploy하시면 됩니다.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nv">VITE_API_URL</span><span class="o">=</span>https://hono-remix-test-5jr.pages.dev/</span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ npm run deploy</span></span></code></pre></div>
  </figure>
</div>
<p>이제 Cloudflare 대시보드로 가 볼까요?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhtOuicy05Vsf91AMJFMNO6LBkjWudomSO9n_MZmvnpUENIa4rg1GgHR56q6Pcd3TS5yRoKSzQebwEH2j-BaHWdfgBExx3tVSKViTKrX6uHXlrxi3MZy1LtCL3chnkCIm7p9D5UxUeJCDnAGt4WRnI5siLaETt57WoHmANurSUotQiCgpWtQ5BAzGQLnhU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>잘 배포되었네요.</p>
<p>이제 해당 주소로 가보면 아래와 같이 나올겁니다.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhzffYxpio5MnCy1Y2_9rfj1bA3LAbmAFKUthwyE1BEnz2RmpfUE9ZvXY4r-7S1XKZhYV3rIzisROerKuTefEWhg4G_86g4ga1IS7ibrnS9xrppuV-tv97stcmzlDPdtEnQCiL1Z1I2tmV9M7-OByJw-u0_4sP1guLLaKYTvsswSAxmCxkh8Y0lFYxTypE"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>우리가 처음에 Todos 테이블 만들 때 더미값으로 넣은 항목만 나오고 있네요.</p>
<p>정상적으로 작동하는지 여러번 테스트해 보세요.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgUfNljBuibXCqamN4MAiRZ_x7jmn4t_dTPN2h1XsXSpwCnNIUITmTFlrVaM1exeiaAid4WWtcDLZTK-1Kw-klGgKQSCPBvxC7RHaoJQa0uy_f6WsQqswaKAyWj1yriktvTF0_fWhDfnU1ft68ukcyoSg_Wq00uDgk7abYIyfwpkAELMuOPvCBEOdGmJ-s"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjq1kpZ8XaJXuhk2f55DMV4aChuVCnlGIUQR5hVAK9z552yI1MK3apC9uLE7TJoUB9qA9LMzfnaCDxRIbPL9kUdEeXV0EEXyt9pEcWXQGDY1yNsz1GpYVGsBMf1J_25CbMyXe0oDeIMpixxOJIX2b1ZYp3XtoXEL7p5H15nIHAksKDgVqZm8uzb2bvnTgU"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>위 두개의 그림으로 보시다시피 create, delete 모두 Pending UI까지 완벽하게 작동하고 있습니다.</p>
<p>이제 다 끝났네요.</p>
<p>어떤까요?</p>
<p>Remix와 Hono의 조합!</p>
<p>저는 개인적으로 Cloudflare Pages를 좋아하는데요.</p>
<p>무료에 D1 DB, KV까지 사용할 수 있고 Worker까지 만들 수 있어 아주 좋습니다.</p>
<p>이제 Remix와 Hono를 이용해서 FullStack 앱만 만들면 되겠네요.</p>
<p>그럼.</p>

      <div class="tag-list-single">
        <a class="btn btn-light" href="/tags/remix/" role="button">remix</a>
        <a class="btn btn-light" href="/tags/hono/" role="button">hono</a>
        <a class="btn btn-light" href="/tags/rpc/" role="button">rpc</a>
        <a class="btn btn-light" href="/tags/cloudflare/" role="button">cloudflare</a>
        <a class="btn btn-light" href="/tags/api-endpoint/" role="button">api endpoint</a>
        <a class="btn btn-light" href="/tags/todo-app/" role="button">todo app</a>
        </div>
      
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-format="autorelaxed"
          data-ad-client="ca-pub-7748316956330968"
          data-ad-slot="4495825428"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </div>
</article>

      
      </div>
    </div>
    
    
<div class="bg-light">
    <section class="section section-related container">
      <div class="row justify-content-center">
        <div class="col-md-12 col-lg-12">
          <h2 class="section-title text-center">Related posts</h2>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-lg-12">
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2024-10-14-cloudflare-remix-framework-hono-rpc-api-endpoint/">Cloudflare에서 Remix Framework과 Hono의 RPC 기능을 활용한 API Endpoint 구축하기</a></h2>
                  <p>이 글에서는 Cloudflare 환경에서 Remix Framework과 Hono의 RPC 기능을 활용하여 API Endpoint를 구축하는 방법을 단계별로 설명합니다. 효율적인 API 통신을 위한 실용적인 팁과 함께 배포 과정을 안내합니다.</p>
                  <p>
  <small>October 14, 2024<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>16&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2024-02-25-fullstack-tutorial-remix-cloudflare-with-kv-and-github-server/">풀스택 강의 6편. Remix로 Github 저장소를 DB로 이용해서 KV와 함께 Cloudflare에 배포하기</a></h2>
                  <p>풀스택 강의입니다. Remix + Cloudflare + Github + KV</p>
                  <p>
  <small>February 25, 2024<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>8&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2025-04-20-comprehensive-honojs-tutorial/">Hono.js 튜토리얼 - 간단한 REST API 만들기</a></h2>
                  <p>이 글에서는 Hono.js를 사용하여 간단한 REST API를 만드는 방법을 배웁니다. Hono.js는 경량화된 웹 프레임워크로, 높은 성능과 간결한 문법을 제공합니다.</p>
                  <p>
  <small>April 20, 2025<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>3&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          </div>
      </div>
    </section>
    <script src="https://utteranc.es/client.js"
      repo="cpro95/utterances_mycodings_fly_dev"
      issue-term="pathname"
      theme="github-light"
      label="blog-comment"
      crossorigin="anonymous"
    async>
    </script>
  </div>
  
    <footer class="footer text-muted">
  <div class="container-lg">
    <div class="row">
      <div class="col-lg-8 text-center text-lg-start">
        <ul class="list-inline">
          <li class="list-inline-item"><a class="text-muted" href="/about/">about</a></li>
        </ul>
      </div>
      <div class="col-lg-8 text-center text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item">Copyright (c) All Right Reserved.</li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    

<script async
  src="/js/app.19b73e0182301dd61c9211c2f6890104740e2eb9eb12fe4ba8d4f31435b22ed6.js"
  integrity="sha256-Gbc&#43;AYIwHdYckhHC9okBBHQOLrnrEv5LqNTzFDWyLtY=">
</script>





<script async
  src="/js/flexsearch.5dd6433c29c3e043627f046054aed58ff3790f58fdb8423f45125bbafdcad335.js"
  integrity="sha256-XdZDPCnD4ENifwRgVK7Vj/N5D1j9uEI/RRJbuv3K0zU=">
</script>
<script async
  src="/js/search-modal.96e662d8f691fe25c859a3437074b485f2d7bed0bca612725028c6cf4322e2f2.js"
  integrity="sha256-luZi2PaR/iXIWaNDcHS0hfLXvtC8phJyUCjGz0Mi4vI=">
</script>

    <div class="d-inline-flex fixed-bottom-right pb-4 pe-4">
  <button id="toTop" type="button" class="btn btn-primary rounded-circle ms-auto p-2"><span class="visually-hidden">Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M6 15l6 -6l6 6"></path></svg></button>
</div>

    
  </body>
</html>
