<!doctype html>
<html lang="ko" data-bs-theme="auto">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://mycodingshub.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<script 
  src="/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js"
  integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg=">
</script>


<link rel="stylesheet" href="/main.86b7305f5a96b7dd3a46fa6277d87b125af3bf13f48c4cfcc269be84fa9e8fb75375d45a5fe9056ce9190644b7a6e5f13f917f12d853ed38bb76d8856898f755.css" integrity="sha512-hrcwX1qWt906Rvpid9h7ElrzvxP0jEz8wmm+hPqej7dTddRaX+kFbOkZBkS3puXxP5F/EthT7Ti7dtiFaJj3VQ==" crossorigin="anonymous">

<noscript><style>img.lazyload { display: none; }</style></noscript><title>astrojs ê°•ì¢Œ 10í¸. astrojsì—ì„œ ì¿ í‚¤ì™€ í† í°ì„ ì´ìš©í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„</title>
<meta name="description" content="ìœ ì € ì •ë³´ë¥¼ jsonwebtokenìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì¿ í‚¤ì— ì €ì¥í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„" />
<link rel="canonical" href="https://mycodingshub.github.io/blog/2024-01-02-astrojs-auth-user-login-by-cookie-with-jwt-token/" />
<meta name="robots" content="index, follow" />

<meta property="og:type" content="article" />
<meta property="og:title" content="astrojs ê°•ì¢Œ 10í¸. astrojsì—ì„œ ì¿ í‚¤ì™€ í† í°ì„ ì´ìš©í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„" />
<meta property="og:description" content="ìœ ì € ì •ë³´ë¥¼ jsonwebtokenìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì¿ í‚¤ì— ì €ì¥í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„" />
<meta property="og:url" content="https://mycodingshub.github.io/blog/2024-01-02-astrojs-auth-user-login-by-cookie-with-jwt-token/" />
<meta property="og:site_name" content="Home" />
<meta property="og:image" content="https://mycodingshub.github.io/cover.png" />
<meta property="og:locale" content="en" />
<meta property="article:published_time" content="2024-01-02T11:53:41Z" />
<meta property="article:modified_time" content="2024-01-02T11:53:41Z" />
<meta property="article:tag" content="astrojs" />
<meta property="article:tag" content="auth" />
<meta property="article:tag" content="cookie" />
<meta property="article:tag" content="jwt" />
<meta property="article:tag" content="token" />
<meta property="article:tag" content="jsonwebtoken" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="astrojs ê°•ì¢Œ 10í¸. astrojsì—ì„œ ì¿ í‚¤ì™€ í† í°ì„ ì´ìš©í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„" />
<meta name="twitter:description" content="ìœ ì € ì •ë³´ë¥¼ jsonwebtokenìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì¿ í‚¤ì— ì €ì¥í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„" />
<meta name="twitter:image" content="https://mycodingshub.github.io/cover.png" />

<meta name="author" content="cpro95@gmail.com" />

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "\"astrojs ê°•ì¢Œ 10í¸. astrojsì—ì„œ ì¿ í‚¤ì™€ í† í°ì„ ì´ìš©í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„\"",
  "description": "\"ìœ ì € ì •ë³´ë¥¼ jsonwebtokenìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì¿ í‚¤ì— ì €ì¥í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„\"",
  "datePublished": "\"2024-01-02T11:53:41Z\"",
  "dateModified": "\"2024-01-02T11:53:41Z\"",
  "author": {
    "@type": "Person",
    "name": "\"cpro95@gmail.com\""
  },
  "image": "\"https://mycodingshub.github.io/cover.png\"",
  "url": "\"https://mycodingshub.github.io/blog/2024-01-02-astrojs-auth-user-login-by-cookie-with-jwt-token/\"",
  "publisher": {
    "@type": "Organization",
    "name": "\"Home\""
  }
}
</script>




<script async src="https://www.googletagmanager.com/gtag/js?id=G-C7SBETWEJ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C7SBETWEJ0');
</script>


<script
  async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7748316956330968"
  crossOrigin="anonymous"
></script>


</head>

  
  <body class="single section blog" data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0">
    <div class="sticky-top">
<header class="navbar navbar-expand-sm">
  <div class="container-lg">
  <div class="d-flex flex-grow-1 justify-content-between">
    <div class="d-flex flex-row navbar-nav justify-content-between align-items-start gap-2">
    
    <a class="nav-link fw-bold fs-4" href="/">Home</a>

    
    
            <a class="nav-link fs-4  active" href="https://mycodingshub.github.io/blog/" aria-current="true">Blog</a>
          
        
            <a class="nav-link fs-4 " href="https://mycodingshub.github.io/life/">Life</a>
          
        
    </div>
    <div class="d-flex flex-row justify-content-between align-items-center">
      
      
      <button type="button" id="searchToggleMobile" class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="21" y1="21" x2="15" y2="15"></line>
        </svg>
      </button>
      
      
      <button type="button" id="searchToggleDesktop" class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="21" y1="21" x2="15" y2="15"></line>
        </svg>
      </button>
      
      <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type="button" aria-label="Toggle theme">
        <svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
        </svg>
        <svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0m-5 0h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
        </svg>
      </button>
      </div>
        
        
        
        
        </div>
    </div>

    
    </div>
</header>
</div>

<div class="modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1>
        <button type="button" class="btn-close visually-hidden" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="search-input flex-grow-1 d-none">
          <form id="search-form" class="search-form" action="#" method="post" accept-charset="UTF-8" role="search">
            <label for="query" class="visually-hidden">Search</label>
            <div class="d-flex">
              <input type="search" id="query" name="query" class="search-text form-control form-control-lg" placeholder="Search" aria-label="Search" maxlength="128" autocomplete="off">
              <button type="button" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-body">
        <p class="search-loading status message d-none mt-3 text-center">Loading search indexâ€¦</p>
        <p class="search-no-recent message d-none mt-3 text-center">No recent searches</p>
        <p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p>
        <div id="searchResults" class="search-results"></div>
        <template>
          <article class="search-result list-view">
            <div class="card my-3">
              <div class="card-body">
                <header>
                  <h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2>
                  <div class="submitted d-none"><time class="created-date">Date here</time></div>
                </header>
                <div class="content">Summary here</div>
              </div>
            </div>
          </article>
        </template>
      </div>
      <div class="modal-footer">
        <ul class="list-inline me-auto d-none d-md-block">
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li>
        </ul>
        <p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p>
      </div>
    </div>
  </div>
</div>


    <div class="wrap container-lg" role="document">
      <div class="content">
      
        
<article>
  <div class="row justify-content-center">
    <div class="col-md-12 col-lg-12">
      
      <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-7748316956330968"
        data-ad-slot="2971373181"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      <div class="blog-header">
        <h1>astrojs ê°•ì¢Œ 10í¸. astrojsì—ì„œ ì¿ í‚¤ì™€ í† í°ì„ ì´ìš©í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„</h1>
        <p>
  <small>January 2, 2024<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>26&nbsp;minutes</span></small>
</p>

      </div>
    </div>
      <div class="col-md-12 col-lg-12">
      
      <p>ì•ˆë…•í•˜ì„¸ìš”?</p>
<p>ì˜¤ëœë§Œì— astrojs ê°•ì¢Œë¥¼ ì´ì–´ê°€ë„¤ìš”.</p>
<p>ì˜¤ëŠ˜ë¡œ ë²Œì„œ astrojs ê°•ì¢Œê°€ 10ë²ˆì§¸ë„¤ìš”.</p>
<p>ì „ì²´ astrojs ê°•ì¢Œ ëª©ë¡ì…ë‹ˆë‹¤.</p>
<ol>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-10-07-astrojs-tutorial-how-to-handle-data-in-astrojs">astrojs ê°•ì¢Œ 1í¸. astrojsì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-10-14-astrojs-tutorial-clean-build-of-darkmode-theme">astrojs ê°•ì¢Œ 2í¸. React ì“°ì§€ ì•Šê³  ìˆœìˆ˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ Dark Mode ë§Œë“œëŠ” ë²•</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-10-14-understanding-astosjs-island-architecture-from-making-my-own-island-web-component">astrojs ê°•ì¢Œ 3í¸. ì›¹ ì»´í¬ë„ŒíŠ¸ë¡œ ì§ì ‘ ì•„ì¼ëœë“œ ì•„í‚¤í…ì²˜ êµ¬í˜„í•´ ë³´ê¸°</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-10-21-astrojs-in-depth-review-component-island-architecture">astrojs ê°•ì¢Œ 4í¸. astrojs ì•„ì¼ëœë“œ ì•„í‚¤í…ì²˜ ì™„ë²½ ë¶„ì„</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-10-29-astrojs-all-about-routing-and-dynamic-routing">astrojs ê°•ì¢Œ 5í¸. astrojs ë¼ìš°íŒ… ì™„ë²½ ë¶„ì„(routing, dynamic routing)</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-10-29-astrojs-howto-use-content-collection-and-dynamic-routing">astrojs ê°•ì¢Œ 6í¸. astrojs Content Collectionê³¼ ë‹¤ì´ë‚´ë¯¹ ë¼ìš°íŒ… ì ‘ëª©í•˜ê¸°</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-10-30-astrojs-howto-use-ssr-in-astrojs-server-side-rendering">astrojs ê°•ì¢Œ 7í¸. astrojs Server Side Rendering(SSR) ì™„ë²½ ë¶„ì„</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-11-08-astrojs-how-to-ssr-with-firebase-user-session">astrojs ê°•ì¢Œ 8í¸. astrojsì™€ firebaseë¡œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2023-11-09-astrojs-howto-supabase-authentication-with-ssr">astrojs ê°•ì¢Œ 9í¸. astrojsì™€ supabaseë¡œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2024-01-02-astrojs-auth-user-login-by-cookie-with-jwt-token">astrojs ê°•ì¢Œ 10í¸. astrojsì—ì„œ ì¿ í‚¤ì™€ í† í°ì„ ì´ìš©í•´ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„</a></p>
</li>
<li>
<p><a href="https://mycodingshub.github.io/blog/2024-01-16-astrojs-tutorial-auth-with-lucia">astrojs ê°•ì¢Œ 11í¸. astrojsì™€ luciaë¥¼ ì´ìš©í•´ì„œ ìœ ì € ì¸ì¦ êµ¬í˜„</a></p>
</li>
</ol>
<hr>
<p>** ëª© ì°¨ **</p>
<ul>
<li><a href="#1-astro-%ed%85%9c%ed%94%8c%eb%a6%bf-%ec%84%a4%ec%b9%98">1. Astro í…œí”Œë¦¿ ì„¤ì¹˜</a></li>
<li><a href="#2-%ec%bf%a0%ed%82%a4-%ec%84%a4%ec%a0%95">2. ì¿ í‚¤ ì„¤ì •</a></li>
<li><a href="#3-middleware-%ec%84%a4%ec%a0%95">3. middleware ì„¤ì •</a></li>
<li><a href="#4-prisma-%ec%84%a4%ec%a0%95">4. Prisma ì„¤ì •</a>
<ul>
<li><a href="#4-1-prisma-%ec%84%a4%ec%b9%98">4-1. Prisma ì„¤ì¹˜</a></li>
</ul>
</li>
<li><a href="#4-2-model-%ec%84%a4%ec%a0%95">4-2. Model ì„¤ì •</a>
<ul>
<li><a href="#4-3-%ed%85%8c%ec%9d%b4%eb%b8%94-%eb%a7%8c%eb%93%a4%ea%b8%b0">4-3. í…Œì´ë¸” ë§Œë“¤ê¸°</a></li>
<li><a href="#4-4-prisma-studio%ec%97%90%ec%84%9c-%eb%b3%b4%ea%b8%b0">4-4. Prisma Studioì—ì„œ ë³´ê¸°</a></li>
</ul>
</li>
<li><a href="#5-ui-%eb%a7%8c%eb%93%a4%ea%b8%b0">5. UI ë§Œë“¤ê¸°</a>
<ul>
<li><a href="#5-1-%eb%a0%88%ec%9d%b4%ec%95%84%ec%9b%83-%ed%8c%8c%ec%9d%bc-%eb%a7%8c%eb%93%a4%ea%b8%b0">5-1. ë ˆì´ì•„ì›ƒ íŒŒì¼ ë§Œë“¤ê¸°</a></li>
</ul>
</li>
<li><a href="#5-2-%eb%a3%a8%ed%8a%b8-%ed%8e%98%ec%9d%b4%ec%a7%80%ec%99%80-%eb%8c%80%ec%8b%9c%eb%b3%b4%eb%93%9c-%ed%8e%98%ec%9d%b4%ec%a7%80-%eb%a7%8c%eb%93%a4%ea%b8%b0">5-2. ë£¨íŠ¸ í˜ì´ì§€ì™€ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ë§Œë“¤ê¸°</a></li>
<li><a href="#6-%ec%9d%b8%ec%a6%9d-%ea%b4%80%eb%a0%a8-%ec%bd%94%eb%93%9c-%ec%84%a4%ec%a0%95">6. ì¸ì¦ ê´€ë ¨ ì½”ë“œ ì„¤ì •</a>
<ul>
<li><a href="#6-1-prisma-client-%ec%84%a4%ec%a0%95">6-1. Prisma Client ì„¤ì •</a></li>
<li><a href="#6-2-hash-%ea%b4%80%eb%a0%a8-bcryptjs-%ec%84%a4%ec%b9%98">6-2. hash ê´€ë ¨ bcryptjs ì„¤ì¹˜</a></li>
</ul>
</li>
<li><a href="#7-%ea%b0%80%ec%9e%85%ed%95%98%ea%b8%b0-%ed%99%94%eb%a9%b4-%eb%a7%8c%eb%93%a4%ea%b8%b0">7. ê°€ì…í•˜ê¸° í™”ë©´ ë§Œë“¤ê¸°</a></li>
<li><a href="#8-formdata%ec%9d%98-%ec%9c%a0%ed%9a%a8%ec%84%b1-%ea%b2%80%ec%82%ac">8. formDataì˜ ìœ íš¨ì„± ê²€ì‚¬</a></li>
<li><a href="#9-%ec%9c%a0%ec%a0%80-%ec%a0%95%eb%b3%b4%eb%a5%bc-db%ec%97%90-%ec%a0%80%ec%9e%a5%ed%95%98%ea%b8%b0">9. ìœ ì € ì •ë³´ë¥¼ DBì— ì €ì¥í•˜ê¸°</a></li>
<li><a href="#10-%eb%8f%99%ec%9d%bc-%ec%9d%b4%eb%a9%94%ec%9d%bc-%ec%97%90%eb%9f%ac-%ec%b2%98%eb%a6%ac%ed%95%98%ea%b8%b0">10. ë™ì¼ ì´ë©”ì¼ ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°</a></li>
<li><a href="#11-%ed%86%a0%ed%81%b0-%eb%a7%8c%eb%93%a4%ea%b8%b0">11. í† í° ë§Œë“¤ê¸°</a></li>
<li><a href="#12-%ec%bf%a0%ed%82%a4-%eb%a7%8c%eb%93%a4%ea%b8%b0">12. ì¿ í‚¤ ë§Œë“¤ê¸°</a></li>
<li><a href="#13-%eb%a1%9c%ea%b7%b8%ec%9d%b8-%ed%8e%98%ec%9d%b4%ec%a7%80-%eb%a7%8c%eb%93%a4%ea%b8%b0">13. ë¡œê·¸ì¸ í˜ì´ì§€ ë§Œë“¤ê¸°</a></li>
<li><a href="#14-%eb%af%b8%eb%93%a4%ec%9b%a8%ec%96%b4%eb%a1%9c-%ed%8e%98%ec%9d%b4%ec%a7%80%eb%b3%84-%ec%95%a1%ec%84%b8%ec%8a%a4-%ec%a0%9c%ed%95%9c%ed%95%98%ea%b8%b0">14. ë¯¸ë“¤ì›¨ì–´ë¡œ í˜ì´ì§€ë³„ ì•¡ì„¸ìŠ¤ ì œí•œí•˜ê¸°</a></li>
<li><a href="#15-%eb%a1%9c%ea%b7%b8%ec%95%84%ec%9b%83-%ea%b5%ac%ed%98%84">15. ë¡œê·¸ì•„ì›ƒ êµ¬í˜„</a></li>
<li><a href="#16-%eb%a1%9c%ea%b7%b8%ec%9d%b8-%ea%b0%80%ec%9e%85%ed%95%98%ea%b8%b0-%ed%8e%98%ec%9d%b4%ec%a7%80%ec%97%90-%eb%a6%ac%eb%8b%a4%ec%9d%b4%eb%a0%89%ed%8a%b8-%ec%bd%94%eb%93%9c-%ec%82%bd%ec%9e%85">16. ë¡œê·¸ì¸, ê°€ì…í•˜ê¸° í˜ì´ì§€ì— ë¦¬ë‹¤ì´ë ‰íŠ¸ ì½”ë“œ ì‚½ì…</a></li>
<li><a href="#17-%eb%b9%8c%eb%93%9c%eb%a5%bc-%ec%9c%84%ed%95%9c-%ec%96%b4%eb%8c%91%ed%84%b0-%ec%84%a4%ec%b9%98">17. ë¹Œë“œë¥¼ ìœ„í•œ ì–´ëŒ‘í„° ì„¤ì¹˜</a></li>
</ul>
<hr>
<h2 id="1-astro-í…œí”Œë¦¿-ì„¤ì¹˜">1. Astro í…œí”Œë¦¿ ì„¤ì¹˜</h2>
<p>ì¼ë‹¨ Astroë¥¼ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>ì˜µì…˜ìœ¼ë¡œëŠ” Typescriptë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npm create astro@latest
</span></span><span class="line"><span class="cl">Need to install the following packages:
</span></span><span class="line"><span class="cl">  create-astro@4.6.0
</span></span><span class="line"><span class="cl">Ok to proceed? <span class="o">(</span>y<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> astro   Launch sequence initiated.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   dir   Where should we create your new project?
</span></span><span class="line"><span class="cl">         ./astro-prisma-auth-with-token
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  tmpl   How would you like to start your new project?
</span></span><span class="line"><span class="cl">         Empty
</span></span><span class="line"><span class="cl"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  Template copying...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  deps   Install dependencies?
</span></span><span class="line"><span class="cl">         Yes
</span></span><span class="line"><span class="cl"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  Installing dependencies with npm...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ts   Do you plan to write TypeScript?
</span></span><span class="line"><span class="cl">         Yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   use   How strict should TypeScript be?
</span></span><span class="line"><span class="cl">         Strict
</span></span><span class="line"><span class="cl"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  TypeScript customizing...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   git   Initialize a new git repository?
</span></span><span class="line"><span class="cl">         Yes
</span></span><span class="line"><span class="cl"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  Git initializing...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  next   Liftoff confirmed. Explore your project!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         Enter your project directory using <span class="nb">cd</span> ./astro-prisma-auth-with-token
</span></span><span class="line"><span class="cl">         Run npm run dev to start the dev server. CTRL+C to stop.
</span></span><span class="line"><span class="cl">         Add frameworks like react or tailwind using astro add.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         Stuck? Join us at https://astro.build/chat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â•­â”€â”€ğŸâ”€â•®  Houston:
</span></span><span class="line"><span class="cl">â”‚ â—  â—¡ â—   Good luck out there, astronaut! ğŸš€
</span></span><span class="line"><span class="cl">â•°â”€â”€â”€â”€â”€â•¯</span></span></code></pre></div>
  </figure>
</div>
<p>í´ë”ë¡œ ë“¤ì–´ê°€ &rsquo;npm run dev&rsquo;ë¥¼ ì‹¤í–‰í•´ ë³´ë©´ ë¸Œë¼ìš°ì €ì— Astro ë¬¸êµ¬ê°€ ì˜ ë‚˜ì˜¬ ê²ë‹ˆë‹¤.</p>
<hr>
<h2 id="2-ì¿ í‚¤-ì„¤ì •">2. ì¿ í‚¤ ì„¤ì •</h2>
<p>ì¿ í‚¤ ê´€ë ¨ Astro ë¬¸ë²•ì€ ì˜ˆì „ ê°•ì¢Œ 7í¸ì— ì†Œê°œí–ˆë˜ ì ì´ ìˆìŠµë‹ˆë‹¤.</p>
<p><a href="https://mycodingshub.github.io/blog/2023-10-30-astrojs-howto-use-ssr-in-astrojs-server-side-rendering">astrojs ê°•ì¢Œ 7í¸. astrojs Server Side Rendering(SSR) ì™„ë²½ ë¶„ì„</a></p>
<p>ì˜ˆì „ ë¬¸ì„œë¥¼ ë³´ì‹œë©´ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì— ëŒ€í•´ ì˜ ì•Œ ìˆ˜ ìˆëŠ”ë°ìš”.</p>
<p>ë³µìŠµ ì°¨ì›ì—ì„œ ì¿ í‚¤ ì‘ë™ ë°©ë²•ì„ ê°„ë‹¨íˆ í…ŒìŠ¤íŠ¸í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ë¨¼ì €, src í´ë”ì˜ index.astro íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ê³ ì¹œ ë‹¤ìŒ í…ŒìŠ¤íŠ¸í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">cookie</span> <span class="o">=</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">cookie</span><span class="p">)</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">.</span><span class="nx">number</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">,</span> <span class="nb">String</span><span class="p">(</span><span class="nx">counter</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Counter</span> <span class="o">=</span> <span class="p">{</span><span class="nx">counter</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/html&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ê°œë°œ ì„œë²„ë¥¼ ë‹¤ì‹œ ëŒë ¤ë³¼ê¹Œìš”?</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">18:02:22 <span class="o">[</span>WARN<span class="o">]</span> <span class="sb">`</span>Astro.request.headers<span class="sb">`</span> is not available in <span class="s2">&#34;static&#34;</span> output mode. To <span class="nb">enable</span> header access: <span class="nb">set</span> <span class="sb">`</span>output: <span class="s2">&#34;server&#34;</span><span class="sb">`</span> or <span class="sb">`</span>output: <span class="s2">&#34;hybrid&#34;</span><span class="sb">`</span> in your config file.</span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ ë‚˜ì˜µë‹ˆë‹¤.</p>
<p>ì™œëƒí•˜ë©´ &lsquo;Astro.request.headers&rsquo;ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ê³  í•©ë‹ˆë‹¤.</p>
<p>Astro ì˜µì…˜ êµ¬ì„±ì—ì„œ output ëª¨ë“œë¥¼ &lsquo;server&rsquo;ë‚˜ &lsquo;hybrid&rsquo;ë¡œ ë°”ê¾¸ë¼ê³  í•©ë‹ˆë‹¤.</p>
<p>ì™œëƒí•˜ë©´ ê¸°ë³¸ ëª¨ë“œëŠ” ì •ì  ì‚¬ì´íŠ¸(static)ì´ê¸° ë•Œë¬¸ì— ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì´ ì•ˆ ë©ë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ &lsquo;astro.config.mjs&rsquo; íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ &lsquo;server&rsquo;ë¼ê³  output ëª¨ë“œë¥¼ ë°”ê¾¸ë©´ ë©ë‹ˆë‹¤.</p>
<blockquote>
<p>AstroëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì •ì  ëª¨ë“œë¡œ ì‘ë™í•˜ë¯€ë¡œ ë¹Œë“œ ì‹œ í˜ì´ì§€ê°€ ìƒì„±ë©ë‹ˆë‹¤. astro.config.mjsì—ì„œ outputì˜ ê°’ì„ server ë˜ëŠ” hybridë¡œ í•˜ë©´ SSR(Server Side Rendering)ë¡œì„œ ë™ì‘í•  ìˆ˜ ìˆì–´ ì•¡ì„¸ìŠ¤ê°€ ìˆì„ ë•Œ í˜ì´ì§€ê°€ ì‘ì„±ë©ë‹ˆë‹¤.</p></blockquote>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">defineConfig</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;astro/config&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// https://astro.build/config
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">defineConfig</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">output</span><span class="o">:</span> <span class="s1">&#39;server&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ë‹¤ì‹œ ê°œë°œ ì„œë²„ë¥¼ ëŒë ¤ë³¼ê¹Œìš”?</p>
<p>ì²˜ìŒì—ëŠ” ì•„ë˜ì²˜ëŸ¼ Counter ê°€ 1ë¡œ ë‚˜ì˜¤ë‹¤ê°€ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•˜ë©´ ìƒˆë¡œê³ ì¹¨í•œ ë§Œí¼ ìˆ«ìê°€ ì˜¬ë¼ê°‘ë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEilz5VBOew5rp74V_vav3-xXZlN6XF5apyPmNvB7kgHyB6rIv6_L-irpxLggo3xQ_-HjX4CXwMHkJo_9A8o5FvBTQV2tixeNkBHhfo2FEtqbQKYowbgS3jJmJxGCmXJVCWitlP_5J5sF9OmpZeYiNP4yIdieN1OX4UUKzz4sAhdOO5mMTHt6v-43kXGcZY"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgFfRasOic6jSjJLvkTPsAg2inN0r9YJXdlJ-jip_FpLRhQAj7D8bI3mcgKJ_pV-ZMjb_JHmso2eNyHciIIGL-5St-Tm90-w93KuCUtgAhbj57l0Up6l9DXgpL8ISV-U3RMtWfNq2DV1tXJHm-f5x8c3TDBvimMkvm6U9KvYGqS8W24zlimqc9bFlpKbII"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>í¬ë¡¬ ê°œë°œì°½ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ìª½ìœ¼ë¡œ ê°€ë³´ë©´ ì¿ í‚¤ë¼ëŠ” í•­ëª©ì„ ì—´ì–´ë³´ë©´ ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ counter ì¿ í‚¤ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEil2KRs2SYz4eDLHpxR4wd73rgAWZ5eqC7CS_szKfUHHc1gsrL_uFM--JVllOeCdSa9_JIAw3Ez2PFCfTbeM0f_-8PJQ2jin6QA6OJCvvmEQ8remwNQxniVOw9BjKyOv0CEcMFGCg5lSLhDTxNpF_Klu7H6U4sIDam_EysyrosFFN_Ec0CjZq_i-CAIxkk"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>counterë¼ëŠ” ì¿ í‚¤ì˜ ì†ì„±ì„ ë³´ì‹œë©´ ì¤‘ìš”í•œ ê²Œ ëª‡ ê°€ì§€ê°€ ìˆëŠ”ë°ìš”.</p>
<p>ì²« ë²ˆì§¸, HttpOnlyê°€ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ ë¶€ë¶„ì´ ë¹„ì–´ ìˆë„¤ìš”.</p>
<p>ì´ HttpOnlyê°€ ë¹„ì–´ ìˆìœ¼ë©´ ì¿ í‚¤ë¥¼ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ìª½ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<p>Astroë¥¼ ì„œë²„ ì‚¬ì´ë“œ ëª¨ë“œë¡œ ëŒë ¸ì„ ë•Œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ìª½ ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” &lsquo;script&rsquo;ë¥¼ ì“°ë©´ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ë°ìš”.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">cookie</span> <span class="o">=</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">cookie</span><span class="p">)</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">.</span><span class="nx">number</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">,</span><span class="nb">String</span><span class="p">(</span><span class="nx">counter</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Counter</span> <span class="o">=</span> <span class="p">{</span><span class="nx">counter</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/html&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/script&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ ì„¤ì •í•˜ê³  ë‹¤ì‹œ í¬ë¡¬ ê°œë°œì°½ì˜ ì½˜ì†”ì°½ ë¶€ë¶„ì„ ë³´ì‹œë©´ ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ counter ë¼ëŠ” ì¿ í‚¤ê°’ì„ ì¶œë ¥í•´ ì£¼ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEifh_txzsJfLuySugGe42Rg60evPBEIRugUycpWq0CBFU5ks16osoyqkcLOIUvXG0CSjfyBBLi5ZAFAqXrPgdlR5-qhTY7h7YUtGfts0c-1LE-qxLCnmNq2FpcYGiFhhkgPf4RiZ7g7bzSbm0svZwgsEfiWHipQo9z3_Ec_Wb3eujN7FcoBNKlQdftA39M"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìš°ë¦¬ê°€ ë§Œë“¤ë ¤ê³  í•˜ëŠ” ê±´ ìœ ì €ë„¤ì„ê³¼ íŒ¨ìŠ¤ì›Œë“œ ë°©ì‹ì˜ Auth ì„œë²„ì´ê¸° ë•Œë¬¸ì— ê·¸ë¦¬ê³  Auth ë°©ì‹ì´ ì¿ í‚¤ë¥¼ ì´ìš©í•œ ë°©ì‹ì´ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ì¿ í‚¤ì— ì ‘ê·¼í•˜ë©´ ë³´ì•ˆì˜ ìœ„í—˜ì´ ì¡´ì¬í•©ë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ ì¿ í‚¤ ì„¤ì •í•  ë•Œ HttpOnlyë¥¼ &rsquo;true&rsquo; ì„¤ì •í•´ì„œ ì˜¤ì§ ì„œë²„ì‚¬ì´ë“œì—ì„œë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ë‘ ë²ˆì§¸ ì¤‘ìš”í•œ ì¿ í‚¤ ì˜µì…˜ì€ secure ì˜µì…˜ì…ë‹ˆë‹¤.</p>
<p>HTTP í†µì‹ ì˜ ê²½ìš°ì—ëŠ” íŒ¨í‚· ìŠ¤ë‹ˆí•‘ìœ¼ë¡œ í† í°ì´ ìœ ì¶œë  ìˆ˜ ìˆì–´ ì˜¤ì§ HTTPS í†µì‹ ì—ë§Œ ì¿ í‚¤ê°€ ì „ì†¡ë˜ë„ë¡ secure ì†ì„±ì„ &rsquo;true&rsquo;ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="nb">String</span><span class="p">(</span><span class="nx">counter</span><span class="p">),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">secure</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<blockquote>
<p>Chromeì—ì„œëŠ” ê°œë°œ í™˜ê²½ì˜ localhostì˜ ê²½ìš° http í†µì‹ ì—ì„œë„ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>
<p>ì„¸ ë²ˆì§¸ ì¤‘ìš”í•œ ì˜µì…˜ì€ &lsquo;Expires/Max-Age&rsquo;ì¸ë°ìš”.</p>
<p>ì¿ í‚¤ì˜ ë§Œë£Œì¼ì„ ì§€ì •í•˜ëŠ” ê²ë‹ˆë‹¤.</p>
<p>ê¸°ë³¸ ì˜µì…˜ì€ &lsquo;Session&rsquo;ì´ë¼ê³  í•˜ëŠ” ê±´ë°ìš”.</p>
<p>ì´ ì˜µì…˜ì€ ë¸Œë¼ìš°ì €ê°€ ì‚´ì•„ ìˆì„ ë•Œê¹Œì§€ì…ë‹ˆë‹¤.</p>
<p>ë¸Œë¼ìš°ì €ë¥¼ ë‹«ìœ¼ë©´ ì¢…ë£Œë©ë‹ˆë‹¤.</p>
<p>ì´ ë°©ì‹ë„ ê´œì°®ì€ ë°©ì‹ì¸ë°ìš”.</p>
<p>ìš”ì¦˜ì€ ë¡œê·¸ì¸í•˜ëŠ” ê²Œ ê·€ì°®ì•„ì„œ ë§Œë£Œì¼ì„ 7ì¼ ì •ë„ë¡œ ì„¸íŒ…í•˜ëŠ”ê²Œ ì¶”ì„¸ì…ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">maxAge</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="nb">String</span><span class="p">(</span><span class="nx">counter</span><span class="p">),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">secure</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">maxAge</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ë§ˆì§€ë§‰ì— maxAgeë¼ê³ ë§Œ ì ì—ˆëŠ”ë° ES6ì˜ ì¶•ì•½ í‘œê¸°ë²•ìœ¼ë¡œ ì‹¤ì œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">maxAge</span><span class="o">:</span> <span class="nx">maxAge</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìµœì¢… ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">cookie</span> <span class="o">=</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">cookie</span><span class="p">)</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">.</span><span class="nx">number</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">maxAge</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&#34;counter&#34;</span><span class="p">,</span> <span class="nb">String</span><span class="p">(</span><span class="nx">counter</span><span class="p">),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">secure</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">maxAge</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Counter</span> <span class="o">=</span> <span class="p">{</span><span class="nx">counter</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/html&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ì§€ì •í•œ ì˜µì…˜ ì„¸ ê°€ì§€ê°€ ëª¨ë‘ ì ìš©ë˜ì—ˆë„¤ìš”.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjkEoY3QYsBmqDKG10y3379QhOVz3NcHyDtqcq3VMTdt7lsINLBVoYbOCtgPJZyh_iuwXQMH2ZYhv4EFCGbTlxJwlyeqSVqg_Vpi4yZaNrqOM13OT_R22gmHk1wpIhjQAA-gU1M9utFxexkkCwZ9oyGmme6P1raeIPyrI0n_7AL35fVvotj_AMaWNpDbHI=w320-h36"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<hr>
<h2 id="3-middleware-ì„¤ì •">3. middleware ì„¤ì •</h2>
<p>ì¿ í‚¤ ê²€ì¦ ì½”ë“œëŠ” ëª¨ë“  HTTP í†µì‹ ì— ìˆì–´ ì‚¬ì „ì— ì²´í¬í•´ì•¼ ë˜ê¸° ë•Œë¬¸ì— ë¯¸ë“¤ì›¨ì–´ì—ì„œë„ ì ‘ê·¼ ê°€ëŠ¥í•´ì•¼ í•˜ëŠ”ë°ìš”.</p>
<p>Astroì—ì„œëŠ” middlewareëŠ” src í´ë” ì•„ë˜ middleware.ts íŒŒì¼ì„ ì‘ì„±í•˜ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">defineMiddleware</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;astro/middleware&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">onRequest</span> <span class="o">=</span> <span class="nx">defineMiddleware</span><span class="p">((</span><span class="nx">context</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="nx">context</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">next</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ë¯¸ë“¤ì›¨ì–´ë¥¼ ì„¤ì •í–ˆìœ¼ë©´, ê°œë°œ ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> astro  v4.0.8 ready in <span class="m">161</span> ms
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â”ƒ Local    http://localhost:4321/
</span></span><span class="line"><span class="cl">â”ƒ Network  use --host to expose
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">18:22:16 watching <span class="k">for</span> file changes...
</span></span><span class="line"><span class="cl">counter AstroCookie <span class="o">{</span> value: <span class="s1">&#39;6&#39;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">18:22:21 <span class="o">[</span>200<span class="o">]</span> / 81ms
</span></span><span class="line"><span class="cl">counter AstroCookie <span class="o">{</span> value: <span class="s1">&#39;7&#39;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">18:22:24 <span class="o">[</span>200<span class="o">]</span> / 8ms</span></span></code></pre></div>
  </figure>
</div>
<p>í„°ë¯¸ë„ ì°½ì— counterë¼ëŠ” ì¿ í‚¤ ê´€ë ¨ ê°’ì´ ì œëŒ€ë¡œ í‘œì‹œê°€ ë©ë‹ˆë‹¤.</p>
<hr>
<h2 id="4-prisma-ì„¤ì •">4. Prisma ì„¤ì •</h2>
<p>ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ DBë¥¼ ì´ìš©í•´ì•¼ í•˜ëŠ”ë°ìš”.</p>
<p>Typescript ORMìœ¼ë¡œ ì•„ì£¼ ìœ ëª…í•œ Prismaë¥¼ ì´ìš©í•˜ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h3 id="4-1-prisma-ì„¤ì¹˜">4-1. Prisma ì„¤ì¹˜</h3>
<p>ë¨¼ì €, ê´€ë ¨ Prisma íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npm install prisma -D</span></span></code></pre></div>
  </figure>
</div>
<p>Prisma êµ¬ì„± íŒŒì¼ì„ ì„¸íŒ…í•˜ë ¤ë©´ &lsquo;init&rsquo; ëª…ë ¹ì–´ë¥¼ ì£¼ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npx prisma init --datasource-provider sqlite
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">âœ” Your Prisma schema was created at prisma/schema.prisma
</span></span><span class="line"><span class="cl">  You can now open it in your favorite editor.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">warn You already have a .gitignore file. Don<span class="err">&#39;</span>t forget to add <span class="sb">`</span>.env<span class="sb">`</span> in it to not commit any private information.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Next steps:
</span></span><span class="line"><span class="cl">1. Set the DATABASE_URL in the .env file to point to your existing database. If your database has no tables yet, <span class="nb">read</span> https://pris.ly/d/getting-started
</span></span><span class="line"><span class="cl">2. Run prisma db pull to turn your database schema into a Prisma schema.
</span></span><span class="line"><span class="cl">3. Run prisma generate to generate the Prisma Client. You can <span class="k">then</span> start querying your database.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">More information in our documentation:
</span></span><span class="line"><span class="cl">https://pris.ly/d/getting-started</span></span></code></pre></div>
  </figure>
</div>
<p>ë¡œì»¬ ê°œë°œì„œë²„ë¥¼ ìœ„í•´ sqliteë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤.</p>
<p>ìë™ìœ¼ë¡œ &lsquo;.env&rsquo; íŒŒì¼ë„ ë§Œë“¤ì–´ ì¤¬ë„¤ìš”.</p>
<p>ê·¸ë¦¬ê³  ìŠ¤í‚¤ë§ˆ íŒŒì¼ì¸ &lsquo;schema.prisma&rsquo; íŒŒì¼ë„ prisma í´ë” ë°‘ì— ë§Œë“¤ì–´ ì¤¬ìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ ëª¨ë¸ì„ ì„¤ì •í•´ì•¼ í•˜ëŠ”ë°ìš”.</p>
<hr>
<h2 id="4-2-model-ì„¤ì •">4-2. Model ì„¤ì •</h2>
<p>PrismaëŠ” ëª¨ë¸ì´ë¼ëŠ” ê±¸ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.</p>
<p>&lsquo;schema.prisma&rsquo; íŒŒì¼ì— Modelì„ ì¶”ê°€í•©ì‹œë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// This is your Prisma schema file,
</span></span></span><span class="line"><span class="cl"><span class="c1">// learn more about it in the docs: https://pris.ly/d/prisma-schema
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">generator</span> <span class="nx">client</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">provider</span> <span class="o">=</span> <span class="s2">&#34;prisma-client-js&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">datasource</span> <span class="nx">db</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">provider</span> <span class="o">=</span> <span class="s2">&#34;sqlite&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span>      <span class="o">=</span> <span class="nx">env</span><span class="p">(</span><span class="s2">&#34;DATABASE_URL&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span>        <span class="nx">Int</span>      <span class="err">@</span><span class="nx">id</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span>     <span class="nb">String</span>   <span class="err">@</span><span class="nx">unique</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>      <span class="nb">String</span><span class="o">?</span>
</span></span><span class="line"><span class="cl">  <span class="nx">password</span>  <span class="nb">String</span>
</span></span><span class="line"><span class="cl">  <span class="nx">createdAt</span> <span class="nx">DateTime</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">now</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">  <span class="nx">updatedAt</span> <span class="nx">DateTime</span> <span class="err">@</span><span class="nx">updatedAt</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>User ëª¨ë¸ì¸ë°ìš”.</p>
<p>ê°„ë‹¨í•˜ê²Œ emailê³¼ name, passwordë§Œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.</p>
<p>ë¡œê·¸ì¸ì„ emailê³¼ passwordë¡œë§Œ ì´ë£¨ì–´ì§€ê²Œ í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p>
<p>ë‹¹ì—°íˆ, emailì€ unique í•´ì•¼ê² ì£ .</p>
<hr>
<h3 id="4-3-í…Œì´ë¸”-ë§Œë“¤ê¸°">4-3. í…Œì´ë¸” ë§Œë“¤ê¸°</h3>
<p>Prismaë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ì„ ë§Œë“¤ì—ˆìœ¼ë©´ ì‹¤ì œ sqliteì— ë“¤ì–´ê°ˆ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ê°„ë‹¨íˆ &lsquo;db push&rsquo; ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npx prisma db push
</span></span><span class="line"><span class="cl">Environment variables loaded from .env
</span></span><span class="line"><span class="cl">Prisma schema loaded from prisma/schema.prisma
</span></span><span class="line"><span class="cl">Datasource <span class="s2">&#34;db&#34;</span>: SQLite database <span class="s2">&#34;dev.db&#34;</span> at <span class="s2">&#34;file:./dev.db&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQLite database dev.db created at file:./dev.db
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ğŸš€  Your database is now in sync with your Prisma schema. Done in 15ms
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Running generate... <span class="o">(</span>Use --skip-generate to skip the generators<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">added <span class="m">1</span> package, and audited <span class="m">474</span> packages in 7s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">179</span> packages are looking <span class="k">for</span> funding
</span></span><span class="line"><span class="cl">  run <span class="sb">`</span>npm fund<span class="sb">`</span> <span class="k">for</span> details
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">found <span class="m">0</span> vulnerabilities
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">âœ” Generated Prisma Client <span class="o">(</span>v5.7.1<span class="o">)</span> to ./node_modules/@prisma/client in 159ms</span></span></code></pre></div>
  </figure>
</div>
<p>&lsquo;dev.db&rsquo;ë¼ëŠ” sqlite íŒŒì¼ì— í…Œì´ë¸”ì„ ë§Œë“¤ì—ˆê³ , Prisma Clientë„ ë§Œë“¤ì–´ ì¤¬ë„¤ìš”.</p>
<hr>
<h3 id="4-4-prisma-studioì—ì„œ-ë³´ê¸°">4-4. Prisma Studioì—ì„œ ë³´ê¸°</h3>
<p>PrismaëŠ” Prisma Studioë¼ëŠ” ì›¹ UIë¥¼ ì œê³µí•´ ì£¼ëŠ”ë°ìš”.</p>
<p>ì´ê²Œ ì•„ì£¼ í¸í•©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npx prisma studio</span></span></code></pre></div>
  </figure>
</div>
<p>ì‹¤í–‰í•˜ë©´ ê°œë°œì„œë²„ 5555ë²ˆìœ¼ë¡œ ë¸Œë¼ìš°ì €ê°€ ì—´ë¦¬ë©´ì„œ ì•„ë˜ì™€ ê°™ì´ ë³´ì—¬ì£¼ëŠ”ë°ìš”.</p>
<p>ìš°ë¦¬ê°€ ë§Œë“  User ëª¨ë¸ì„ í´ë¦­í•´ì„œ í…Œì´ë¸” ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjWiykL8S1bxlODXdlO7TSZ6n-Jdb5z4C7WPgYCLmnRlTRH3WHFCrz8gvi0uFS03bGcP1SkHXyTjDvOmR8pqHy3DhkQJj4qB6C_A3boXEFwVjs-uU8mhn8QwMKx7lkhtypAs1mVQ9fKnU0aQIY_PXvWn9puybN5GOn4Wdl6njAaoNbAH16xwvbwdb_qBKI"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhj4fdThECoqhIV8fJAqxlRegsBXX6PDEwLamuqsT-YqbTKRXVvOPDmV52ZKmiWqw66DI4iGSlA_fHbSf81bzcPuO4HYUrz9aT420hdLhv8IJfMylQrEHshju_j6DCcos7AA_2CVH6WLZWtd2rRrfExxPgJyJoBRjOkhxFtulJvq-DHmATKHxup-d2PP7I"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<hr>
<h2 id="5-ui-ë§Œë“¤ê¸°">5. UI ë§Œë“¤ê¸°</h2>
<p>ì´ì œ ë¡œê·¸ì¸, ê°€ì…í•˜ê¸°, ëŒ€ì‹œë³´ë“œ ë“± Auth ê´€ë ¨ í˜ì´ì§€ë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ëŠ” ë¡œê·¸ì¸í–ˆì„ ë•Œë§Œ ë³¼ ìˆ˜ ìˆê³ ,</p>
<p>&lsquo;/&rsquo; ë£¨íŠ¸ í˜ì´ì§€ëŠ” ë¡œê·¸ì¸ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•˜ë©°,</p>
<p>ë¡œê·¸ì¸, ê°€ì…í•˜ê¸° í˜ì´ì§€ëŠ” ë¡œê·¸ì¸ë˜ì§€ ì•Šì•˜ì„ ë•Œë§Œ ë³¼ ìˆ˜ ìˆì–´ì•¼ê² ì£ .</p>
<hr>
<h3 id="5-1-ë ˆì´ì•„ì›ƒ-íŒŒì¼-ë§Œë“¤ê¸°">5-1. ë ˆì´ì•„ì›ƒ íŒŒì¼ ë§Œë“¤ê¸°</h3>
<p>Astroë¥¼ ì‚¬ìš©í•˜ë©´ ë ˆì´ì•„ì›ƒ íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼ í¸í•©ë‹ˆë‹¤.</p>
<p>src í´ë”ì— layouts í´ë”ë¥¼ ë§Œë“¤ê³  ê·¸ ë°‘ì— Layout.astroë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// /src/layouts/Layout.astro
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">ViewTransitions</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;astro:transitions&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">html</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">&#34;en&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">charset</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;viewport&#34;</span> <span class="nx">content</span><span class="o">=</span><span class="s2">&#34;width=device-width, initial-scale=1&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="nx">Astro</span><span class="o">&lt;</span><span class="err">/title&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">ViewTransitions</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/head&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">nav</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/&#34;</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/a&gt;&lt;/li&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/dashboard&#34;</span><span class="o">&gt;</span><span class="nx">Dashboard</span><span class="o">&lt;</span><span class="err">/a&gt;&lt;/li&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/signup&#34;</span><span class="o">&gt;</span><span class="nx">Signup</span><span class="o">&lt;</span><span class="err">/a&gt;&lt;/li&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/a&gt;&lt;/li&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="err">/ul&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/nav&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">slot</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/body&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/html&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ul</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gap</span><span class="o">:</span> <span class="mi">14</span><span class="nx">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">list</span><span class="o">-</span><span class="nx">style</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/style&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<h2 id="5-2-ë£¨íŠ¸-í˜ì´ì§€ì™€-ëŒ€ì‹œë³´ë“œ-í˜ì´ì§€-ë§Œë“¤ê¸°">5-2. ë£¨íŠ¸ í˜ì´ì§€ì™€ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ë§Œë“¤ê¸°</h2>
<p>src í´ë”ì˜ index.astroëŠ” ì•„ë˜ì™€ ê°™ì´ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Home</span> <span class="nx">Page</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ê·¸ë¦¬ê³  src í´ë” ë°‘ì— ìˆëŠ” pages í´ë” ë°‘ì— dashboard í´ë”ë¥¼ ë§Œë“¤ê³  ê·¸ ë°‘ì— index.astro íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Dashboard</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì´ì œê¹Œì§€ì˜ ì„¤ì •ì´ë¼ë©´ ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ë‚˜ì˜¬ ê²ë‹ˆë‹¤.</p>
<p>ë§í¬ê°€ ì•„ì£¼ ì˜ ì‘ë™í•˜ë„¤ìš”.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEiHtbObSY4Ds6gYJqAfNEnxTa4ko9eOOQiDWGo6Q8Wx4kWzWFWDehraDfd8EKEDjfYJiK0RupXLJR_VRWMjcD8QVxsVUloRGL26z9uRXyYVJ9tTCtwATdmWJ1rOhWL1rWxNaNB__kAcLfKtCD_wIB0PI1hDvwn7xGO7n4G02zeatzGge6iaJxExpR-PkNs"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<hr>
<h2 id="6-ì¸ì¦-ê´€ë ¨-ì½”ë“œ-ì„¤ì •">6. ì¸ì¦ ê´€ë ¨ ì½”ë“œ ì„¤ì •</h2>
<p>ì´ì œ ì „ì²´ì ì¸ í˜ì´ì§€ì˜ êµ¬ì¡°ê°€ ê°–ì¶°ì¡Œìœ¼ë‹ˆ ì¸ì¦ ê´€ë ¨ ì½”ë“œë¥¼ ì„¤ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h3 id="6-1-prisma-client-ì„¤ì •">6-1. Prisma Client ì„¤ì •</h3>
<p>ë³´í†µ src í´ë” ë°‘ì— prisma.ts íŒŒì¼ì— Prisma Clientë¥¼ export í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// /src/lib/prisma.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">PrismaClient</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@prisma/client&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">prisma</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PrismaClient</span><span class="p">()</span></span></span></code></pre></div>
  </figure>
</div>
<hr>
<h3 id="6-2-hash-ê´€ë ¨-bcryptjs-ì„¤ì¹˜">6-2. hash ê´€ë ¨ bcryptjs ì„¤ì¹˜</h3>
<p>íŒ¨ìŠ¤ì›Œë“œë¥¼ í•´ì‹œí•´ì„œ ì €ì¥í•´ì•¼ í•˜ë¯€ë¡œ bcryptjs íŒ¨í‚¤ì§€ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  í† í° í˜•ì‹ìœ¼ë¡œ ì¿ í‚¤ì— ì €ì¥í•´ì•¼ í•˜ë¯€ë¡œ ê°€ì¥ ìœ ëª…í•œ jsonwebtoken íŒ¨í‚¤ì§€ë„ ê°™ì´ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  zodë¥¼ ì´ìš©í•´ì„œ íƒ€ì… ìœ íš¨ì„±ì„ ê²€ì‚¬í•´ì•¼ í•˜ë¯€ë¡œ zodë„ ê°™ì´ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npm install bcryptjs jsonwebtoken zod
</span></span><span class="line"><span class="cl">npm install @types/bcryptjs @types/jsonwebtoken -D</span></span></code></pre></div>
  </figure>
</div>
<hr>
<h2 id="7-ê°€ì…í•˜ê¸°-í™”ë©´-ë§Œë“¤ê¸°">7. ê°€ì…í•˜ê¸° í™”ë©´ ë§Œë“¤ê¸°</h2>
<p>ìœ ì €ë¥¼ ìƒì„±í•˜ëŠ” ê°€ì…í•˜ê¸° í™”ë©´ì„ ë§Œë“¤ì–´ì•¼ í•˜ëŠ”ë°ìš”.</p>
<p>ì´ íŒŒì¼ì€ ë°”ë¡œ ë¼ìš°íŒ…ì´ ë˜ê¸° ë•Œë¬¸ì— src í´ë” ë°‘ì— ìˆëŠ” pages í´ë”ì— &lsquo;signup.astro&rsquo;ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.</p>
<p>ì•„ë˜ ë§í¬ì˜ Astro ê³µì‹ ë¬¸ì„œì— ê°€ë©´ signup í¼ì„ ì•„ì£¼ ì˜ ì„¤ëª…í•´ ì¤€ ê²Œ ìˆìŠµë‹ˆë‹¤.</p>
<p><a href="https://docs.astro.build/en/recipes/build-forms/">Build HTML forms in Astro pages</a></p>
<p>ìœ„ ë§í¬ë¥¼ í•œë²ˆ ì½ì–´ ë³´ì‹œëŠ” ê±¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// /src/pages/signup.astro
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">up</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;name&#34;</span><span class="o">&gt;</span><span class="nx">Name</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;email&#34;</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">&gt;</span><span class="nx">Password</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">Up</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEi7UsbgW-DlRo-b7dc_1FGlUP2deriVEn_Zu-cnHlQqLaElIbZo7TwvVNIVXHjMLyCIR8mVlUHZI-KPGOv1aQxVH_n3q5fgmaGF7npthrf32-LblklU0Wt9OWe3G7KoPsKSLfhmts68s1jaK55w99yHKkw0jGcRcwYKuoP3YxFDAKyhdxpu_UH7XUt4B_A"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ì™€ ê°™ì´ ê¹”ë”í•œ Sign up í˜ì´ì§€ê°€ ì‘ì„±ë˜ì—ˆë„¤ìš”.</p>
<p>ê·¸ëŸ¬ë©´ ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë”ë¯¸ ë°ì´í„°ë¥¼ ë„£ê³  Signup ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ì—¬ê¸°ì„œ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” HTTPì˜ form í–‰ë™ ì–‘ì‹ì— ëŒ€í•´ ì„¤ëª…í•´ ë“œë¦¬ìë©´, ìœ„ ì½”ë“œì—ì„œ &lsquo;form&rsquo; íƒœê·¸ë¥¼ ì˜ ë³´ì‹­ì‹œì˜¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="o">&gt;</span><span class="p">...</span><span class="o">&lt;</span><span class="err">/form&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>methodê°€ &lsquo;post&rsquo;ë¼ê³ ë§Œ ë˜ì–´ ìˆë„¤ìš”.</p>
<p>HTTP POST ë¦¬í€˜ìŠ¤íŠ¸ëŠ” ë³´í†µ ë°ì´í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•´ ì“°ì…ë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  ì´ë ‡ê²Œ POST ë©”ì„œë“œë¥¼ ì²˜ë¦¬í•˜ëŠ” ì„œë²„ì˜ ì£¼ì†Œ ì¦‰, API ì—”ë“œí¬ì¸íŠ¸ëŠ” actionì´ë¼ëŠ” í•­ëª©ìœ¼ë¡œ ì§€ì •í•˜ëŠ”ë°ìš”.</p>
<p>ìœ„ì—ì„œ ë³´ë“¯ì´ &lsquo;form&rsquo; íƒœê·¸ì—ëŠ” action í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
<p>action í•­ëª©ì´ ì—†ìœ¼ë©´ í˜„ì¬ í˜ì´ì§€ë¡œ POST ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ë³´ë‚¸ë‹¤ëŠ” ê²ë‹ˆë‹¤.</p>
<p>ì¦‰, ë‹¤ìŒê³¼ ê°™ì€ ê±°ì£ .</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s1">&#39;post&#39;</span> <span class="nx">action</span><span class="o">=</span><span class="s1">&#39;/signup&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/form&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>signup ë¼ìš°íŒ…ì´ í˜„ì¬ í˜ì´ì§€ì¸ë°ìš”.</p>
<p>ìš°ë¦¬ê°€ Sign Up ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ formì´ submit ë˜ë©´ì„œ ë¦¬í€˜ìŠ¤íŠ¸ê°€ POST ë©”ì„œë“œ ë°©ì‹ìœ¼ë¡œ &ldquo;/signup&rdquo; ë¼ìš°íŒ…ìœ¼ë¡œ ê°‘ë‹ˆë‹¤.</p>
<p>ìš°ë¦¬ê°€ ë§Œë“  AstroëŠ” ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì´ê¸° ë•Œë¬¸ì— ê°™ì€ í˜ì´ì§€ì—ì„œ ì„œë²„ ì‚¬ì´ë“œ ì½”ë“œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ë”°ë¡œ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì•ˆ ë§Œë“¤ì–´ë„ ë˜ëŠ” ê±°ì£ .</p>
<p>ê·¸ëŸ¬ë©´ &lsquo;/src/pages/signup.astro&rsquo; íŒŒì¼ì˜ ì²« ë¶€ë¶„ì— POST ë©”ì„œë“œì˜ HTTP ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ë°‘ì— html ì½”ë“œëŠ” ì´ì „ê³¼ ë™ì¼
</span></span></span></code></pre></div>
  </figure>
</div>
<p>Astroì—ì„œ ë¦¬í€˜ìŠ¤íŠ¸ëŠ” &lsquo;Astro.request&rsquo; ê°ì²´ë¥¼ í†µí•´ ì†ì‰½ê²Œ ì ‘ê·¼ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<p>ìœ„ì™€ ê°™ì´ if ë¬¸ì„ ë‘ì–´ &ldquo;POST&rdquo; ë¦¬í€˜ìŠ¤íŠ¸ì¼ ë•Œë§Œ ì‘ë™í•˜ëŠ” ì½”ë“œë¥¼ ë„£ì—ˆìŠµë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  HTMLì˜ FormDataë¥¼ í†µí•´ ìš°ë¦¬ê°€ ì…ë ¥í•œ name, email, passwordë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ ë°©ì‹ì´ ê°€ì¥ ê¸°ë³¸ì ì€ HTTPì˜ ê¸°ë³¸ ì‘ë™ ë°©ì‹ì´ì£ .</p>
<p>ì ë‹¹í•œ ì´ë¦„ì„ ë„£ê³  &lsquo;Sign Up&rsquo; ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í„°ë¯¸ë„ ì°½ì— ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¬ ê²ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">18:57:02 <span class="o">[</span>200<span class="o">]</span> /signup 19ms
</span></span><span class="line"><span class="cl">counter AstroCookie <span class="o">{</span> value: <span class="s1">&#39;8&#39;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">test</span> test@test.com <span class="m">1234</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì™œ í„°ë¯¸ë„ì°½ì— ë‚˜ì˜¤ëƒë©´ ì„œë²„ ì‚¬ì´ë“œ ì½”ë“œì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ì œê°€ ì…ë ¥í•œ ë°ë¡œ ì˜ ë‚˜ì˜¤ê³  ìˆë„¤ìš”.</p>
<hr>
<h2 id="8-formdataì˜-ìœ íš¨ì„±-ê²€ì‚¬">8. formDataì˜ ìœ íš¨ì„± ê²€ì‚¬</h2>
<p>ìš°ë¦¬ê°€ ì§€ê¸ˆ Typescriptë¥¼ ì“°ê³  ìˆê¸° ë•Œë¬¸ì— formDataì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” ê²Œ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>
<p>zodì˜ safeParse í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•Œê°€ ì˜¨ ê±°ì£ .</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">password</span> <span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ í•œ ë²ˆì— ì¨ë„ ë˜ê³ , ì•„ë˜ì™€ ê°™ì´ ë‚˜ëˆ ì„œ ì¨ë„ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">schema</span> <span class="o">=</span> <span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">schema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">password</span> <span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì´ì œ signup.astro íŒŒì¼ì„ ë‹¤ì‹œ ì¨ë³´ë©´,</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">z</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">password</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;result&#34;</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ë°‘ì— html ì½”ë“œëŠ” ì´ì „ê³¼ ë™ì¼
</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ ì‘ì„±í–ˆê³ , ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ &lsquo;Sign Up&rsquo; ë²„íŠ¼ì„ ëˆŒëŸ¬ë³¼ê¹Œìš”?</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">result <span class="o">{</span>
</span></span><span class="line"><span class="cl">  success: true,
</span></span><span class="line"><span class="cl">  data: <span class="o">{</span> email: <span class="s1">&#39;test2@test2.com&#39;</span>, name: <span class="s1">&#39;test2&#39;</span>, password: <span class="s1">&#39;00000000&#39;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ zod ê°€ ë¦¬í„´í•´ì£¼ëŠ” result ê°’ì´ ì•„ì£¼ ì˜ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p>success ê°€ true, false ê°’ì´ë©´ ìœ íš¨ì„± ê²€ì¦ì„ success í•­ëª©ë§Œ ì°¸ê³ í•˜ë©´ ë˜ê² ë„¤ìš”.</p>
<p>ê·¸ë¦¬ê³  result.data í•­ëª©ì— ì…ë ¥í•œ formDataê°€ ì˜ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p>ì¼ë¶€ëŸ¬ ì‹¤íŒ¨í•´ ë³¼ê¹Œìš”?</p>
<p>emailì€ ë¶ˆì™„ì „í•˜ê²Œ ë„£ê³  passwordëŠ” 8ê¸€ì ë³´ë‹¤ ì ê²Œ ë„£ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¤ëŠ”ë°ìš”.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">result</span> <span class="p">{</span> <span class="nx">success</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">error</span><span class="o">:</span> <span class="p">[</span><span class="nx">Getter</span><span class="p">]</span> <span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>successê°€ falseì¼ ê²½ìš° errorë¥¼ í‘œì‹œí•´ ì£¼ëŠ” console.logë¥¼ ì¶”ê°€í•˜ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">issues</span><span class="p">)</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>
</span></span><span class="line"><span class="cl">  <span class="o">{</span>
</span></span><span class="line"><span class="cl">    validation: <span class="s1">&#39;email&#39;</span>,
</span></span><span class="line"><span class="cl">    code: <span class="s1">&#39;invalid_string&#39;</span>,
</span></span><span class="line"><span class="cl">    message: <span class="s1">&#39;Invalid email&#39;</span>,
</span></span><span class="line"><span class="cl">    path: <span class="o">[</span> <span class="s1">&#39;email&#39;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>,
</span></span><span class="line"><span class="cl">  <span class="o">{</span>
</span></span><span class="line"><span class="cl">    code: <span class="s1">&#39;too_small&#39;</span>,
</span></span><span class="line"><span class="cl">    minimum: 8,
</span></span><span class="line"><span class="cl">    type: <span class="s1">&#39;string&#39;</span>,
</span></span><span class="line"><span class="cl">    inclusive: true,
</span></span><span class="line"><span class="cl">    exact: false,
</span></span><span class="line"><span class="cl">    message: <span class="s1">&#39;String must contain at least 8 character(s)&#39;</span>,
</span></span><span class="line"><span class="cl">    path: <span class="o">[</span> <span class="s1">&#39;password&#39;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ zodê°€ ì•„ì£¼ ì˜ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p>result.error.issues í•­ëª©ì„ ì˜ ë‹¤ë£¬ë‹¤ë©´ ê°€ì…í•˜ê¸° í˜ì´ì§€ì—ì„œ ì‹¤ì œ ì‚¬ìš©ìì—ê²Œ ë­ê°€ ì˜ëª»ë˜ì—ˆëŠ”ì§€ ìƒì„¸í•˜ê¸° ì•Œë ¤ì¤„ ìˆ˜ê°€ ìˆê² ë„¤ìš”.</p>
<p>ì´ì œ ê°€ì…í•˜ê¸° í˜ì´ì§€ì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ì— ì‹¤íŒ¨í•˜ë©´ issues ë³€ìˆ˜ì— ì €ì¥í•˜ì—¬ ë¸Œë¼ìš°ì €ì— í‘œì‹œë˜ë„ë¡ ì„¤ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ë˜ ìœ íš¨ì„± ê²€ì‚¬ì— ì‹¤íŒ¨í•˜ë©´ Astro.response.statusì—ì„œ ìƒíƒœ ì½”ë“œ 400(Bad Request)ì„ ë°˜í™˜í•˜ë„ë¡ ì„¤ì •í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>Astro.response.statusë¥¼ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ìƒíƒœ ì½”ë“œ 200ì´ ë°˜í™˜ë˜ê¸° ë•Œë¬¸ì— ê¼­ Astro.response.statusë¥¼ ì„¤ì •í•˜ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">z</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">issues</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">ZodIssue</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">password</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">issues</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">up</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;name&#34;</span><span class="o">&gt;</span><span class="nx">Name</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;email&#34;</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">&gt;</span><span class="nx">Password</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">issues</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">issues</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">issue</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">issue</span><span class="p">.</span><span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span><span class="o">:</span><span class="p">{</span><span class="nx">issue</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">Up</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ê°€ì…í•˜ê¸° í˜ì´ì§€ì˜ UI ë¶€ë¶„ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<p>ì¼ë¶€ëŸ¬ í‹€ë¦¬ê²Œ í…ŒìŠ¤íŠ¸í•´ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë¸Œë¼ìš°ì €ì— ê·¸ ë‚´ìš©ì´ ë‚˜íƒ€ë‚˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjZ1cFwtdGo6-LAigIAsh-pmXbDfvGtX8RnKf-NzYxg5I_wEHS0IAZB75ft0a3W3DDLDvRkvwe45IFdvWiA0ogx1GCdIfSQ3qgW5iziSzSzub84ibsuniQbw56LoNrJCU6lPr1qUSqkNh7PSrnS0O1aOcbQ3pT8Tj4xIH_vaFhRTT4D_iA6T3_xY4I1t7w"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ì¼ë‹¨ ì—¬ê¸°ê¹Œì§€ ì„±ê³µì…ë‹ˆë‹¤.</p>
<p>ê·¸ëŸ°ë°, formì˜ submit íŠ¹ì„±ìƒ submit ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì…ë ¥í•œ ê°’ì´ ì—†ì–´ì§‘ë‹ˆë‹¤.</p>
<p>ì—ëŸ¬ê°€ ë‚  ê²½ìš° ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì´ ë‚¨ì•„ ìˆì–´ì•¼ ë­ê°€ í‹€ë ¸ëŠ”ì§€ ì•Œ ìˆ˜ ìˆëŠ”ë°ìš”.</p>
<p>ì´ ë¶€ë¶„ì„ ìˆ˜ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>Astroì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ê°„ë‹¨í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ê° í•­ëª©ì˜ ë³€ìˆ˜ ê°’ì„ ë”°ë¡œ ë§Œë“¤ê³  input íƒœê·¸ì˜ valueê°’ì— ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.</p>
<p>ì´ê±´ Reactê°€ ì•„ë‹ˆë¼ì„œ onChangeë¥¼ ì‹ ê²½ ì“°ì§€ ì•Šì•„ë„ ë˜ì£ .</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">z</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">issues</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">ZodIssue</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">nameInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">emailInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">passwordInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">nameInput</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">emailInput</span> <span class="o">=</span> <span class="nx">email</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">passwordInput</span> <span class="o">=</span> <span class="nx">password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">password</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">issues</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">up</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;name&#34;</span><span class="o">&gt;</span><span class="nx">Name</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">nameInput</span><span class="p">}</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;email&#34;</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">emailInput</span><span class="p">}</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">&gt;</span><span class="nx">Password</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span>
</span></span><span class="line"><span class="cl">        <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">passwordInput</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">required</span>
</span></span><span class="line"><span class="cl">      <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">issues</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">issues</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">issue</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">issue</span><span class="p">.</span><span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span><span class="o">:</span><span class="p">{</span><span class="nx">issue</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">Up</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³¼ê¹Œìš”?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhKAerZgLkDWJfDxGogmev5r1idSwOa8J4sOVTSFgmTD7R1_hurk_HQjNXXr0NURtGL7CneOshEmrfKCfMwv5G1YhZMOYk00vve15zC9c0FdDh1WW2D8slbDgdOymeaJ9MAIYHwMAbDoFuxtDIz8d1UT4zIC_gWauEIPUEl8B9eEEY2Y-bnLcf55UGZltE"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ì™€ ê°™ì´ ë°‘ì— ì—ëŸ¬ í‘œì‹œê°€ ë˜ë©´ì„œ ë™ì‹œì— ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì´ ìœ ì§€ë˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="9-ìœ ì €-ì •ë³´ë¥¼-dbì—-ì €ì¥í•˜ê¸°">9. ìœ ì € ì •ë³´ë¥¼ DBì— ì €ì¥í•˜ê¸°</h2>
<p>ì´ì œ ì •ìƒì ìœ¼ë¡œ ì…ë ¥í–ˆì„ ê²½ìš° DBì— ì €ì¥í•˜ëŠ” ë¶€ë¶„ì„ ì‘ì„±í•´ì•¼ê² ë„¤ìš”.</p>
<p>ì•„ê¹Œ ë§Œë“¤ì—ˆë˜ &rsquo;lib/prisma.ts&rsquo; íŒŒì¼ì—ì„œ Prisma Clientë¥¼ ë¶ˆëŸ¬ì™€ì„œ create í•´ì£¼ë©´ ë©ë‹ˆë‹¤.</p>
<p>ì½”ë“œê°€ ìœ„ì¹˜í•  ê³³ì€ ì•„ë˜ì™€ ê°™ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ ë³´ì—¬ì£¼ë˜ error í‘œì‹œ ë‹¤ìŒì¸ë°ìš”.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">z</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">prisma</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;../lib/prisma&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ê¸°ì¡´ ë™ì¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">issues</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ ìœ íš¨ì„± ê²€ì¦ì´ ì‹¤íŒ¨í•˜ì§€ ì•Šì•˜ì„ ê²½ìš° prisma.user.create í•¨ìˆ˜ë¥¼ í†µí•´ DBì— ì‘ì„±í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ìœ íš¨ì„± ê²€ì¦ì„ í†µê³¼í•  ìˆ˜ ìˆê²Œ ìœ ì € ì •ë³´ë¥¼ ë„£ì–´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>í™”ë©´ í‘œì‹œëŠ” ê·¸ëŒ€ë¡œ ì…ë ¥í•œ ê°’ì´ ë‚˜ì˜¤ê³  ìˆê³  í„°ë¯¸ë„ ì°½ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ POST ë©”ì„œë“œê°€ ì‘ë™í–ˆë‹¤ê³  ë‚˜ì˜¤ë„¤ìš”.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">counter AstroCookie <span class="o">{</span> value: <span class="s1">&#39;8&#39;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">19:20:12 <span class="o">[</span>200<span class="o">]</span> POST /signup 15ms</span></span></code></pre></div>
  </figure>
</div>
<p>ê·¸ ì™€ì¤‘ì— middlewareì— ì„¤ì •í–ˆë˜ console.logë„ ì˜ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ Prisma Studioë¡œ ê°€ì„œ ë°ì´í„°ê°€ ì˜ ë“¤ì–´ì™”ëŠ”ì§€ ë³¼ê¹Œìš”?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEh2Ou1jHCT5licLLE2NevzIixSzS28T_R278qROep7v-BhMBWj7RYjEyuSdFVdbaBtmhlqy4PoOAT00R0-XuHD9F0RLbmNLsBDnchsREVI8fUsM49DjvbK9dELZmWzZlm-2sVmIUf1egmIKf-oZmpHdFq7h4wgnVcxEEFHqZjfjPAqs-9XY5uyurhistTI"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ì™€ ê°™ì´ ë°ì´í„°ê°€ ì˜ ë“¤ì–´ì™”ë„¤ìš”.</p>
<p>ê·¸ëŸ°ë° íŒ¨ìŠ¤ì›Œë“œê°€ ì¼ë°˜ í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤.</p>
<p>ì ˆëŒ€ ì´ë ‡ê²Œ ì„¤ê³„í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.</p>
<p>íŒ¨ìŠ¤ì›Œë“œëŠ” í•´ì‹œëœ ìƒíƒœë¡œ ì €ì¥í•´ì•¼ í•˜ì£ .</p>
<p>ì•„ê¹Œ ì„¤ì¹˜í•œ bcryptjs ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œê°€ ì™”ë„¤ìš”.</p>
<p>ì•„ê¹Œ if-else ë¶€ë¶„ì— ì•„ë˜ì™€ ê°™ì´ ê³ ì¹˜ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">z</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">prisma</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;../lib/prisma&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">bcrypt</span> <span class="nx">from</span> <span class="s2">&#34;bcryptjs&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ê¸°ì¡´ê³¼ ë™ì¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">issues</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">salt</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">genSaltSync</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">hashedPassword</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hashSync</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span> <span class="nx">salt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">email</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">password</span><span class="o">:</span> <span class="nx">hashedPassword</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì´ì œ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•´ë³¼ê¹Œìš”?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjVoxoMlZtZTsMrZLGRleN0paSciUZRkH2QAei6Fo4sFmLiIIE85q_ISM2VcqHCOU3tBCxndaSakU5n0O2rzHbKzUmm0V5OgDo4oeDeeMa2oB9XGocmLO66EwXl-mWk2cdhXk00Gu-tGlbtTiaH9QTYr3_-YV05azUYPBjSIArXfsC--x6hWLXNckAy3xY"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ì™€ ê°™ì´ test2 ë¼ëŠ” ì´ë¦„ì˜ íŒ¨ìŠ¤ì›Œë“œëŠ” í•´ì‹œëœ ìƒíƒœë¡œ ì˜ ì €ì¥ë˜ì—ˆë„¤ìš”.</p>
<hr>
<h2 id="10-ë™ì¼-ì´ë©”ì¼-ì—ëŸ¬-ì²˜ë¦¬í•˜ê¸°">10. ë™ì¼ ì´ë©”ì¼ ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°</h2>
<p>ì´ë©”ì¼ì€ ìœ ë‹ˆí¬í•˜ê²Œ ì„¤ì •í–ˆì—ˆëŠ”ë°ìš”.</p>
<p>ì™œëƒí•˜ë©´ ì´ë©”ì¼ì€ ì‚¬ëŒë§ˆë‹¤ ê³ ìœ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ ê°€ì…í•  ë•Œ ì´ë©”ì¼ì´ ì¤‘ë³µë˜ì—ˆë‹¤ëŠ” ê±°ëŠ” ìœ ì €ê°€ ì´ì „ì— ê°€ì…í•œ ì •ë³´ê°€ ìˆë‹¤ëŠ” ê²ë‹ˆë‹¤.</p>
<p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ì•„ê¹Œ ê°€ì…í•œ &rsquo;test2@test.com&rsquo; ì´ë¼ëŠ” ì´ë©”ì¼ì„ ë‹¤ì‹œ ì‚¬ìš©í•´ì„œ ê°€ì…í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>í„°ë¯¸ë„ ì°½ì€ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë‚˜ì˜¤ê³ , ë¸Œë¼ìš°ì €ë„ ê°™ì€ ì—ëŸ¬ê°€ ë‚˜ì˜µë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">19:27:18 <span class="o">[</span>ERROR<span class="o">]</span>
</span></span><span class="line"><span class="cl">Invalid <span class="sb">`</span>prisma.user.create<span class="o">()</span><span class="sb">`</span> invocation:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Unique constraint failed on the fields: <span class="o">(</span><span class="sb">`</span>email<span class="sb">`</span><span class="o">)</span></span></span></code></pre></div>
  </figure>
</div>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgnLTH_pAh26zVAwlDNnesye9LOd0xXRWhjjMGwrV4ElRJp0wlbx6yN1nJGCKn-nc3TAjvLerWpNQ6psxtUA04M5IYji0JcT9s2UaN7VLSndAs3ftzWiFki0CUZn0Ds3mvKxFoZ7tVdJWR8iaHf-5EyKHnWwpNbI6zU_YavpTXlPr0cXDm1lVNcpttDetI"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>Prismaê°€ ì¹œì ˆí•˜ê²Œ ì—ëŸ¬ ì´ìœ ë„ ê°€ë¥´ì³ ì£¼ê³  ìˆë„¤ìš”.</p>
<p>ì½”ë“œì— ì´ ë¶€ë¶„ì„ ì ê²€í•˜ëŠ” ë¶€ë¶„ì„ ì¶”ê°€í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ìœ ì €ì—ì„¸ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì˜ ë³´ì—¬ì£¼ê¸° ìœ„í•´ errorsë¼ëŠ” ë°°ì—´ì„ ë”°ë¡œ ë§Œë“¤ì–´ì„œ ì²˜ë¦¬í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>prisma.user.create ë¶€ë¶„ì—ì„œ try, catch ë¬¸ì„ ì´ìš©í•´ì„œ Prismaê°€ ë‚´ë¿œëŠ” PrismaClientKnownRequestError ê´€ë ¨ ì—ëŸ¬ë¥¼ ìºì¹˜í•´ì„œ ì²˜ë¦¬í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>ì „ì²´ ì½”ë“œì…ë‹ˆë‹¤.</p>
<p>HTML ìª½ ì—ëŸ¬ ì‚¬ìœ ë¥¼ ë³´ì—¬ì£¼ëŠ” ê³³ë„ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">z</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">prisma</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;../lib/prisma&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">bcrypt</span> <span class="nx">from</span> <span class="s2">&#34;bcryptjs&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Prisma</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;@prisma/client&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">ErrorMessage</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span><span class="o">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="nx">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">message</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">errors</span><span class="o">:</span> <span class="nx">ErrorMessage</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">nameInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">emailInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">passwordInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">nameInput</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">emailInput</span> <span class="o">=</span> <span class="nx">email</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">passwordInput</span> <span class="o">=</span> <span class="nx">password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">password</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">errors</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">salt</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">genSaltSync</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">hashedPassword</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hashSync</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span> <span class="nx">salt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">name</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">email</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">password</span><span class="o">:</span> <span class="nx">hashedPassword</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="k">instanceof</span> <span class="nx">Prisma</span><span class="p">.</span><span class="nx">PrismaClientKnownRequestError</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="s2">&#34;P2002&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">errors</span> <span class="o">=</span> <span class="p">[{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;email&#34;</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s2">&#34;email already registered&#34;</span> <span class="p">}];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">up</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;name&#34;</span><span class="o">&gt;</span><span class="nx">Name</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">nameInput</span><span class="p">}</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;email&#34;</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">emailInput</span><span class="p">}</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">&gt;</span><span class="nx">Password</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span>
</span></span><span class="line"><span class="cl">        <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">passwordInput</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">required</span>
</span></span><span class="line"><span class="cl">      <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">errors</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">errors</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">:</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">Up</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ë‹¤ì‹œ ì¼ë¶€ëŸ¬ ì—ëŸ¬ë¥¼ ë‚´ ë³¼ê¹Œìš”?</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEg1eb3JZD0A94lgt1DPaZQH5btuAMb9Tt3yA7ZhZrzOTgzjd2AtzGnuC2aiMMYK2kMRCxLTo4_XDpX9HrfFloD1_za0pq__K95T5GHeOdx7-LeYUSxGA54gYPdIHiOvBOCmt63YkMvGnoDBjhNkaw4DAsPLHuZ5eFJ8FekJuUl0A7CYqDwsDhVdCD8xeBE"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ email ì¤‘ë³µ ì—ëŸ¬ë„ ì˜ ì¡ì•„ë‚´ê³  ìˆìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="11-í† í°-ë§Œë“¤ê¸°">11. í† í° ë§Œë“¤ê¸°</h2>
<p>ì‚¬ìš©ìê°€ ê°€ì…í•˜ê¸°ë¥¼ í†µí•´ ì„±ê³µì ìœ¼ë¡œ ê°€ì…ì„ í–ˆìœ¼ë©´ ê·¸ ìƒíƒœë¡œ ë¡œê·¸ì¸í•œ ìƒíƒœê°€ ë¼ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ìš°ë¦¬ê°€ ì´ë²ˆ ê°•ì¢Œì—ì„œ ì‚¬ìš©í•  ë¡œê·¸ì¸ ë°©ì‹ì€ í† í°ì„ ì´ìš©í•œ ë°©ì‹ì´ì£ .</p>
<p>ê·¸ë˜ì„œ í† í°ì„ ìƒì„±í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>jsonwebtoken íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•  ê²ë‹ˆë‹¤.</p>
<p>í† í°ì˜ secretëŠ” ë³´í†µ &lsquo;.env&rsquo; íŒŒì¼ì— ì‘ì„±í•˜ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## .env</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">DATABASE_URL</span><span class="o">=</span><span class="s2">&#34;file:./dev.db&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">SECRET</span><span class="o">=</span>asdfasdfsadfasdfsadf</span></span></code></pre></div>
  </figure>
</div>
<p>ì•„ë¬´ ê¸€ìë‚˜ ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.</p>
<p>í† í°(token)ì„ ë§Œë“¤ë ¤ë©´ jwt.sign í•¨ìˆ˜ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">id</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">email</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="nx">expiresIn</span><span class="o">:</span> <span class="s1">&#39;1d&#39;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span></span></span></code></pre></div>
  </figure>
</div>
<p>AstroëŠ” Viteë¥¼ ì´ìš©í•˜ê³  ìˆì–´ì„œ &lsquo;import.meta.env.SECRET&rsquo;ë¼ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<p>íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìœ„í•´ì„œ &rsquo;env.d.ts&rsquo;íŒŒì¼ì— SECRET ê´€ë ¨ íƒ€ì…ë„ ì•„ë˜ì™€ ê°™ì´ ì§€ì •í•˜ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">/// &lt;reference types=&#34;astro/client&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">ImportMetaEnv</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">readonly</span> <span class="nx">SECRET</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kr">interface</span> <span class="nx">ImportMeta</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">readonly</span> <span class="nx">env</span><span class="o">:</span> <span class="nx">ImportMetaEnv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>tokenì„ ë§Œë“œëŠ” ì½”ë“œëŠ” ì–´ë””ì— ìœ„ì¹˜í•´ì•¼ í• ê¹Œìš”?</p>
<p>ë‹¹ì—°íˆ Prismaë¥¼ ì´ìš©í•´ì„œ DBì— ì‚¬ìš©ì ì •ë³´ë¥¼ create ì™„ë£Œí–ˆì„ ë•Œì…ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">jwt</span> <span class="nx">from</span> <span class="s2">&#34;jsonwebtoken&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">salt</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">genSaltSync</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">hashedPassword</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hashSync</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span> <span class="nx">salt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">email</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">password</span><span class="o">:</span> <span class="nx">hashedPassword</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">email</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="nx">expiresIn</span><span class="o">:</span> <span class="s2">&#34;1d&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì½”ë“œê°€ ë„ˆë¬´ ê¸¸ì–´ ìœ„ì™€ ê°™ì´ ì½”ë“œ ì¼ë¶€ë¶„ë§Œ ë³´ì—¬ì¤¬ìŠµë‹ˆë‹¤.</p>
<p>ë“¤ì–´ê°ˆ ìœ„ì¹˜ë§Œ í™•ì¸í•˜ì‹œê³  ë„£ì–´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  prisma.user.createì˜ ê²°ê³¼ ê°’ì„ user ë³€ìˆ˜ì— ì €ì¥í–ˆìŠµë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ jwt.sign í•¨ìˆ˜ì— user.id, user.name, user.email ê°’ì„ ì´ìš©í•  ìˆ˜ ìˆê²Œ ë˜ëŠ” ê±°ì£ .</p>
<p>ì—¬ê¸°ì„œ ì‹ ê¸°í•œê²Œ ì§€ê¸ˆê¹Œì§€ ë§Œë“  ëª¨ë“  ì½”ë“œëŠ” ì•„ë˜ if ë¬¸ ì•ˆì— ìˆëŠ” ê²ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì¦‰, ìœ ì €ê°€ form ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê³  submit ë²„íŠ¼ì„ ëˆŒëŸ¬ POST ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì—ˆì„ ë•Œ ì‘ë™í•˜ëŠ” ì½”ë“œì¸ ê±°ì£ .</p>
<p>ì›¹ ì„œë²„ì˜ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ì‘ë™ ë°©ì‹ì…ë‹ˆë‹¤.</p>
<p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œ ìƒˆë¡œìš´ ê°€ì…ìë¥¼ ì…ë ¥í•˜ê³  í„°ë¯¸ë„ ì°½ì„ ë³¼ê¹Œìš”?</p>
<p>í† í°ì´ ì–´ë–»ê²Œ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">counter AstroCookie <span class="o">{</span> value: <span class="s1">&#39;8&#39;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywibmFtZSI6InRlc3Q1IiwiZW1haWwiOiJ0ZXN0NUB0ZXN0LmNvbSIsImlhdCI6MTcwNDE5MjA3NiwiZXhwIjoxNzA0Mjc4NDc2fQ.-iVFexjKGcNoaOUGJ9ZLAIGw9r1qe5Z3WCGqch5VmL8</span></span></code></pre></div>
  </figure>
</div>
<p>í† í° ê°’ì´ ë‚˜ì™”ë„¤ìš”.</p>
<p>ì´ê±¸ ë””ì½”ë“œí•  ìˆ˜ ìˆëŠ” <a href="https://jwt.io">https://jwt.io</a> í˜ì´ì§€ì—ì„œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjb9VZW6NnnON4zx920Qu0VJuw4RBRd5JR6zJDcJ2IzgRx8HhIN882Za10ITAhpP6Ly6wivsj6hCTEkGU_VhoG1okqkBCNkdVbWsWYXUZXDNhJzax7Pb9xSg2zn43CZ4imFNhCvyeIPX00ScVKL6v4pWZBq1w2opCPZk_swpd_NYW-qnobsFrKZLEAU75U"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ì™€ ê°™ì´ ë‚˜ì˜¤ëŠ”ë°ìš”.</p>
<p>ì•Œê³ ë¦¬ì¦˜ì€ &lsquo;HS256&rsquo;ì´ê³ , ë°©ì‹ì€ &lsquo;JWT&rsquo;ë¼ê³  ë‚˜ì˜µë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  ì…ë ¥í–ˆë˜ name, email ì •ë³´ë„ ì •í™•í•˜ë„¤ìš”.</p>
<p>ì´ë ‡ê²Œ í† í°ì„ ë””ì½”ë“œí•˜ë©´ ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ ìš°ë¦¬ê°€ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ë˜ì—ˆë‹¤ëŠ” ì •ë³´ë¥¼ ì¿ í‚¤ì— í† í°ì„ ì €ì¥í•˜ê³ , í•„ìš”í•  ë•Œ ë””ì½”ë“œí•˜ë©´ ë˜ëŠ” ê±°ì£ .</p>
<hr>
<h2 id="12-ì¿ í‚¤-ë§Œë“¤ê¸°">12. ì¿ í‚¤ ë§Œë“¤ê¸°</h2>
<p>í† í° ì‘ì„±ì´ ì™„ë£Œë˜ì—ˆë„¤ìš”.</p>
<p>ì´ í† í°ì„ ì¿ í‚¤ì— ì €ì¥í•˜ëŠ” ì½”ë“œë¥¼ ë§Œë“¤ë©´ ë©ë‹ˆë‹¤.</p>
<p>í† í°ì€ &rsquo;token&rsquo;ì´ë¼ëŠ” ë³€ìˆ˜ì— ì €ì¥í–ˆì—ˆì£ .</p>
<p>ì¿ í‚¤ëŠ” ì•„ë˜ì™€ ê°™ì´ ë§Œë“¤ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;mytoken&#39;</span><span class="p">,</span> <span class="nx">token</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">secure</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">maxAge</span><span class="o">:</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì¿ í‚¤ ì´ë¦„ì€ &lsquo;mytoken&rsquo;ì´ë„¤ìš”.</p>
<p>ì´ ì´ë¦„ì„ íŠ¹ë³„í•˜ê²Œ ë§Œë“œëŠ” ê²Œ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>
<p>ë³´í†µ ì‚¬ì´íŠ¸ ì´ë¦„ê³¼ ì—°ê´€í•˜ì—¬ ë§Œë“œëŠ”ê²Œ ì¤‘ìš”í•˜ì£ .</p>
<p>ë‹¤ë¥¸ ì›¹ì‚¬ì´íŠ¸ë‘ ì¿ í‚¤ ì´ë¦„ì´ ì¤‘ë³µë˜ë©´ ì•ˆ ë˜ë‹ˆê¹Œìš”?</p>
<p>ê·¸ë¦¬ê³  ì¿ í‚¤ë¥¼ ì €ì¥í–ˆìœ¼ë©´ ëª¨ë“  ê°€ì…í•˜ê¸° ë¡œì§ì´ ëë‚¬ê¸° ë•Œë¬¸ì— ëŒ€ì‹œë³´ë“œë¡œ ì´ë™í•˜ëŠ” &lsquo;redirect&rsquo; ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ë©ë‹ˆë‹¤.</p>
<p>ì´ì½”ë“œëŠ” jwt.sign í•¨ìˆ˜ ì•„ë˜ìª½ì— ë„£ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<p>í˜¹ì‹œë‚˜ í•´ì„œ signup.astro íŒŒì¼ì˜ ì „ì²´ ì½”ë“œë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">z</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">prisma</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;../lib/prisma&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">bcrypt</span> <span class="nx">from</span> <span class="s2">&#34;bcryptjs&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Prisma</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;@prisma/client&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">jwt</span> <span class="nx">from</span> <span class="s2">&#34;jsonwebtoken&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">ErrorMessage</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span><span class="o">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="nx">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">message</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">errors</span><span class="o">:</span> <span class="nx">ErrorMessage</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">nameInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">emailInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">passwordInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">nameInput</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">emailInput</span> <span class="o">=</span> <span class="nx">email</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">passwordInput</span> <span class="o">=</span> <span class="nx">password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">password</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">errors</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">salt</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">genSaltSync</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">hashedPassword</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hashSync</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span> <span class="nx">salt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">name</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">email</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">password</span><span class="o">:</span> <span class="nx">hashedPassword</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">id</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">name</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">email</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span> <span class="nx">expiresIn</span><span class="o">:</span> <span class="s2">&#34;1d&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&#34;mytoken&#34;</span><span class="p">,</span> <span class="nx">token</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">secure</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">maxAge</span><span class="o">:</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s2">&#34;/dashboard&#34;</span><span class="p">,</span> <span class="mi">302</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="k">instanceof</span> <span class="nx">Prisma</span><span class="p">.</span><span class="nx">PrismaClientKnownRequestError</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="s2">&#34;P2002&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">errors</span> <span class="o">=</span> <span class="p">[{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;email&#34;</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s2">&#34;email already registered&#34;</span> <span class="p">}];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">up</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;name&#34;</span><span class="o">&gt;</span><span class="nx">Name</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;name&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">nameInput</span><span class="p">}</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;email&#34;</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">emailInput</span><span class="p">}</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">&gt;</span><span class="nx">Password</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span>
</span></span><span class="line"><span class="cl">        <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">passwordInput</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">required</span>
</span></span><span class="line"><span class="cl">      <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">errors</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">errors</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">:</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">Up</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ìƒˆë¡œìš´ ì‚¬ìš©ìë¥¼ ê°€ì…í•´ ë³¼ê¹Œìš”?</p>
<p>ì •ìƒì ìœ¼ë¡œ ì…ë ¥í•˜ë©´ ëŒ€ì‹œë³´ë“œë¡œ í˜ì´ì§€ê°€ ì´ë™ë˜ê³ , í¬ë¡¬ ê°œë°œì°½ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ìª½ìœ¼ë¡œ ê°€ì„œ ì¿ í‚¤ë¥¼ ë³´ì‹œë©´ ì•„ë˜ì™€ ê°™ì´ mytokenì´ë¼ëŠ” ì¿ í‚¤ê°€ ë³´ì´ê³ , ë§¨ ì²˜ìŒ ë§Œë“¤ì—ˆë˜ counter ì¿ í‚¤ë„ ë³´ì´ë„¤ìš”.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgvg192GVQFtIwIPPiwMSvh8TA1omgEd7Gart3Np0nW9pnhwo0G4RdTOToc-bF5w7_j5HsAiieKdlDu0JP4jPjiFhyr8b-7tnW_Wc3jzcdyw5dnGcSTBa7gUlYtNpL56YpqzgeQ7o1AlsYieGB0Ed4ZbgkeYjq7iIKY0fnZFITahqnf4EG5-e4zB925HrY"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>counter ì¿ í‚¤ëŠ” ì‚­ì œí•˜ì§€ ì•Šì•„ì„œ ê³„ì† ë³´ì´ë„¤ìš”.</p>
<p>mytoken ì¿ í‚¤ì˜ ê°’ì— ìš°ë¦¬ê°€ ë§Œë“  í† í° ê°’ì´ ìˆìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="13-ë¡œê·¸ì¸-í˜ì´ì§€-ë§Œë“¤ê¸°">13. ë¡œê·¸ì¸ í˜ì´ì§€ ë§Œë“¤ê¸°</h2>
<p>ìœ ì € ê°€ì…í•˜ê¸° í˜ì´ì§€ë¥¼ ë§Œë“¤ì—ˆìœ¼ë‹ˆ ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ ë§Œë“¤ì–´ì•¼ê² ì£ .</p>
<p>ë¡œê·¸ì¸ ë¡œì§ì€ ê°„ë‹¨í•©ë‹ˆë‹¤.</p>
<p>ì´ë©”ì¼ê³¼ íŒ¨ìŠ¤ì›Œë“œë§Œ í¼ë°ì´í„°ë¡œ ë°›ì•„ì„œ ê·¸ê±¸ DBì˜ ì´ë©”ì¼ê³¼ íŒ¨ìŠ¤ì›Œë“œì™€ ë¹„êµí•´ì„œ ë§ìœ¼ë©´ í•´ë‹¹ í† í°ì„ ë§Œë“¤ê³ , ë‹¤ì‹œ ê·¸ í† í°ì„ mytokenì´ë¼ëŠ” ì¿ í‚¤ì— ì €ì¥í•˜ë©´ ë˜ëŠ” ê±°ì£ .</p>
<p>src í´ë” ë°‘ì˜ pages í´ë” ë°‘ì— login.astro ë¼ëŠ” íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ë§Œë“­ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">z</span> <span class="nx">from</span> <span class="s2">&#34;zod&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">prisma</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;../lib/prisma&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">bcrypt</span> <span class="nx">from</span> <span class="s2">&#34;bcryptjs&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">jwt</span> <span class="nx">from</span> <span class="s2">&#34;jsonwebtoken&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">ErrorMessage</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span><span class="o">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="nx">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">message</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">errors</span><span class="o">:</span> <span class="nx">ErrorMessage</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">emailInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">passwordInput</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">emailInput</span> <span class="o">=</span> <span class="nx">email</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">passwordInput</span> <span class="o">=</span> <span class="nx">password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">z</span><span class="p">.</span><span class="nx">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">errors</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">findUnique</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">email</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">errors</span> <span class="o">=</span> <span class="p">[{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;email&#34;</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s2">&#34;Invalid credentials&#34;</span> <span class="p">}];</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">valid</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">compareSync</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">valid</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">errors</span> <span class="o">=</span> <span class="p">[{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;password&#34;</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s2">&#34;Invalid credentials&#34;</span> <span class="p">}];</span>
</span></span><span class="line"><span class="cl">          <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">id</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">name</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">email</span><span class="o">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="nx">expiresIn</span><span class="o">:</span> <span class="s2">&#34;1d&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">          <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="nx">Astro</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&#34;mytoken&#34;</span><span class="p">,</span> <span class="nx">token</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">secure</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">maxAge</span><span class="o">:</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="k">return</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s2">&#34;/dashboard&#34;</span><span class="p">,</span> <span class="mi">302</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Astro</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;email&#34;</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;email&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">emailInput</span><span class="p">}</span> <span class="nx">required</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">&gt;</span><span class="nx">Password</span><span class="o">&lt;</span><span class="err">/label&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">input</span>
</span></span><span class="line"><span class="cl">        <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">passwordInput</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">required</span>
</span></span><span class="line"><span class="cl">      <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">errors</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">errors</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">:</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/signup&#34;</span><span class="o">&gt;</span><span class="nx">SigUp</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì „ì²´ ì½”ë“œì…ë‹ˆë‹¤.</p>
<p>ì™œëƒí•˜ë©´ ê°€ì…í•˜ê¸° ë¡œì§ê³¼ ê±°ì˜ ë¹„ìŠ·í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ë¨¼ì €, ì•„ë˜ ì½”ë“œì²˜ëŸ¼ ì´ë©”ì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">findUnique</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">email</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ê·¸ë¦¬ê³  í•´ë‹¹ ì´ë©”ì¼ì´ ìˆìœ¼ë©´ ê·¸ ì‚¬ìš©ì ì •ë³´ë¥¼ user ë³€ìˆ˜ì— ì €ì¥í•˜ê³  ë‚˜ì„œ ë‹¤ì‹œ í•´ì‹œëœ íŒ¨ìŠ¤ì›Œë“œì™€ ë¹„êµí•©ë‹ˆë‹¤.</p>
<p>í•´ì‹œëœ íŒ¨ìŠ¤ì›Œë“œë¥¼ ë¹„êµí•˜ëŠ” í•¨ìˆ˜ëŠ” bcrypt.compareSync í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">valid</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">compareSync</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì´ í•¨ìˆ˜ëŠ” ë™ê¸°ì‹ì¸ë°ìš”.</p>
<p>ì´ í•¨ìˆ˜ê°€ ë¹„ë™ê¸°ì‹ì´ë©´ ë¬¸ì œê°€ ë˜ì£ .</p>
<p>íŒ¨ìŠ¤ì›Œë“œ í™•ì¸ë„ ëª»í–ˆëŠ”ë° ë‹¤ìŒ ì½”ë“œë¥¼ ìˆ˜í–‰í•˜ë©´ ì•ˆ ë˜ë‹ˆê¹Œìš”.</p>
<p>ê·¸ëŸ¬ë©´ ì•„ê¹Œ ê°€ì…í–ˆë˜ ìœ ì € ì •ë³´ë¡œ ë¡œê·¸ì¸í•´ë³¼ê¹Œìš”?</p>
<p>ìˆ˜ì‘ì—…ìœ¼ë¡œ mytokenì´ë¼ëŠ” ì¿ í‚¤ë¥¼ ì‚­ì œí•˜ê³  ì‹œë„í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ì•„ì§ logout ë¡œì§ì´ ì—†ì–´ì„œ ì´ì£ .</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEj3GGUv-pSvzBYJ9TJHSLvucdkZSBseHyjQYXKl71g6bu4rKWHDEnHBgAKmVtbiUYJeDk-Syk-WuLTKBcBphwYEtYjROvTtRQ09OaEeo-77KWjZRYTXdG5XooKDx39rFW_JaYij6R-LjXaioTghKSQFY1BGW1B76EnDyvGAq1G4aUBkfOlXbMg5mDNF5OQ"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ mytoken ì¿ í‚¤ê°’ì´ ì—†ì„ ë•Œ ë¡œê·¸ì¸ì„ ì‹œë„í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ mytokenì´ ìƒê¹ë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEigikaPZWVHxQNO0W0padDVtUMjywtyDUwdX4_mUzu67z79-_oWlu0Os8v8rICH0TKAhTKdSePbpNDkxDTQTZTMhfpricMB4yf2Xs_02SJf5Umw7fYTlGJw2mlyNyZBPuI9jjy8G1QnTxYOy0OiCQBFs7qrvFG4NZiFFMQFMh7-iaA2_bdzQmtCztIc9O0"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ë¡œê·¸ì¸ ë¡œì§ë„ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="14-ë¯¸ë“¤ì›¨ì–´ë¡œ-í˜ì´ì§€ë³„-ì•¡ì„¸ìŠ¤-ì œí•œí•˜ê¸°">14. ë¯¸ë“¤ì›¨ì–´ë¡œ í˜ì´ì§€ë³„ ì•¡ì„¸ìŠ¤ ì œí•œí•˜ê¸°</h2>
<p>ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ê° í˜ì´ì§€ë³„ ì•¡ì„¸ìŠ¤ë¥¼ ì œí•œí•˜ëŠ” ë°©ì‹ì„ ì·¨í•´ì•¼ í•˜ëŠ”ë°ìš”.</p>
<p>ë¡œê·¸ì¸ëœ ìƒíƒœì—ì„œ ê°€ì…í•˜ê¸° í˜ì´ì§€ì™€ ë¡œê·¸ì¸ í˜ì´ì§€ì— ë˜ ë“¤ì–´ê°€ë©´ ì¢‹ì€ UXê°€ ì•„ë‹ˆì§€ ì•ŠìŠµë‹ˆê¹Œ?</p>
<p>ë¯¸ë“¤ì›¨ì–´ë¥¼ ì´ìš©í•´ì„œ í•˜ë©´ ì‰¬ìš´ë°ìš”.</p>
<p>ì•„ë˜ ì½”ë“œë¥¼ ë³´ì‹œë©´ &lsquo;allowedPaths&rsquo; ë³€ìˆ˜ì— í—ˆìš©í•  ë¼ìš°íŒ… ì£¼ì†Œë¥¼ ë„£ìŠµë‹ˆë‹¤.</p>
<p>allowedPathëŠ” ë¡œê·¸ì¸ ìƒê´€ì—†ëŠ” í˜ì´ì§€ë¼ì„œ ë°”ë¡œ next() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ë©ë‹ˆë‹¤.</p>
<p>ì´ì œ allowedPathì— í¬í•¨ë˜ì§€ ì•Šì€ í˜ì´ì§€ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²½ìš° ì¿ í‚¤ì— í¬í•¨ëœ í† í°ì„ ê²€ìƒ‰í•˜ê³  í† í°ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš° ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
<p>ê²€ì¦ í›„ì˜ ë°ì´í„°ëŠ” context.localsì— user ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì €ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p>Astroì—ì„œ ê¸€ë¡œë²Œ ì „ì—­ ë³€ìˆ˜ ê°™ì€ ê±°ì£ .</p>
<p>context.localsë¥¼ ì´ìš©í•˜ë©´ ì–´ë–¤ Astro í˜ì´ì§€ì—ì„œë„ ì‰½ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆì–´ ì•„ì£¼ í¸í•©ë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ context.locals.user ë¼ëŠ” ê°’ì— í† í°ì„ ë””ì½”ë“œí•´ì„œ ì–»ì€ ì‚¬ìš©ì ì •ë³´ë¥¼ ì…ë ¥í•´ì„œ ë¡œê·¸ì¸ ìœ ë¬´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê±°ì£ .</p>
<p>ì¿ í‚¤ê°€ ì—†ìœ¼ë©´ userì—ëŠ” nullì´ í¬í•¨ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">defineMiddleware</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;astro/middleware&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">jwt</span> <span class="nx">from</span> <span class="s1">&#39;jsonwebtoken&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">allowedPaths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">onRequest</span> <span class="o">=</span> <span class="nx">defineMiddleware</span><span class="p">((</span><span class="nx">context</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">allowedPaths</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">pathname</span><span class="p">))</span> <span class="k">return</span> <span class="nx">next</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">context</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="kc">null</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;mytoken&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="o">?</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">decoded</span><span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span><span class="p">)</span> <span class="nx">context</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">decoded</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">next</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‘ì„±í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<p>íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ user ë¶€ë¶„ì— ì—ëŸ¬ê°€ ìˆë‹¤ê³  ë‚˜ì˜¤ëŠ”ë°ìš”.</p>
<p>user íƒ€ì…ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>&rsquo;env.d.ts&rsquo; íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">/// &lt;reference types=&#34;astro/client&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">interface</span> <span class="nx">ImportMetaEnv</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">readonly</span> <span class="nx">SECRET</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">ImportMeta</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">readonly</span> <span class="nx">env</span><span class="o">:</span> <span class="nx">ImportMetaEnv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">declare</span> <span class="nx">namespace</span> <span class="nx">App</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">interface</span> <span class="nx">Locals</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">user</span><span class="o">:</span> <span class="kc">null</span> <span class="o">|</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">id</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">?:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">email</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì´ì œ ë¯¸ë“¤ì›¨ì–´ì—ì„œ ë¡œê·¸ì¸ëœ ìƒíƒœì˜ ìœ ì € ì •ë³´ê°€ context.locals.user ë³€ìˆ˜ì— ì €ì¥ë˜ê¸° ë•Œë¬¸ì— ì´ ì •ë³´ë¥¼ ì´ìš©í•´ì„œ UIë¥¼ ë°”ê¿”ì£¼ë©´ ë©ë‹ˆë‹¤.</p>
<p>ì¼ë‹¨ ë¡œê·¸ì¸ëœ ìƒíƒœì—ì„œ ë³´ì—¬ì£¼ëŠ” ë¼ìš°íŒ… ì£¼ì†Œì¸ ëŒ€ì‹œë³´ë“œë¥¼ ìˆ˜ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// src/pages/dashboard/index.astro
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="k">return</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s2">&#34;/login&#34;</span><span class="p">,</span> <span class="mi">302</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Dashboard</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ë¡œê·¸ì¸ëœ ìœ ì € ì •ë³´ë¥¼ ì•„ì£¼ ì‰½ê²Œ Astro.locals.user ê°’ì—ì„œ ì–»ì–´ ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEgnc7NaxR9H9NIPGjw-o0ig_Y3y4NY5f3NidKNy8x09qd4ZEH_DkpxjvpiB1DDoH7bBRyXqnEwHl0FONRRarzM5bUX4ZCOWbB_vHA6e3ZRKd581-H4mKxNS-QidhSjSr5v3rtg6W-Yzx69FpOHJGG8110C2LYVlTtJOyriReZ8DAvb-1tUWeHQtN3SHwQo"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>ìœ„ì™€ ê°™ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ë„¤ìš”.</p>
<p>ë§Œì•½ ë¡œê·¸ì¸ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œëŠ” &lsquo;/login&rsquo; ë¼ìš°íŒ…ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ê°€ ë©ë‹ˆë‹¤.</p>
<hr>
<h2 id="15-ë¡œê·¸ì•„ì›ƒ-êµ¬í˜„">15. ë¡œê·¸ì•„ì›ƒ êµ¬í˜„</h2>
<p>ë¡œê·¸ì•„ì›ƒì„ êµ¬í˜„í•´ì•¼ í•˜ëŠ”ë°ìš”.</p>
<p>ë¡œê·¸ì•„ì›ƒì€ &lsquo;mytoken&rsquo;ì´ë¼ëŠ” ì¿ í‚¤ê°’ì„ ì‚­ì œí•˜ë©´ ë©ë‹ˆë‹¤</p>
<p>pages í´ë” ë°‘ì— logout.ts íŒŒì¼ì„ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.</p>
<p>ì´ íŒŒì¼ì€ API ì—”ë“œ í¬ì¸íŠ¸ë¼ì„œ í™•ì¥ìê°€ tsë¡œ ëë‚©ë‹ˆë‹¤.</p>
<p>ì£¼ì†Œë¡œì¨ &lsquo;/logout&rsquo;ì—ë§Œ HTTP ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ í•˜ë©´ ë¡œê·¸ì•„ì›ƒì´ ë˜ëŠ” ê±°ì£ .</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">type</span> <span class="p">{</span> <span class="nx">APIRoute</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;astro&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">POST</span><span class="o">:</span> <span class="nx">APIRoute</span> <span class="o">=</span> <span class="kr">async</span> <span class="nx">context</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">context</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">&#39;mytoken&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">context</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì¿ í‚¤ë¥¼ ì‚­ì œí•˜ê³  &lsquo;/login&rsquo;ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹œí‚µë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¬ë©´ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì„ ì–´ë–»ê²Œ ë§Œë“¤ê¹Œìš”?</p>
<p>ê°„ë‹¨í•˜ê²Œ formìœ¼ë¡œ &lsquo;/logout&rsquo; ì´ë¼ëŠ” action ê°’ì„ ë„£ì–´ì„œ HTTP POST ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<p>ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ì— ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì„ ì¶”ê°€í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="k">return</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s2">&#34;/login&#34;</span><span class="p">,</span> <span class="mi">302</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Dashboard</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Name</span><span class="o">:</span> <span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">:</span> <span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;/logout&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;submit&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;Logout&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ë§¨ ì²˜ìŒ formì„ ì„¤ëª…ë“œë ¸ì„ ë•Œ ì–˜ê¸°í–ˆë˜ action í•­ëª©ì´ ë³´ì…ë‹ˆë‹¤.</p>
<p>action í•­ëª©ì— ì£¼ì†Œë¥¼ ë„£ìœ¼ë©´ ê·¸ ì£¼ì†Œë¡œ ë¦¬í€˜ìŠ¤íŠ¸ê°€ ì¼ì–´ë‚œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.</p>
<p>í…ŒìŠ¤íŠ¸ í•´ë³´ì‹œë©´ ì˜ ì‘ë™í•˜ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.</p>
<hr>
<h2 id="16-ë¡œê·¸ì¸-ê°€ì…í•˜ê¸°-í˜ì´ì§€ì—-ë¦¬ë‹¤ì´ë ‰íŠ¸-ì½”ë“œ-ì‚½ì…">16. ë¡œê·¸ì¸, ê°€ì…í•˜ê¸° í˜ì´ì§€ì— ë¦¬ë‹¤ì´ë ‰íŠ¸ ì½”ë“œ ì‚½ì…</h2>
<p>ë§Œì•½ ë¡œê·¸ì¸ëœ ìƒíƒœì¼ ê²½ìš° ë¡œê·¸ì¸, ê°€ì…í•˜ê¸° í˜ì´ì§€ì— ìˆì„ í•„ìš”ê°€ ì—†ì£ .</p>
<p>ê·¸ë˜ì„œ ì½”ë“œ ë§¨ ì²˜ìŒì— ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// login.astro , signup.astro
</span></span></span><span class="line"><span class="cl"><span class="c1">// ë§ˆì§€ë§‰ ì¤„ì— ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.
</span></span></span><span class="line"><span class="cl"><span class="c1">// ì¦‰ ì•„ë˜ if ë¬¸ ë‹¤ìŒì…ë‹ˆë‹¤.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Astro</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="k">return</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s2">&#34;/dashboard&#34;</span><span class="p">,</span> <span class="mi">302</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì´ì œ ë¡œê·¸ì¸í•œ ìƒíƒœì—ì„œ &lsquo;/signup&rsquo;, &lsquo;/login&rsquo; ì£¼ì†Œë¡œ ê°€ë©´ ë¬´ì¡°ê±´ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¬ë©´ Home ë¼ìš°íŒ… ì£¼ì†Œì¸ &lsquo;/&lsquo;ì—ì„œëŠ” ìœ ì € ì •ë³´ê°€ ì•ˆ ë‚˜íƒ€ë‚˜ì£ .</p>
<p>ì™œëƒí•˜ë©´ ë¯¸ë“¤ì›¨ì–´ì—ì„œ allowedPaths ë°°ì—´ì— &lsquo;/&lsquo;ë¥¼ ë„£ì—ˆê¸° ë•Œë¬¸ì— user ì •ë³´ë¥¼ ë””ì½”ë“œí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ë¯¸ë“¤ì›¨ì–´ë¥¼ ì•„ë˜ì™€ ê°™ì´ ë°”ê¾¸ë©´ Home ì£¼ì†Œì—ì„œë„ ìœ ì € ì •ë³´ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">defineMiddleware</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;astro/middleware&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">jwt</span> <span class="nx">from</span> <span class="s1">&#39;jsonwebtoken&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// const allowedPaths = [&#34;/&#34;];
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">onRequest</span> <span class="o">=</span> <span class="nx">defineMiddleware</span><span class="p">((</span><span class="nx">context</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// if (allowedPaths.includes(context.url.pathname)) return next();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">context</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="kc">null</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;mytoken&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="o">?</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">decoded</span><span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span><span class="p">)</span> <span class="nx">context</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">decoded</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">next</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
  </figure>
</div>
<p>ìœ„ì™€ ê°™ì´ ì£¼ì„ ì²˜ë¦¬í•˜ê³  Home í˜ì´ì§€ëŠ” pages í´ë” ë°‘ì˜ index.astro íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ê³ ì¹˜ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Layout</span> <span class="nx">from</span> <span class="s2">&#34;../layouts/Layout.astro&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">Astro</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Home</span> <span class="nx">Page</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">user</span> <span class="o">?</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="nx">You</span> <span class="nx">are</span> <span class="s2">&#34;{user.name} / {user.email}&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="err">/h2&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;post&#34;</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;/logout&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;submit&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;Logout&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="err">/form&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="err">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="o">:</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">You</span> <span class="nx">are</span> <span class="nx">not</span> <span class="nx">logged</span> <span class="k">in</span><span class="p">.</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="err">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/Layout&gt;</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì‹¤í–‰ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEh9L3uMS1k9D8GJsJL2X6KjvRN6_OLO1vZMED3STiSD6pqC95sLB68Q1agT4F_aCXWlflyx_Mtade7KzqZvUhagUNm__zUxEHgM9p5XZ7kTjk6S2KGm-nkpcS97y_GDrOHSrSUul9PpIfHW_5zFeYLIk6UFtZri5JQIQ9p6Txcx_V-y_lFnDadOleuGYrc"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<p>
  <figure>
    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEihlZ5nof1-QWVG3rD9uMCEajaLnjCu9dngmCNLhymcrM59zOMfc8lhZdOQSDt3dMHbJ9pyX9brrbYpYkT31829MdHSC7cPjdAg2kGqii9uP9pWRswM5XEdr-rifFapvoCB7y9-DUWyw48flj7nlOYRt2r-9vM-EgPpAxuruhSw8uScieI8G23y2TlmqME"
         alt=""
         
         class="img-fluid"
         loading="lazy"
         decoding="async" />
    
  </figure></p>
<hr>
<h2 id="17-ë¹Œë“œë¥¼-ìœ„í•œ-ì–´ëŒ‘í„°-ì„¤ì¹˜">17. ë¹Œë“œë¥¼ ìœ„í•œ ì–´ëŒ‘í„° ì„¤ì¹˜</h2>
<p>astro.config.mjs íŒŒì¼ì—ì„œ outputì´ &lsquo;server&rsquo;ì´ê¸° ë•Œë¬¸ì— ë¹Œë“œí•˜ë ¤ë©´ ì–´ëŒ‘í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
<p>ë°°í¬í•˜ê¸° ìœ„í•œ ê° í´ë¼ìš°ë“œë³„ ì–´ëŒ‘í„°ê°€ ìˆìœ¼ë‹ˆ ê³µì‹ í™ˆí˜ì´ì§€ë¥¼ ì°¸ê³  ë°”ë¼ë©°, ê°€ì¥ ê¸°ë³¸ì ì¸ Node ì–´ëŒ‘í„°ë¥¼ ì„¤ì¹˜í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">npx</span> <span class="nx">astro</span> <span class="nx">add</span> <span class="nx">node</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">npm</span> <span class="nx">run</span> <span class="nx">build</span></span></span></code></pre></div>
  </figure>
</div>
<p>ì´ì œ ë¹Œë“œê°€ ì •ìƒì ìœ¼ë¡œ ëë„¤ìš”.</p>
<p>dist í´ë”ì— ê°€ë³¼ê¹Œìš”?</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tree --du -h ./dist
</span></span><span class="line"><span class="cl"><span class="o">[</span>201K<span class="o">]</span>  ./dist
</span></span><span class="line"><span class="cl">â”œâ”€â”€ <span class="o">[</span> 13K<span class="o">]</span>  client
</span></span><span class="line"><span class="cl">â”‚   â”œâ”€â”€ <span class="o">[</span> 12K<span class="o">]</span>  _astro
</span></span><span class="line"><span class="cl">â”‚   â”‚   â””â”€â”€ <span class="o">[</span> 12K<span class="o">]</span>  hoisted.4PK_pqbL.js
</span></span><span class="line"><span class="cl">â”‚   â””â”€â”€ <span class="o">[</span> 749<span class="o">]</span>  favicon.svg
</span></span><span class="line"><span class="cl">â””â”€â”€ <span class="o">[</span>188K<span class="o">]</span>  server
</span></span><span class="line"><span class="cl">    â”œâ”€â”€ <span class="o">[</span> 664<span class="o">]</span>  _astro-internal_middleware.mjs
</span></span><span class="line"><span class="cl">    â”œâ”€â”€ <span class="o">[</span>107K<span class="o">]</span>  chunks
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 11K<span class="o">]</span>  astro
</span></span><span class="line"><span class="cl">    â”‚   â”‚   â””â”€â”€ <span class="o">[</span> 11K<span class="o">]</span>  assets-service_viW8rF43.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 73K<span class="o">]</span>  astro_CiCEMB--.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 890<span class="o">]</span>  index_3CUD5-aQ.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 200<span class="o">]</span>  index_5EsQHg9G.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 200<span class="o">]</span>  index_gzawo1fc.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 200<span class="o">]</span>  login_kDQSl8PX.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 186<span class="o">]</span>  logout__QUDrWfQ.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 184<span class="o">]</span>  node_0famb6YR.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”œâ”€â”€ <span class="o">[</span> 21K<span class="o">]</span>  pages
</span></span><span class="line"><span class="cl">    â”‚   â”‚   â”œâ”€â”€ <span class="o">[</span>4.3K<span class="o">]</span>  index_Ahlbjwl9.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”‚   â”œâ”€â”€ <span class="o">[</span>3.5K<span class="o">]</span>  login_K2j71GLI.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”‚   â”œâ”€â”€ <span class="o">[</span> 134<span class="o">]</span>  logout_qAe24DUv.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”‚   â”œâ”€â”€ <span class="o">[</span>9.6K<span class="o">]</span>  node_uJ98dHhL.mjs
</span></span><span class="line"><span class="cl">    â”‚   â”‚   â””â”€â”€ <span class="o">[</span>3.6K<span class="o">]</span>  signup_PbE-VfQX.mjs
</span></span><span class="line"><span class="cl">    â”‚   â””â”€â”€ <span class="o">[</span> 186<span class="o">]</span>  signup_mGJsesMi.mjs
</span></span><span class="line"><span class="cl">    â”œâ”€â”€ <span class="o">[</span> 69K<span class="o">]</span>  entry.mjs
</span></span><span class="line"><span class="cl">    â”œâ”€â”€ <span class="o">[</span> 11K<span class="o">]</span>  manifest_rqdvmMgq.mjs
</span></span><span class="line"><span class="cl">    â”œâ”€â”€ <span class="o">[</span> 257<span class="o">]</span>  middleware.mjs
</span></span><span class="line"><span class="cl">    â””â”€â”€ <span class="o">[</span>  45<span class="o">]</span>  renderers.mjs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 552K used in <span class="m">7</span> directories, <span class="m">21</span> files</span></span></code></pre></div>
  </figure>
</div>
<p>ì´ 522K ì‚¬ì´ì¦ˆë„¤ìš”.</p>
<p>ì •ë§ ì‘ìŠµë‹ˆë‹¤.</p>
<p>dist í´ë”ì˜ server í´ë”ì— ë“¤ì–´ê°€ì‹œë©´ entry.mjs íŒŒì¼ì´ ìˆì£ .</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <pre tabindex="0"><code>node dist/server/entry.mjs
20:31:37 [@astrojs/node] Server listening on http://127.0.0.1:4321</code></pre>
  </figure>
</div>
<p>ì´ë ‡ê²Œ ì •ì‹ í”„ë¡œë•ì…˜ ë¹Œë“œíŒì„ ì›¹ ì„œë²„ì—ì„œ ì‹¤í–‰í•˜ì‹œë©´ ì„œë²„ê°€ ì‹¤í–‰ë˜ëŠ” ê²ë‹ˆë‹¤.</p>
<p>ë‹¹ì—°íˆ ìš°ë¶„íˆ¬ ì„œë²„ì— ìš°ë¦¬ê°€ ì‘ì„±í•œ ì½”ë“œ ì „ë¶€ë¥¼ ë³µì‚¬í•´ì„œ ê·¸ëŒ€ë¡œ buildí•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ì™œëƒí•˜ë©´ í•„ìš”í•œ íŒŒì¼ì´ &rsquo;node_modules&rsquo; í´ë”ê°€ í•„ìš”í•˜ê³ ,</p>
<p>ê·¸ ë‹¤ìŒìœ¼ë¡œ prisma í´ë”, &lsquo;.env&rsquo; íŒŒì¼ë„ í•„ìš”í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¼.</p>

      <div class="tag-list-single">
        <a class="btn btn-light" href="/tags/astrojs/" role="button">astrojs</a>
        <a class="btn btn-light" href="/tags/auth/" role="button">auth</a>
        <a class="btn btn-light" href="/tags/cookie/" role="button">cookie</a>
        <a class="btn btn-light" href="/tags/jwt/" role="button">jwt</a>
        <a class="btn btn-light" href="/tags/token/" role="button">token</a>
        <a class="btn btn-light" href="/tags/jsonwebtoken/" role="button">jsonwebtoken</a>
        </div>
      
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-format="autorelaxed"
          data-ad-client="ca-pub-7748316956330968"
          data-ad-slot="4495825428"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </div>
</article>

      
      </div>
    </div>
    
    
<div class="bg-light">
    <section class="section section-related container">
      <div class="row justify-content-center">
        <div class="col-md-12 col-lg-12">
          <h2 class="section-title text-center">Related posts</h2>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-lg-12">
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2024-01-16-astrojs-tutorial-auth-with-lucia/">astrojs ê°•ì¢Œ 11í¸. astrojsì™€ luciaë¥¼ ì´ìš©í•´ì„œ ìœ ì € ì¸ì¦ êµ¬í˜„</a></h2>
                  <p>Lucia authë¥¼ ì´ìš©í•´ì„œ Astrojsì—ì„œ ìœ ì € ê°€ì…í•˜ê¸°, ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ êµ¬í˜„í•˜ê¸°</p>
                  <p>
  <small>January 16, 2024<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>12&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2023-11-09-astrojs-howto-supabase-authentication-with-ssr/">astrojs ê°•ì¢Œ 9í¸. astrojsì™€ supabaseë¡œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„</a></h2>
                  <p>Supabaseì˜ Authenticationì„ ì´ìš©í•´ì„œ AstroJSì—ì„œ ìœ ì € ë¡œê·¸ì¸ êµ¬í˜„í•˜ê¸°</p>
                  <p>
  <small>November 9, 2023<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>11&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          <div class="card">
              <div class="card-body">
                <article>
                  <h2 class="h3"><a class="stretched-link text-body" href="/blog/2023-06-03-nextauth-nextjs-tutorial-protected-route-and-jwt-token/">NextAuth ì‚¬ìš©ë²• 4í¸ - í† í°ì„ ì´ìš©í•œ ì„¸ì…˜ ë³´í˜¸</a></h2>
                  <p>NextAuth ì‚¬ìš©ë²• 4í¸ - í† í°ì„ ì´ìš©í•œ ì„¸ì…˜ ë³´í˜¸</p>
                  <p>
  <small>June 3, 2023<span class="stretched-link position-relative reading-time text-nowrap" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
        <path d="M12 7v5l3 3"></path>
      </svg>7&nbsp;minutes</span></small>
</p>
</article>
              </div>
            </div>
          </div>
      </div>
    </section>
    <script src="https://utteranc.es/client.js"
      repo="cpro95/utterances_mycodings_fly_dev"
      issue-term="pathname"
      theme="github-light"
      label="blog-comment"
      crossorigin="anonymous"
    async>
    </script>
  </div>
  
    <footer class="footer text-muted">
  <div class="container-lg">
    <div class="row">
      <div class="col-lg-8 text-center text-lg-start">
        <ul class="list-inline">
          <li class="list-inline-item"><a class="text-muted" href="/about/">about</a></li>
        </ul>
      </div>
      <div class="col-lg-8 text-center text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item">Copyright (c) All Right Reserved.</li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    

<script async
  src="/js/app.19b73e0182301dd61c9211c2f6890104740e2eb9eb12fe4ba8d4f31435b22ed6.js"
  integrity="sha256-Gbc&#43;AYIwHdYckhHC9okBBHQOLrnrEv5LqNTzFDWyLtY=">
</script>





<script async
  src="/js/flexsearch.5dd6433c29c3e043627f046054aed58ff3790f58fdb8423f45125bbafdcad335.js"
  integrity="sha256-XdZDPCnD4ENifwRgVK7Vj/N5D1j9uEI/RRJbuv3K0zU=">
</script>
<script async
  src="/js/search-modal.96e662d8f691fe25c859a3437074b485f2d7bed0bca612725028c6cf4322e2f2.js"
  integrity="sha256-luZi2PaR/iXIWaNDcHS0hfLXvtC8phJyUCjGz0Mi4vI=">
</script>

    <div class="d-inline-flex fixed-bottom-right pb-4 pe-4">
  <button id="toTop" type="button" class="btn btn-primary rounded-circle ms-auto p-2"><span class="visually-hidden">Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M6 15l6 -6l6 6"></path></svg></button>
</div>

    
  </body>
</html>
